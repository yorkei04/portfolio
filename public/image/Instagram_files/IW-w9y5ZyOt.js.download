;/*FB_PKG_DELIM*/

__d("WAMapWithDefault",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e,t){this.$1=e,t!=null?this.$2=new Map(t):this.$2=new Map}var t=e.prototype;return t.size=function(){return this.$2.size},t.clear=function(){this.$2.clear()},t.delete=function(t){return this.$2.delete(t)},t.get=function(t){var e=this.$2.get(t);if(e!=null)return e;var n=this.$1(t);return this.$2.set(t,n),n},t.keys=function(){return this.$2.keys()},t.entries=function(){return this.$2.entries()},t.update=function(n,r){var t=new Map(this.$2).set(n,r(this.get(n)));return new e(this.$1,t)},t.toMap=function(){return new Map(this.$2)},e})();i.MapWithDefault=e}),66);
__d("BroadcastChannelFallback",["FBLogger","WAMapWithDefault"],(function(t,n,r,o,a,i,l){"use strict";var e=new(o("WAMapWithDefault")).MapWithDefault(function(){return new Set});function s(t,n){e.get(t).add(n)}function u(t,n){e.get(t).delete(n)}function c(t,n){var o=e.get(t);o.forEach(function(e){return e(n)}),o.size===0&&r("FBLogger")("BroadcastChannelFallback").warn("No listener for namespace",t)}l.registerBroadcastChannelFallbackListener=s,l.unregisterBroadcastChannelFallbackListener=u,l.handleBroadcastChannelFallbackMessage=c}),98);
__d("CryptoLogger",["FBLogger"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return r("FBLogger")("labyrinth_web","crypto."+e)}function s(e,t){return t instanceof Error?e.catching(t):e}l.CryptoLogger=e,l.captureError=s}),98);
__d("LSMaxInt32",["I64"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("I64"))).of_int32(2147483647);l.default=s}),98);
__d("RetUtil",["LSResult"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return r("LSResult")(e)}l.getNullableRetResult=e}),98);
__d("CreateDerivedKeys",["CryptoLogger","I64","LSMaxInt32","LSVec","Promise","RetUtil","XPlatReactCrypto"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t,a,i,l){var u=o("CryptoLogger").CryptoLogger("create_derived_keys");if(l.length<1||l.some(function(e){return(s||(s=o("I64"))).gt(e,r("LSMaxInt32"))}))return u.mustfix("Invalid key lengths for derive keys"),(e||(e=n("Promise"))).resolve(o("RetUtil").getNullableRetResult(void 0));var c=l.map((s||(s=o("I64"))).to_int32),d=l.map(s.to_int32).reduce(function(e,t){return e+t},0),m=function(t){for(var e=[],n=0,a=0,i=c.length;a<i;++a){var l=n+c[a];e.push(t.slice(n,l).buffer),n=l}return o("RetUtil").getNullableRetResult(r("LSVec").ofArray(e))};return o("XPlatReactCrypto").subtleImportKey("raw",i,"HKDF",!1,["deriveBits"]).then(function(e){return o("XPlatReactCrypto").subtleDeriveBits({hash:"SHA-256",info:t,name:"HKDF",salt:a!=null?a:new Uint8Array(10).buffer},e,d*8)}).then(function(e){var t=new Uint8Array(e);return m(t)}).catch(function(e){return u.catching(e).mustfix("Failed to create derived keys"),o("RetUtil").getNullableRetResult()})}l.CreateDerivedKeys=u}),98);
__d("DoubleKeyMap",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(){this.$1=new Map}var t=e.prototype;return t.set=function(t,n,r){var e=this.$1.get(t);e||this.$1.set(t,e=new Map),e.set(n,r)},t.get=function(t,n){var e;return(e=this.$1.get(t))==null?void 0:e.get(n)},t.delete=function(t,n){var e=this.$1.get(t);e&&(e.delete(n),e.size===0&&this.$1.delete(t))},t.getAll=function(t){return this.$1.get(t)},t.deleteAll=function(t){this.$1.delete(t)},e})();i.DoubleKeyMap=e}),66);
__d("EBAPIQPLPoints",["QPLUserFlow"],(function(t,n,r,o,a,i,l){"use strict";var e={CREATE_WORKER_NETWORK_EXECUTE_END:"create_worker_network_execute_end",CREATE_WORKER_NETWORK_EXECUTE_START:"create_worker_network_execute_start",GRAPHQL_QUERY_END:"graphql_query_end",GRAPHQL_QUERY_START:"graphql_query_start"},s={CLIENT_STATE_RETRIEVED:"client_state_retrieved",EB_NOT_ENABLED:"eb_not_enabled",EBLS_NOT_INITIALIZED:"ebls_not_initialized",EMPTY_DECRYPTION_RESPONSE:"empty_decryption_response",INVALID_CLIENT_STATE:"invalid_client_state",INVALID_GRAPHQL_RESPONSE:"invalid_graphql_response",INVALID_PARAMETERS:"invalid_parameters",LSDB_SINGLETON_RETRIEVED:"lsdb_singleton_retrieved",NO_CLIENT_STATE:"no_client_state",NULL_CHAT_JID:"null_chat_jid",RUNTIME_ERROR:"runtime_error",UNSUPPORTED_CONTEXT:"unsupported_context"},u=babelHelpers.extends({},e),c=babelHelpers.extends({},e,s,{BACKUP_ID_NULL:"backup_id_null",BATCH_RESTORE_AND_DECRYPT_FAILURE:"batch_restore_and_decrypt_failure",DELETE_MAILBOX:"delete_mailbox",DERIVE_AND_STORE_EPOCHS_END:"derive_and_store_epochs_end",DERIVE_AND_STORE_EPOCHS_START:"derive_and_store_epochs_start",SERVER_SIDE_EXCEPTION:"server_side_exception"}),d={ADDED_ATTACHMENT_CONTEXT:"added_attachment_context",ADDED_ATTACHMENT_CONTEXT_LEGACY:"added_attachment_context_legacy",DEQUEUE:"added_to_queue_end",ENQUEUE:"added_to_queue_start",ENQUEUE_FAILURE:"enqueue_failure",GENERATE_BACKUP_DIRECTIVE_END:"generate_backup_directive_end",GENERATE_BACKUP_DIRECTIVE_START:"generate_backup_directive_start",GENERATE_REPORTING_META_END:"generate_reporting_meta_end",GENERATE_REPORTING_META_START:"generate_reporting_meta_start",GET_ATTACHMENT_CONTEXT_END:"get_attachment_context_end",GET_ATTACHMENT_CONTEXT_START:"get_attachment_context_start",MESSAGE_RESULT_FAILURE_OR_NULL:"message_result_failure_or_null",NO_INCOMING_MESSAGES:"no_incoming_messages",NO_PROCESSED_MESSAGES:"no_processed_messages",PROCESSED_MESSAGES:"processed_messages",RUNTIME_ERROR:"runtime_error",SUCCESSFULLY_PROCESSED_MESSAGE:"successfully_processed_message",UKNOWN_MESSAGE_VERSION_OR_PROTOCOL:"unknown_message_version_or_protocol",UNABLE_TO_CREATE_BACKUP_DIRECTIVE:"unable_to_create_backup_directive",UNKNOWN_MESSAGE_TYPE:"unknown_message_type",UNSUPPORTED_MESSAGE_TYPE:"unsupported_message_type",UPLOAD_DELETED_MESSAGE:"upload_deleted_message",UPLOAD_PAYLOAD_CREATED:"upload_payload_creation_success",UPLOAD_PAYLOAD_CREATION_FAILURE:"upload_payload_creation_failure",UPLOAD_PAYLOAD_CREATION_START:"upload_payload_creation_start"},m={ADD_DEVICE_CHECK_RC_STATUS:"add_device_check_rc_status",ADD_DEVICE_COULD_NOT_FIND_BACKUP:"add_device_could_not_find_backup",ADD_DEVICE_EBSM_API_START:"add_device_ebsm_api_start",ADD_DEVICE_FAILED_DEVICE_REGISTRATION_ID_NULL:"add_device_failed_device_registration_id_null",ADD_DEVICE_FAILED_TO_GET_RC_STATUS:"add_device_failed_to_get_rc_status",ADD_DEVICE_FAILURE_BACKUP_NOT_FOUND:"add_device_failure_backup_not_found",ADD_DEVICE_OPTIMISTIC_STATUS:"add_device_optimistic_status",ADD_DEVICE_RUNTIME_ERROR:"add_device_runtime_error",ADD_DEVICE_SPROC_END:"add_device_sproc_end",ADD_DEVICE_SPROC_FAILURE:"add_device_sproc_failure",ADD_DEVICE_SPROC_START:"add_device_sproc_start",ADD_DEVICE_SUBSCRIPTION_END:"add_device_subscription_end",ADD_DEVICE_SUBSCRIPTION_START:"add_device_subscription_start",ADD_DEVICE_TASK_END:"add_device_task_end",ADD_DEVICE_TASK_START:"add_device_task_start",ADD_DEVICE_TIMEOUT:"add_device_timeout",ADD_DEVICE_WAIT_FOR_EBLS_END:"add_device_wait_for_ebls_end",ADD_DEVICE_WAIT_FOR_EBLS_START:"add_device_wait_for_ebls_start",INVALID_RECOVERY_CODE:"invalid_recovery_code",ON_START_BEGIN:"on_start_start",ON_START_SUCCESS:"on_start_end",OTC_ADD_DEVICE_SPROC_END:"otc_add_device_sproc_end",OTC_ADD_DEVICE_SPROC_ERROR:"otc_add_device_sproc_error",OTC_ADD_DEVICE_SPROC_FAILURE:"otc_add_device_sproc_failure",OTC_ADD_DEVICE_SPROC_START:"otc_add_device_sproc_start",OTC_ADD_DEVICE_SUCCESS:"otc_add_device_success",OTC_ADD_DEVICE_SYSTEM_ERROR:"otc_add_device_system_error",OTC_ADD_DEVICE_UNEXPECTED_RECOVERY_CODE_STATUS:"otc_add_device_unexpected_rc_status"},p={ADD_DEVICE_FETCH_VD_GRAPHQL_END:"add_device_fetch_vd_graphql_end",ADD_DEVICE_FETCH_VD_GRAPHQL_FAIL:"add_device_fetch_vd_graphql_fail",ADD_DEVICE_FETCH_VD_GRAPHQL_START:"add_device_fetch_vd_graphql_start",ADD_DEVICE_GQL_END:"add_device_gql_end",ADD_DEVICE_GQL_FAIL:"add_device_gql_fail",ADD_DEVICE_GQL_START:"add_device_gql_start",ADD_DEVICE_MISSING_GRAPHQL_FIELDS:"add_device_missing_graphql_fields",ADD_DEVICE_PARSE_RECOVERY_CODE_END:"add_device_parse_recovery_code_end",ADD_DEVICE_PARSE_RECOVERY_CODE_FAIL:"add_device_parse_recovery_code_fail",ADD_DEVICE_PARSE_RECOVERY_CODE_START:"add_device_parse_recovery_code_start",ADD_DEVICE_VIRTUAL_DEVICE_EXISTS:"add_device_virtual_device_exists",ADD_DEVICE_VIRTUAL_DEVICE_KEY_SPROC_END:"add_device_vd_key_sproc_end",ADD_DEVICE_VIRTUAL_DEVICE_KEY_SPROC_FAIL:"add_device_vd_key_sproc_fail",ADD_DEVICE_VIRTUAL_DEVICE_KEY_SPROC_START:"add_device_vd_key_sproc_start"},_={FETCH_BACKUP_IDS_END:"fetch_backup_ids_end",FETCH_BACKUP_IDS_START:"fetch_backup_ids_start",GET_DB_END:"get_db_end",GET_DB_START:"get_db_start",INITIALIZE_BACKUP_END:"initialize_backup_end",INITIALIZE_BACKUP_FAIL:"initialize_backup_fail",INITIALIZE_BACKUP_FAIL_NO_RECOVERY_CODE:"initialize_backup_fail_no_recovery_code",INITIALIZE_BACKUP_RUNNING:"initialize_backup_running",INITIALIZE_BACKUP_SPROC_END:"initialize_backup_sproc_end",INITIALIZE_BACKUP_SPROC_FAIL:"initialize_backup_sproc_fail",INITIALIZE_BACKUP_SPROC_START:"initialize_backup_sproc_start",INITIALIZE_BACKUP_START:"initialize_backup_start",INITIALIZE_BACKUP_SUBSCRIPTION_DELETE:"initialize_backup_subscription_delete",INITIALIZE_BACKUP_TIMEOUT:"initialize_backup_timeout",INITIALIZE_BACKUP_WORKER_START:"initialize_backup_worker_start",OPTIMISTIC_CLIENT_STATE:"optimistic_client_state"},f={DELETE_EB_BRIDGE_CALL_START:"delete_eb_bridge_call_start",DELETE_EB_GET_DB_END:"delete_eb_get_db_end",DELETE_EB_GET_DB_START:"delete_eb_get_db_start",DELETE_EB_NON_DELETE_OPERATION:"delete_eb_non_delete_operation",DELETE_EB_NON_PUT_OPERATION:"delete_eb_non_put_operation",DELETE_EB_SPROC_ERROR:"delete_eb_sproc_error",DELETE_EB_SPROC_FAIL:"delete_eb_sproc_fail",DELETE_EB_SPROC_START:"delete_eb_sproc_start",DELETE_EB_SPROC_SUCCESS:"delete_eb_sproc_success",DELETE_EB_START:"delete_eb_start",DELETE_EB_TASK_FAIL:"delete_eb_task_fail",DELETE_EB_TASK_START:"delete_eb_task_start",DELETE_EB_TASK_SUCCESS:"delete_eb_task_success",DELETE_EB_WORKER_START:"delete_eb_worker_start",FETCH_BACKUP_IDS_END:"fetch_backup_ids_end",FETCH_BACKUP_IDS_START:"fetch_backup_ids_start"},g={FETCH_BACKUP_IDS_END:"fetch_backup_ids_end",FETCH_BACKUP_IDS_START:"fetch_backup_ids_start",OPT_OUT_BACKUP_ROW_EXISTS:"opt_out_backup_row_exists",OPT_OUT_BACKUP_ROW_NULL:"opt_out_backup_row_null",OPT_OUT_BACKUP_SPROC_END:"opt_out_backup_sproc_end",OPT_OUT_BACKUP_SPROC_FAIL:"opt_out_backup_sproc_fail",OPT_OUT_BACKUP_SPROC_START:"opt_out_backup_sproc_start",OPT_OUT_BACKUP_TASK_END:"opt_out_backup_task_end",OPT_OUT_BACKUP_TASK_FAIL:"opt_out_backup_task_fail",OPT_OUT_BACKUP_TASK_START:"opt_out_backup_task_start",OPT_OUT_BACKUP_WORKER_START:"opt_out_backup_worker_start",OPT_OUT_BRIDGE_CALL_START:"opt_out_bridge_call_start",OPT_OUT_START:"opt_out_start"},h={SYNC_EPOCH_SPROC_END:"sync_epoch_sproc_end",SYNC_EPOCH_SPROC_START:"sync_epoch_sproc_start",SYNC_EPOCH_TIMEOUT:"sync_epoch_timeout"},y={REVOKE_VIRTUAL_DEVICE_DB_END:"revoke_virtual_device_get_db_end",REVOKE_VIRTUAL_DEVICE_DB_ERROR:"revoke_virtual_device_get_db_error",REVOKE_VIRTUAL_DEVICE_DB_START:"revoke_virtual_device_get_db_start",REVOKE_VIRTUAL_DEVICE_SPROC_ERROR:"revoke_virtual_device_sproc_error",REVOKE_VIRTUAL_DEVICE_SPROC_FAILURE:"revoke_virtual_device_sproc_failure",REVOKE_VIRTUAL_DEVICE_STATUS_INTERNAL_ERROR:"revoke_virtual_device_get_status_internal_error"},C={DERIVE_AND_STORE_EPOCHS_END:"derive_and_store_epochs_end",DERIVE_AND_STORE_EPOCHS_START:"derive_and_store_epochs_start",FETCH_VIRTUAL_DEVICE_END:"fetch_virtual_device_end",FETCH_VIRTUAL_DEVICE_START:"fetch_virtual_device_start",GET_CLIENT_STATE_END:"get_client_state_end",GET_CLIENT_STATE_START:"get_client_state_start",GET_EPOCHS_END:"get_epochs_end",GET_EPOCHS_START:"get_epochs_start",REPAIR_EPOCH_QUERY_END:"repair_epoch_query_end",REPAIR_EPOCH_QUERY_START:"repair_epoch_query_start",REPAIR_EPOCH_RETRY_END:"repair_epoch_retry_end",REPAIR_EPOCH_RETRY_START:"repair_epoch_retry_start",UNREACHABLE_EPOCH_FALLBACK_START:"unreachable_epoch_fallback_start"},b={CLEAR_CLIENT_STATE_END:"clear_client_state_end",CLEAR_CLIENT_STATE_START:"clear_client_state_start",CLEAR_ENCRYPTED_BACKUPS_END:"clear_encrypted_backups_end",CLEAR_ENCRYPTED_BACKUPS_START:"clear_encrypted_backups_start",CLEAR_EPOCHS_END:"clear_epochs_end",CLEAR_EPOCHS_START:"clear_epochs_start",CLEAR_METADATA_END:"clear_metadata_end",CLEAR_METADATA_START:"clear_metadata_start",CLEAR_PENDING_BACKUPS_END:"clear_pending_backups_end",CLEAR_PENDING_BACKUPS_START:"clear_pending_backups_start",CLEAR_RECOVERY_CODE_END:"clear_recovery_code_end",CLEAR_RECOVERY_CODE_START:"clear_recovery_code_start",CLEAR_RECOVERY_CODE_STATUS_END:"clear_recovery_code_status_end",CLEAR_RECOVERY_CODE_STATUS_START:"clear_recovery_code_status_start",CLEAR_VIRTUAL_DEVICES_END:"clear_virtual_devices_end",CLEAR_VIRTUAL_DEVICES_START:"clear_virtual_devices_start",FETCH_BACKUP_IDS_END:"fetch_backup_ids_end",FETCH_BACKUP_IDS_START:"fetch_backup_ids_start",GET_DB_END:"get_db_end",GET_DB_START:"get_db_start",TRANSACTION_END:"transaction_end",TRANSACTION_START:"transaction_start"};function v(e,t,n,o,a){r("QPLUserFlow").addPoint(t,n,{data:babelHelpers.extends({},o,{bool:{runningInWorker:e}}),instanceKey:a})}function S(e,t,n,o,a){r("QPLUserFlow").endFailure(t,n,{annotations:babelHelpers.extends({},a,{bool:{runningInWorker:e}}),instanceKey:o})}function R(e,t,n,o){r("QPLUserFlow").endSuccess(t,{annotations:babelHelpers.extends({},o,{bool:{runningInWorker:e}}),instanceKey:n})}l.EBAPIQPLCommonPoints=e,l.EBAPIQPLCommonErrorPoints=s,l.EBMessageMetadataQPLPoints=u,l.EBMessageRestoreQueryQPLPoints=c,l.EBUploadQueueQPLPoints=d,l.EBAddDeviceQPLPoints=m,l.EBAddDeviceGraphqlQPLPoints=p,l.EBBackupInitQPLPoints=_,l.EBDeleteEBQPLPoints=f,l.EBOptOutQPLPoints=g,l.EBSyncEpochsQPLPoints=h,l.EBRevokeVirtualDeviceQPLPoints=y,l.EBRepairEpochsQPLPoints=C,l.EBDeleteBackupsOnClientQPLPoints=b,l.ebAPIAddQPLPoint=v,l.ebAPIEndFailure=S,l.ebAPIEndSuccess=R}),98);
__d("EBAPIWorkerCheck",[],(function(t,n,r,o,a,i){"use strict";function e(){try{return WorkerGlobalScope!==void 0&&self instanceof WorkerGlobalScope}catch(e){return!1}}i.runningInWorker=e}),66);
__d("EBBase64Encode",["Base64Utils"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return o("Base64Utils").fromArrayBuffer(e)}l.default=e}),98);
__d("WorkerRelayNetwork",["ActorURIConfig","MAWCurrentUser","RelayAPIConfig","WAResolvable","createRelayFBNetwork","createRelayFBNetworkFetch","relay-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e=new(o("WAResolvable")).Resolvable;function s(){var t=c(o("MAWCurrentUser").getID()),n={execute:t.execute};return e.resolve(n),n}function u(){return e.promise}function c(e,t){var n={actorID:e,batchResponseChunks:!0,getAdditionalData:function(){var t={};return e!=null&&(t[r("ActorURIConfig").PARAMETER_ACTOR]=e),r("RelayAPIConfig").useXController===!1&&r("RelayAPIConfig").accessToken!==""&&(t.access_token=r("RelayAPIConfig").accessToken),t},graphURI:t},a=r("createRelayFBNetworkFetch")(n),i=function(t,n,r){return o("relay-runtime").Observable.create(function(e){return e.complete()})};return r("createRelayFBNetwork")(a,i,null,null)}l.createWorkerNetworkExecute=s,l.getWorkerNetworkExecute=u}),98);
__d("executeGraphQLQuery",["DTSG","FBLogger","MAWBridge","asyncToGeneratorRuntime","relay-runtime"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a=o("relay-runtime").getRequest(t);if(a.params.operationKind==="subscription")throw r("FBLogger")("messenger_web").mustfixThrow("executeGraphQLQuery: Expected query or mutation operation");var i={force:!0},l=o("DTSG").getToken();if(l==null||l===""||typeof l!="string"){if(l=yield o("MAWBridge").getBridge().sendAndReceive("event","getDTSGToken").catch(function(e){throw r("FBLogger")("messenger_web").mustfixThrow("executeGraphQLQuery: Failed to get DTSG token from the main thread",e)}),l==null||l===""||typeof l!="string")throw r("FBLogger")("messenger_web").mustfixThrow("executeGraphQLQuery: Received an empty DTSG token from the main thread");o("DTSG").setToken(l)}var s=o("relay-runtime").createOperationDescriptor(a,n,i);return e.execute(s.request.node.params,s.request.variables,i)}),s.apply(this,arguments)}l.executeGraphQLQuery=e}),98);
__d("createWorkerMutation",["FBLogger","WorkerRelayNetwork","asyncToGeneratorRuntime","executeGraphQLQuery","relay-runtime"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=o("relay-runtime").getRequest(e);if(t.params.operationKind!=="mutation")throw r("FBLogger")("messenger_web").mustfixThrow("createWorkerMutation: Expected mutation operation");var a=o("WorkerRelayNetwork").getWorkerNetworkExecute(),i=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=yield a;return o("executeGraphQLQuery").executeGraphQLQuery(n,e,t).then(function(e){return e.toPromise()}).then(function(e){var t,n=Array.isArray(e)?(t=e[0])==null?void 0:t.data:e==null?void 0:e.data;return n==null?null:n})});return function(n){return t.apply(this,arguments)}})();return[i]}l.default=e}),98);
__d("MAWRotateDTSG",["CSRFGuard","DTSG","MWFBLogger","asyncToGeneratorRuntime","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=o("MWFBLogger").MWLogger().tags(["RotateDTSG"]),c=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t,n;u.DEBUG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Getting new DTSG token"])));var r=new Request("/ajax/dtsg/?__a=true",{credentials:"include",method:"GET"}),a=yield self.fetch(r);if(a.status!==200)throw u.mustfixThrow("Unable to get new DTSG token: "+a.status);var i=yield a.text(),l=o("CSRFGuard").clean(i),s=JSON.parse(l),c=s==null||(t=s.payload)==null?void 0:t.token,d=s==null||(n=s.payload)==null?void 0:n.valid_for;if(c==null||d==null)throw u.mustfixThrow("DTSG response is not valid: "+l+"'");return{token:c,validFor:d}});return function(){return t.apply(this,arguments)}})(),d=null;function m(){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){self.clearTimeout(d);try{var e=yield c(),t=e.token,n=e.validFor;return d=self.setTimeout(m,n/2*1e3),o("DTSG").setToken(t),!0}catch(e){return u.catching(r("getErrorSafe")(e)).MUSTFIX(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Error rotating DTSG"]))),d=self.setTimeout(m,600*1e3),!1}}),p.apply(this,arguments)}l.getNewDTSG=c,l.tryRotateDTSG=m}),98);
__d("createWorkerQuery",["FBLogger","IGDWebUtils","MAWRotateDTSG","WARetryableError","WorkerRelayNetwork","asyncToGeneratorRuntime","executeGraphQLQuery","relay-runtime"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a=o("relay-runtime").getRequest(e);if(a.params.operationKind!=="query")throw r("FBLogger")("messenger_web").mustfixThrow("createWorkerQuery: Expected query operation");var i=yield o("WorkerRelayNetwork").getWorkerNetworkExecute();n==null||n.onExecute==null||n.onExecute();var l=o("IGDWebUtils").isOnInstagramWeb(),s=yield o("executeGraphQLQuery").executeGraphQLQuery(i,e,t).then(function(e){return e.toPromise()}).then(function(e){var t;n==null||n.onResponse==null||n.onResponse(e);var r=Array.isArray(e)?(t=e[0])==null?void 0:t.data:e==null?void 0:e.data;if(r!=null)return r}).catch(function(e){if(("code"in e&&e.code===1357004||"message"in e&&e.message.indexOf("1357004")!==-1||typeof e=="string"&&e.indexOf("1357004")!==-1)&&!l)return r("FBLogger")("messenger_web").info("Failed with expired DTSG, attempting to rotate."),o("MAWRotateDTSG").tryRotateDTSG().then(function(t){throw t?new(r("WARetryableError"))(e):e});throw e});return s}),s.apply(this,arguments)}l.default=e}),98);
__d("WorkerRelay",["WorkerRelayNetwork","createWorkerMutation","createWorkerQuery","executeGraphQLQuery","relay-runtime"],(function(t,n,r,o,a,i,l){"use strict";i.exports={createWorkerMutation:r("createWorkerMutation"),createWorkerQuery:r("createWorkerQuery"),executeGraphQLQuery:o("executeGraphQLQuery").executeGraphQLQuery,getWorkerRelayEnvironment:o("WorkerRelayNetwork").getWorkerNetworkExecute,graphql:o("relay-runtime").graphql}}),34);
__d("createMainThreadQuery",["FBLogger","IGDWebUtils","MAWRotateDTSG","WARetryableError","asyncToGeneratorRuntime","executeGraphQLQuery","relay-runtime"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.getNetwork(),n={execute:t.execute};return n}function s(e,t,n){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a=o("relay-runtime").getRequest(e);if(a.params.operationKind!=="query")throw r("FBLogger")("messenger_web").mustfixThrow("createWorkerQuery: Expected query operation");var i=o("IGDWebUtils").isOnInstagramWeb(),l=yield o("executeGraphQLQuery").executeGraphQLQuery(n,e,t).then(function(e){return e.toPromise()}).then(function(e){var t,n=Array.isArray(e)?(t=e[0])==null?void 0:t.data:e==null?void 0:e.data;if(n!=null)return n}).catch(function(e){if(("code"in e&&e.code===1357004||"message"in e&&e.message.indexOf("1357004")!==-1||typeof e=="string"&&e.indexOf("1357004")!==-1)&&!i)return r("FBLogger")("messenger_web").info("Failed with expired DTSG, attempting to rotate."),o("MAWRotateDTSG").tryRotateDTSG().then(function(t){throw t?new(r("WARetryableError"))(e):e});throw e});return l}),u.apply(this,arguments)}l.getWorkerLikeRelayEnvironment=e,l.createMainThreadQuery=s}),98);
__d("EBCreateGraphQLFetchFnUnified",["EBAPIWorkerCheck","WorkerRelay","WorkerRelayNetwork","asyncToGeneratorRuntime","createMainThreadQuery","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e=r("requireDeferred")("CometRelayEnvironment").__setRef("EBCreateGraphQLFetchFnUnified");function s(){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=o("EBAPIWorkerCheck").runningInWorker();if(t)return yield o("WorkerRelayNetwork").createWorkerNetworkExecute(),o("WorkerRelay").createWorkerQuery;var n=yield e.load();return function(e,t){var r=o("createMainThreadQuery").getWorkerLikeRelayEnvironment(n);return o("createMainThreadQuery").createMainThreadQuery(e,t,r)}}),u.apply(this,arguments)}l.createGraphQlFetchFnUnified=s}),98);
__d("EBDeps",["FBLogger","err"],(function(t,n,r,o,a,i,l){"use strict";var e=null;function s(){if(e==null)throw r("err")("EBDeps is not initialized");return e}function u(t,n){if(e==null){var o={},a=function(a){var e=t[a];if(e==null)return 1;e instanceof Function?o[a]=function(){r("FBLogger")("wmi_eb").info("EBDeps: function %s, reason %s",a,n);for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return e.apply(t,i)}:(r("FBLogger")("wmi_eb").info("EBDeps: %s is not function",a),o[a]=e)};for(var i of Object.keys(t))a(i);e=o}}l.getDeps=s,l.setDeps=u}),98);
__d("EBGating",["gkx"],(function(t,n,r,o,a,i,l){"use strict";function e(){return!0}function s(){return r("gkx")("4877")}function u(){return r("gkx")("19324")}function c(){return r("gkx")("16303")}l.isEBSMv2Phase1Enabled=e,l.isFetchBackupIdsFromWorker=s,l.isGetEBSMDataFromRelay=u,l.isEBSMRefetchInWorkerEnabled=c}),98);
__d("LSEncryptedBackupsBackupTenancy",[],(function(t,n,r,o,a,i){var e=Object.freeze({PRODUCTION:1,SHADOW:2,OPEN:3});i.default=e}),66);
__d("WAPubSub",["err"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){this.$1=new Set}var t=e.prototype;return t.publish=function(t){this.$1.forEach(function(e){return e(t)})},t.subscribe=function(t){var e=this;return this.$1.add(t),function(){e.$1.delete(t)}},e})(),s=(function(){function e(){this.$1=new Map}var t=e.prototype;return t.publish=function(t,n){var e=this.$2(t);e.forEach(function(e){return e(n)})},t.$2=function(t){(!this.$1.has(t)||this.$1.get(t)==null)&&this.$1.set(t,new Set);var e=this.$1.get(t);if(e==null)throw r("err")("Key space should not be null");return e},t.subscribe=function(t,n){var e=this.$2(t);return e.add(n),function(){e.delete(n)}},e})();function u(){return new e}l.WAPubSub=e,l.WAKeyedPubSub=s,l.simplePubSub=u}),98);
__d("WAGenericStateManager",["Promise","WAPubSub"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(){function t(e){this.$2=o("WAPubSub").simplePubSub(),this.$1=e}var r=t.prototype;return r.onSet=function(t){return this.$2.subscribe(t)},r.set=function(t){return this.$1=t,this.$2.publish(t),this.$1},r.get=function(){return this.$1},r.waitForValue=function(r){var t=this;return this.$1===r?(e||(e=n("Promise"))).resolve():new(e||(e=n("Promise")))(function(e){var n=t.onSet(function(t){t===r&&(n(),e())})})},t})();l.WAGenericStateManager=s}),98);
__d("MAWEBEnabledStateManager",["WAGenericStateManager"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,null)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.isEnabled=function(){return this.get()===!0},n.waitForEBEnabled=function(){return this.waitForValue(!0)},t})(o("WAGenericStateManager").WAGenericStateManager);l.MAWEBEnabledStateManager=e}),98);
__d("MAWEBSwitch",["EBGating","ExecutionEnvironment","MAWEBEnabledStateManager","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("requireDeferred")("EBIsEbEnabledSubscriber").__setRef("MAWEBSwitch"),u=new(o("MAWEBEnabledStateManager")).MAWEBEnabledStateManager;((e||(e=r("ExecutionEnvironment"))).isInMainThread===!0||o("EBGating").isEBSMv2Phase1Enabled())&&s.load().then(function(e){return e.subscribeToEbChanges(function(e){u.set(e)})});var c=u;l.default=c}),98);
__d("MAWEncryptedBackupUtils",["FBLogger","I64","LSAuthorityLevel","LSDict","LSIntEnum","LSShape","LSVec","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(e,t){return o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.secure_encrypted_backups_client_state)).then(function(e){return c(e,t)})}function c(t,n){var a;if(t==null){n!=null&&n.addPoint("get_backup_tenancy_null_client_state_row");return}var i=(a=t.backupTenancy)!=null?a:(e||(e=o("I64"))).one,l=t.authorityLevel;if(n!=null&&n.addPoint("get_backup_tenancy",{int:{authorityLevel:(e||(e=o("I64"))).to_int32(l!=null?l:(e||(e=o("I64"))).zero),backupTenancy:e.to_int32(i!=null?i:(e||(e=o("I64"))).zero)}}),i!=null&&(e||(e=o("I64"))).equal((s||(s=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").AUTHORITATIVE),l))return i}function d(e,t){var n=new Set,o=e.length;for(var a of e.entries()){var i=a[0],l=a[1];n.has(l)&&r("FBLogger")("wmi_eb").warn("Duplicate messages returned from server for restoreType: %s, index: %s of batchSize: %s",t,i,o),n.add(l)}}function m(t){var n=t.map(function(t){var n=t.toplevelProtobuf,a=o("LSShape").ofRecord({decrypted_protobuf:n.decryptedProtobuf,protobuf_timestamp_ms:(e||(e=o("I64"))).of_float(n.protobufTimestampMS)}),i=new(r("LSDict"));return t.supplementalProtobufs.forEach(function(t,n){i.set(n,o("LSShape").ofRecord({decrypted_protobuf:t.decryptedProtobuf,protobuf_timestamp_ms:(e||(e=o("I64"))).of_float(t.protobufTimestampMS)}))}),o("LSShape").ofRecord({otid:t.otid,supplemental_protobufs:i,tags:t.tags,toplevel_protobuf:a})});return r("LSVec").ofArray(n)}function p(t){var n=r("LSVec").toArray(t),a=n.map(function(e){return o("LSShape").toRecord(e)});return a.map(function(t){var n=o("LSShape").toRecord(t.toplevel_protobuf),r={decryptedProtobuf:n.decrypted_protobuf,protobufTimestampMS:(e||(e=o("I64"))).to_float(n.protobuf_timestamp_ms)},a=new Map,i=t.supplemental_protobufs;return i.forEach(function(t,n){var r=o("LSShape").toRecord(t);a.set(n,{decryptedProtobuf:r.decrypted_protobuf,protobufTimestampMS:(e||(e=o("I64"))).to_float(r.protobuf_timestamp_ms)})}),{otid:t.otid,supplementalProtobufs:a,tags:t.tags,toplevelProtobuf:r}})}l.getBackupTenancy=u,l.getBackupTenancyFromClientStateRow=c,l.logIfDuplicateMessagesFoundInRestore=d,l.convertJSTypesToLSTypesForRestoreJob=m,l.convertLSTypesToJSTypesForRestoreJob=p}),98);
__d("EBIsEbEnabled",["EBDeps","FBLogger","I64","LSEncryptedBackupsBackupTenancy","LSIntEnum","MAWEBSwitch","MAWEncryptedBackupUtils","WAResultOrError","asyncToGeneratorRuntime","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t,n){return o("MAWEncryptedBackupUtils").getBackupTenancy(t,n).then(function(t){return t!=null&&(e||(e=o("I64"))).equal(t,(s||(s=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsBackupTenancy").PRODUCTION))})}function c(){try{return o("WAResultOrError").makeResult(r("MAWEBSwitch").isEnabled())}catch(e){return r("FBLogger")("wmi_eb").catching(r("getErrorSafe")(e)).mustfix("Failed to check EB enabled"),o("WAResultOrError").makeResult(!1)}}function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("EBDeps").getDeps().getLSDB();return u(e.tables)}),m.apply(this,arguments)}l.isEbEnabledLS=u,l.isEbEnabledEbSwitch=c,l.isEBEnabled=d}),98);
__d("EBIsEbEnabledSubscriber",["EBDeps","EBIsEbEnabled","I64","LSEncryptedBackupsBackupTenancy","LSIntEnum","Promise","ReQL","WAPubSub","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=(function(){function e(e){this.$1=o("WAPubSub").simplePubSub(),this.$4=e,this.$2=!1}var t=e.prototype;return t.initialize=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){this.$2=yield o("EBIsEbEnabled").isEbEnabledLS(this.$4.tables),this.$5(this.$4)});function t(){return e.apply(this,arguments)}return t})(),t.$6=function(t){this.$2=t,this.$1.publish(t)},t.$5=function(t){var e=this;return this.$3==null&&(this.$3=o("ReQL").fromTableAscending(t.tables.secure_encrypted_backups_client_state).take(1).subscribe(function(t,n){n.operation==="delete"&&e.$6(!1),(n.operation==="add"||n.operation==="put")&&(n.value.backupTenancy!=null&&(s||(s=o("I64"))).equal(n.value.backupTenancy,(u||(u=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsBackupTenancy").PRODUCTION))?e.$6(!0):e.$6(!1))})),this.$3},t.subscribe=function(t){return this.$1.subscribe(t)},t.isEnabled=function(){return this.$2},e})(),d;function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(d!=null)return(e||(e=n("Promise"))).resolve();d=new c(t),yield d.initialize()}),p.apply(this,arguments)}function _(){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d==null){var e=yield o("EBDeps").getDeps().getLSDB();yield m(e)}return d}),f.apply(this,arguments)}function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(d==null){var t=yield o("EBDeps").getDeps().getLSDB();yield m(t)}e(d.isEnabled());var n=d.subscribe(e);return n}),h.apply(this,arguments)}function y(){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d==null){var e=yield o("EBDeps").getDeps().getLSDB();yield m(e)}return d.isEnabled()}),C.apply(this,arguments)}l.initIsEbEnabledPubSub=m,l.isEbEnabledSubscriber=_,l.subscribeToEbChanges=g,l.isEBEnabledValueFromSubscriber=y}),98);
__d("EBMarkerIdToQPLEvent",["I64","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var n=(e||(e=o("I64"))).to_int32(t);switch(n){case 1021646192:return r("qpl")._(1021646192,"3099");case 1021656232:return r("qpl")._(1021656232,"3100");case 1021647318:return r("qpl")._(1021647318,"3101");case 1021651622:return r("qpl")._(1021651622,"3102");case 1021655799:return r("qpl")._(1021655799,"3103");case 1021648929:return r("qpl")._(1021648929,"3104");case 1021647593:return r("qpl")._(1021647593,"3105");case 1021653744:return r("qpl")._(1021653744,"3106");case 1021655355:return r("qpl")._(1021655355,"3107");case 1021648240:return r("qpl")._(1021648240,"3108");case 1021651939:return r("qpl")._(1021651939,"3109");case 1021656851:return r("qpl")._(1021656851,"3110");case 1021652813:return r("qpl")._(1021652813,"3111");case 1021653501:return r("qpl")._(1021653501,"3112");case 1021655710:return r("qpl")._(1021655710,"3114");case 1021655643:return r("qpl")._(1021655643,"3115");case 1021646076:return r("qpl")._(1021646076,"3116");case 1021642512:return r("qpl")._(1021642512,"3117");case 1021654781:return r("qpl")._(1021654781,"3118");case 1021649468:return r("qpl")._(1021649468,"3120");case 1021652080:return r("qpl")._(1021652080,"3121");case 1021652512:return r("qpl")._(1021652512,"3122");case 1021655828:return r("qpl")._(1021655828,"3124");case 1021642298:return r("qpl")._(1021642298,"3126");case 1021652377:return r("qpl")._(1021652377,"3127");case 521471316:return r("qpl")._(521471316,"2831");case 521478596:return r("qpl")._(521478596,"1329");case 521479468:return r("qpl")._(521479468,"3128");case 521482563:return r("qpl")._(521482563,"3129");case 521482912:return r("qpl")._(521482912,"3131");case 521481876:return r("qpl")._(521481876,"1407");case 521471732:return r("qpl")._(521471732,"1454");case 521477507:return r("qpl")._(521477507,"1406");case 521478817:return r("qpl")._(521478817,"2806");case 521476801:return r("qpl")._(521476801,"3132");case 521484724:return r("qpl")._(521484724,"141");case 521473756:return r("qpl")._(521473756,"2768");case 521477113:return r("qpl")._(521477113,"2698");case 521478750:return r("qpl")._(521478750,"2850");case 521479165:return r("qpl")._(521479165,"3055");case 521484370:return r("qpl")._(521484370,"2995");case 521473213:return r("qpl")._(521473213,"27");case 521482281:return r("qpl")._(521482281,"2703");case 521476771:return r("qpl")._(521476771,"2454");case 521474469:return r("qpl")._(521474469,"2612");case 521471755:return r("qpl")._(521471755,"2586");case 521476367:return r("qpl")._(521476367,"2704");case 521473850:return r("qpl")._(521473850,"2910");case 521482558:return r("qpl")._(521482558,"2558");case 521482880:return r("qpl")._(521482880,"16");case 521473150:return r("qpl")._(521473150,"2143");case 521473369:return r("qpl")._(521473369,"2834");case 521485893:return r("qpl")._(521485893,"2835");case 521473922:return r("qpl")._(521473922,"2832");case 521479146:return r("qpl")._(521479146,"3133");case 521471468:return r("qpl")._(521471468,"2968");case 521480391:return r("qpl")._(521480391,"1167");case 521480745:return r("qpl")._(521480745,"3134");case 521481602:return r("qpl")._(521481602,"829");case 521475102:return r("qpl")._(521475102,"3135");case 521484676:return r("qpl")._(521484676,"2684");case 521485625:return r("qpl")._(521485625,"1876");case 521482085:return r("qpl")._(521482085,"409");case 521471024:return r("qpl")._(521471024,"2275");case 521474385:return r("qpl")._(521474385,"263");case 521479842:return r("qpl")._(521479842,"2163");case 521485383:return r("qpl")._(521485383,"2200");case 521478580:return r("qpl")._(521478580,"3136");case 521485815:return r("qpl")._(521485815,"3137");case 521482969:return r("qpl")._(521482969,"1519");case 521485406:return r("qpl")._(521485406,"272");case 521479972:return r("qpl")._(521479972,"3138");case 521484777:return r("qpl")._(521484777,"2715");case 521483076:return r("qpl")._(521483076,"3140");case 521482858:return r("qpl")._(521482858,"1290");case 521472542:return r("qpl")._(521472542,"295");case 521472456:return r("qpl")._(521472456,"1646");case 521476140:return r("qpl")._(521476140,"378");case 521473194:return r("qpl")._(521473194,"1331");case 521482763:return r("qpl")._(521482763,"296");case 521484295:return r("qpl")._(521484295,"1460");case 521476165:return r("qpl")._(521476165,"2432");case 521477947:return r("qpl")._(521477947,"2395");case 521486220:return r("qpl")._(521486220,"827");case 521482576:return r("qpl")._(521482576,"1069");case 521479124:return r("qpl")._(521479124,"1939");case 521476098:return r("qpl")._(521476098,"504");case 521472095:return r("qpl")._(521472095,"2859")}return null}l.markerIdToQPLEvent=s}),98);
__d("EBMinosLogger",["WATagsLogger"],(function(t,n,r,o,a,i,l){"use strict";var e=o("WATagsLogger").TAGS(["minos"]);l.minosLogger=e}),98);
__d("EBMinosMessageEncryptionVersion",["$InternalEnum","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=n("$InternalEnum")({V1:1,V2:2}),s=e.V1,u=r("gkx")("19866")?e.V2:e.V1;l.MinosMessageEncryptionVersion=e,l.INITIAL_VERSION=s,l.MINOS_MESSAGE_ENCRYPTION_CURRENT_VERSION=u}),98);
__d("EBMinosMessageMetadataVersion",["$InternalEnum","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=n("$InternalEnum")({V1:1,V2:2}),s=e.V1,u=r("gkx")("4258")?e.V2:e.V1;l.MinosMessageMetadataVersion=e,l.INITIAL_VERSION=s,l.MESSAGE_METADATA_CURRENT_VERSION=u}),98);
__d("EBMinosTypes",["$InternalEnum","WAJids","WALongInt"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return e}function s(e){return e.endsWith(o("WAJids").MSGR_USER_DOMAIN)?e.slice(0,-o("WAJids").MSGR_USER_DOMAIN.length):null}var u=o("WAJids").createJidUtils({platform:"msgr"});function c(e){return u.toUserJid(e)}function d(e){return e}function m(e){return e}function p(e){return e}function _(e){return e}function f(e){return e}function g(e){return o("WALongInt").decimalStringToLongInt(new TextDecoder().decode(e))}function h(e){return e}function y(e){return e}function C(e){return e}function b(e){return e}function v(e){return e}function S(e){return e}function R(e){return e}function L(e){return e}function E(e){return e}function k(e){return e}function I(e){return e}function T(e){return e}function D(e){return e}function x(e){return e}function $(e){return e}function P(e){return e}function N(e){return e}function M(e){return e}function w(e){return e}function A(e){return e}function F(e){return e}function O(e){return e}function B(e){return e}function W(e){return e}function q(e){return e}function U(e){return e}function V(e){return e}function H(e){return e}var G=n("$InternalEnum")({INVALID:"-1",IMAGE:"0",PTT:"1",DOCUMENT:"3",VIDEO:"4",GIF:"5",STICKER:"6",XMA:"22",MESSENGER_PREVIEW:"25"});l.unsafeCastToUserFbId=e,l.userJidToUserFbId=s,l.userFbidToUserJid=c,l.unsafeCastToMinosThreadId=d,l.unsafeCastToEpochHead=m,l.unsafeCastToEpochSelfSig=p,l.unsafeCastToEpochPrevSig=_,l.unsafeCastToEpochNumber=f,l.unsafeCastToBase64StringIntToEpochNumber=g,l.unsafeCastToEpochCreationTime=h,l.unsafeCastToExportRootKey=y,l.unsafeCastToMekId=C,l.unsafeCastMekKey=b,l.unsafeCastMekRosterHash=v,l.unsafeCastToEncryptedMek=S,l.unsafeCastToMekFbId=R,l.unsafeCastToMekMiThreadId=L,l.unsafeCastToBackupFbid=E,l.unsafeCastToDeviceId=k,l.unsafeCastToEncryptedMessage=I,l.unsafeCastToEncryptedMessageSignature=T,l.unsafeCastToDecryptedMessage=D,l.unsafeCastToMailboxFbId=x,l.unsafeCastToMailboxSigningPK=$,l.unsafeCastToMailboxSigningSK=P,l.unsafeCastToMailboxEncryptionPK=N,l.unsafeCastToMailboxEncryptionSK=M,l.unsafeCastToMailboxAuthPK=w,l.unsafeCastToMailboxAuthSK=A,l.unsafeCastToTransportSenderEphemeralPK=F,l.unsafeCastToTransportSenderEphemeralKeySig=O,l.unsafeCastToTransportSigningPK=B,l.unsafeCastToTransportSigningSK=W,l.unsafeCastToEpochFbId=q,l.castToSupplementalOpToken=U,l.unsafeCastToAttachmentAccessTokenSecret=V,l.unsafeCastToAttachmentPrimaryKeySecret=H,l.MinosAttachmentMediaType=G}),98);
__d("MSGDataclassTypes.flow",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e,l=(e=n("$InternalEnum"))({LlmOutput:"llm_output",SendQuery:"send_query",StartTyping:"start_typing",StopTyping:"stop_typing",VideoAboutToFinish:"video_about_to_finish"}),s=e({SummarizeInboxFnfMessages:"SUMMARIZE_INBOX_FNF_MESSAGES",PsiQueryPlan:"PSI_QUERY_PLAN"}),u=e({End:"END",Start:"START"}),c=e({CopyToClipboard:"COPY_TO_CLIPBOARD",SendToChat:"SEND_TO_CHAT",FollowUpPrompt:"FOLLOW_UP_PROMPT"}),d=e({Keyword:"KEYWORD",Method:"METHOD",Str:"STR",Number:"NUMBER",Comment:"COMMENT",Default:"DEFAULT"}),m=e({Follow:"FOLLOW",Unfollow:"UNFOLLOW",Join:"JOIN",Leave:"LEAVE"}),p=e({Group:"GROUP",Page:"PAGE"}),_=e({HorizontalLine:"HORIZONTAL_LINE",Dot:"DOT"}),f=e({OpenFullView:"OPEN_FULL_VIEW",CancelReasoning:"CANCEL_REASONING"}),g=e({Fetching:"FETCHING",Fetched:"FETCHED",Failed:"FAILED"}),h=e({Generating:"GENERATING",Ready:"READY",Failed:"FAILED"}),y=e({Imagine:"IMAGINE",Animate:"ANIMATE",Memu:"MEMU"}),C=e({Fetching:"FETCHING",Fetched:"FETCHED",Failed:"FAILED"}),b=e({Start:"START",End:"END"}),v=e({Circle:"CIRCLE",Square:"SQUARE",Vertical:"VERTICAL"}),S=e({Top:"TOP",Center:"CENTER"}),R=e({InThread:"IN_THREAD",BottomSheet:"BOTTOM_SHEET"}),L=e({Bing:"BING",Brave:"BRAVE",Google:"GOOGLE",HelpCenter:"HELP_CENTER",InHouse:"IN_HOUSE",Kss:"KSS",Mase:"MASE"}),E=e({Landscape:"LANDSCAPE",Portrait:"PORTRAIT"}),k=e({GroupPost:"GROUP_POST",PagePost:"PAGE_POST"}),I=e({Planned:"PLANNED",InProgress:"IN_PROGRESS",Completed:"COMPLETED",Stopped:"STOPPED"}),T=e({Facebook:"FACEBOOK",Instagram:"INSTAGRAM",Threads:"THREADS"}),D=e({FacebookPost:"FACEBOOK_POST",InstagramPost:"INSTAGRAM_POST",ThreadsPost:"THREADS_POST",ThirdParty:"THIRD_PARTY"}),x=e({ContextualMenu:"CONTEXTUAL_MENU",AiLookup:"AI_LOOKUP"}),$=e({Restaurant:"RESTAURANT",Movie:"MOVIE",TvShows:"TV_SHOWS",Celebrity:"CELEBRITY",SportsTeam:"SPORTS_TEAM",InfoTerm:"INFO_TERM"}),P=e({Reasoning:"REASONING",Responding:"RESPONDING"}),N=e({Default:"DEFAULT",CriticalUserMessage:"CRITICAL_USER_MESSAGE",NonCriticalAdminXma:"NON_CRITICAL_ADMIN_XMA"}),M=e({ThreadviewSuggestedPrompt:"THREADVIEW_SUGGESTED_PROMPT",TypeaheadSuggestedPrompt:"TYPEAHEAD_SUGGESTED_PROMPT",SuggestedPrompt:"SUGGESTED_PROMPT",NullStatePrompt:"NULL_STATE_PROMPT",UserInputPrompt:"USER_INPUT_PROMPT",GenericPrompt:"GENERIC_PROMPT",ThreadviewUserInputPrompt:"THREADVIEW_USER_INPUT_PROMPT",Icebreakers:"ICEBREAKERS",ThreadSurfingPrompt:"THREAD_SURFING_PROMPT",MetaAiVoiceConversationStarter:"META_AI_VOICE_CONVERSATION_STARTER",MetaAiTextConversationStarter:"META_AI_TEXT_CONVERSATION_STARTER",MetaAiFabHint:"META_AI_FAB_HINT",AiLookup:"AI_LOOKUP"}),w=e({DeleteBackupStateOnClient:"DELETE_BACKUP_STATE_ON_CLIENT",IssueCheckBackupStateTask:"ISSUE_CHECK_BACKUP_STATE_TASK",UpsertStatusTrigger:"UPSERT_STATUS_TRIGGER",UpsertReenrollmentTrigger:"UPSERT_REENROLLMENT_TRIGGER",UpdateInitializeRestoreResult:"UPDATE_INITIALIZE_RESTORE_RESULT",InitializeRestore:"INITIALIZE_RESTORE",DeleteAndInsertPakeMessage:"DELETE_AND_INSERT_PAKE_MESSAGE",RotateDeviceKeysStart:"ROTATE_DEVICE_KEYS_START",LegacyRetroactiveBackup:"LEGACY_RETROACTIVE_BACKUP",UpdatePbqWithNeedsBackupUploadStatus:"UPDATE_PBQ_WITH_NEEDS_BACKUP_UPLOAD_STATUS",SyncDeviceCreationTimestamp:"SYNC_DEVICE_CREATION_TIMESTAMP"}),A=e({Message:"MESSAGE",Thread:"THREAD"}),F=e({UpsertBackupItem:"UPSERT_BACKUP_ITEM",RemoveBackupItem:"REMOVE_BACKUP_ITEM"}),O=e({Retroactive:"RETROACTIVE",Realtime:"REALTIME",InfiniteRetroactive:"INFINITE_RETROACTIVE",Retry:"RETRY"}),B=e({Before:"BEFORE",After:"AFTER"}),W=e({Photo:"PHOTO",Permanent:"PERMANENT",Ephemeral:"EPHEMERAL",Video:"VIDEO",Gif:"GIF",Audio:"AUDIO",File:"FILE",Raven:"RAVEN",UnreadRaven:"UNREAD_RAVEN",ShareIgMedia:"SHARE_IG_MEDIA",ShareLink:"SHARE_LINK",ShareIgClips:"SHARE_IG_CLIPS",Shh:"SHH",StoryReply:"STORY_REPLY",DisappearingMessage:"DISAPPEARING_MESSAGE",RavenSeen:"RAVEN_SEEN",RavenReplayed:"RAVEN_REPLAYED",RavenReadOnce:"RAVEN_READ_ONCE",RavenReplayable:"RAVEN_REPLAYABLE",RavenPermanent:"RAVEN_PERMANENT",ActionLog:"ACTION_LOG"}),q=e({HistoryRestore:"HISTORY_RESTORE",Reporting:"REPORTING",Fts:"FTS",NewMemberExport:"NEW_MEMBER_EXPORT",MpsReadApis:"MPS_READ_APIS"}),U=e({NotApplicable:"NOT_APPLICABLE",NeedsUpload:"NEEDS_UPLOAD",AlreadyUploaded:"ALREADY_UPLOADED"}),V=e({Success:"SUCCESS",RetryableException:"RETRYABLE_EXCEPTION",PermanentFailure:"PERMANENT_FAILURE"}),H=e({Fbn:"FBN",Instamadillo:"INSTAMADILLO",Unknown:"UNKNOWN"}),G=e({Unknown:"UNKNOWN",Memu:"MEMU",Synthetic:"SYNTHETIC",UserUploaded:"USER_UPLOADED"}),z=e({AskMetaAi:"ASK_META_AI",Summarize:"SUMMARIZE"}),j=e({GetInfo:"GET_INFO",GetRestaurantInfo:"GET_RESTAURANT_INFO",Reviews:"REVIEWS",MenuHighlights:"MENU_HIGHLIGHTS",Address:"ADDRESS",WhereToWatch:"WHERE_TO_WATCH",LatestNews:"LATEST_NEWS",FindNextGame:"FIND_NEXT_GAME",ResponseCard:"RESPONSE_CARD"}),K=e({Restaurant:"RESTAURANT",Movie:"MOVIE",TvShows:"TV_SHOWS",Celebrity:"CELEBRITY",SportsTeam:"SPORTS_TEAM"}),Q=e({MagicModBackdrop:"MAGIC_MOD_BACKDROP",MagicModRestyle:"MAGIC_MOD_RESTYLE",Imagine:"IMAGINE",Memu:"MEMU",HiddenMetadata:"HIDDEN_METADATA",AiVoiceNotes:"AI_VOICE_NOTES"}),X=e({XmaWebUrl:"XMA_WEB_URL",XmaOpenNative:"XMA_OPEN_NATIVE",XmaMsgExternalLinkShare:"XMA_MSG_EXTERNAL_LINK_SHARE",XmaGenAiSearchPluginResponseSources:"XMA_GEN_AI_SEARCH_PLUGIN_RESPONSE_SOURCES",XmaSharedAlbumViewer:"XMA_SHARED_ALBUM_VIEWER",XmaMetaAiSingleSubscription:"XMA_META_AI_SINGLE_SUBSCRIPTION",XmaMetaAiSubscriptions:"XMA_META_AI_SUBSCRIPTIONS",XmaMetaAiReminders:"XMA_META_AI_REMINDERS",XmaMetaAiTask:"XMA_META_AI_TASK",XmaGamePlay:"XMA_GAME_PLAY",ViewSingleAiTask:"VIEW_SINGLE_AI_TASK",ViewAllAiTasks:"VIEW_ALL_AI_TASKS",XmaMetaAiLocation:"XMA_META_AI_LOCATION",XmaMetaAiLookupEntity:"XMA_META_AI_LOOKUP_ENTITY",XmaP2POpgTransfer:"XMA_P2P_OPG_TRANSFER",MarketplaceXmaCallFunction:"MARKETPLACE_XMA_CALL_FUNCTION",XmaMetaAiDigestSeeSummary:"XMA_META_AI_DIGEST_SEE_SUMMARY",XmaMusicArtist:"XMA_MUSIC_ARTIST",MarketplaceXmatCallFunction:"MARKETPLACE_XMAT_CALL_FUNCTION"}),Y=e({PaidPartnership:"PAID_PARTNERSHIP",NoBranding:"NO_BRANDING"}),J=e({Imagine:"IMAGINE",Imaginev2:"IMAGINEV2",Imagineme:"IMAGINEME"}),Z=e({Animate:"ANIMATE",AnimateImagineme:"ANIMATE_IMAGINEME"}),ee=e({Mention:"MENTION",SuperReact:"SUPER_REACT",StoryReply:"STORY_REPLY",MessageReply:"MESSAGE_REPLY",ContentReply:"CONTENT_REPLY",ContentMention:"CONTENT_MENTION",ContentShare:"CONTENT_SHARE",OnPlatform:"ON_PLATFORM",OffPlatform:"OFF_PLATFORM",MessageForward:"MESSAGE_FORWARD",Avatar:"AVATAR",SocialSticker:"SOCIAL_STICKER",NoteReply:"NOTE_REPLY",InvokesGenAiResponse:"INVOKES_GEN_AI_RESPONSE",SentFromGenAiBot:"SENT_FROM_GEN_AI_BOT",DisappearingMessage:"DISAPPEARING_MESSAGE",IncludesOnPlatformContent:"INCLUDES_ON_PLATFORM_CONTENT",IncludesOffPlatformContent:"INCLUDES_OFF_PLATFORM_CONTENT",IncludesLink:"INCLUDES_LINK",MultitabEnv:"MULTITAB_ENV",PowerUp:"POWER_UP",MsysSend:"MSYS_SEND",EditMessage:"EDIT_MESSAGE",VanishMode:"VANISH_MODE",Superlative:"SUPERLATIVE",Raven:"RAVEN",Hotlike:"HOTLIKE",IsDialtone:"IS_DIALTONE",MessageReshare:"MESSAGE_RESHARE",PostReply:"POST_REPLY",IsNotDialtone:"IS_NOT_DIALTONE",ThirdPartyReshare:"THIRD_PARTY_RESHARE",ZeroBalanceDetected:"ZERO_BALANCE_DETECTED",ConversationStarter:"CONVERSATION_STARTER",AnimatedAiSticker:"ANIMATED_AI_STICKER",AiGeneratedSticker:"AI_GENERATED_STICKER",MagicModImage:"MAGIC_MOD_IMAGE",ShareOfOriginalUserContent:"SHARE_OF_ORIGINAL_USER_CONTENT",LightweightInteractionAsStoryReply:"LIGHTWEIGHT_INTERACTION_AS_STORY_REPLY",WriteWithMetaAi:"WRITE_WITH_META_AI",AvatarStyle_1:"AVATAR_STYLE_1",AvatarStyle_2:"AVATAR_STYLE_2",MetaAiEntitySuggestedPrompts:"META_AI_ENTITY_SUGGESTED_PROMPTS",ContentConversationStarter:"CONTENT_CONVERSATION_STARTER",MetaAiIntents:"META_AI_INTENTS",QuicksnapReply:"QUICKSNAP_REPLY",ContentBasedSparks:"CONTENT_BASED_SPARKS"}),te=e({Memu:"MEMU",Imagine:"IMAGINE",ImagineRestyle:"IMAGINE_RESTYLE"}),ne=e({Reminder:"REMINDER",Subscription:"SUBSCRIPTION"}),re=e({Text:"text",Image:"image",Voice:"voice",Link_1p:"link_1p",Link_3p:"link_3p"}),oe=e({MothersDay:"MOTHERS_DAY",FathersDay:"FATHERS_DAY",Graduation:"GRADUATION",NationalSelfie:"NATIONAL_SELFIE",PhIndependenceDay:"PH_INDEPENDENCE_DAY",JulyFourth:"JULY_FOURTH",FriendshipDay:"FRIENDSHIP_DAY"}),ae=e({Birthday:"BIRTHDAY",Attribution:"ATTRIBUTION"}),ie=e({Note:"NOTE",Story:"STORY",Profile:"PROFILE",Clip:"CLIP",Feed:"FEED",Live:"LIVE",Comment:"COMMENT",LocationShare:"LOCATION_SHARE",ReelsAudio:"REELS_AUDIO",MediaNote:"MEDIA_NOTE",StoryHighlight:"STORY_HIGHLIGHT",SocialContext:"SOCIAL_CONTEXT"}),le=e({Mention:"MENTION",Reply:"REPLY"}),se=e({Share:"SHARE",Reply:"REPLY",React:"REACT",Mention:"MENTION"}),ue=e({Undefined:"UNDEFINED",Genmoji:"GENMOJI",Metamoji:"METAMOJI",AnimatedEmoji:"ANIMATED_EMOJI"}),ce=e({GenAiGetInfo:"GEN_AI_GET_INFO",GenAiReminder:"GEN_AI_REMINDER",GenAiThreadSurfing:"GEN_AI_THREAD_SURFING"}),de=e({Unknown:"UNKNOWN",AnimatedThankImage:"ANIMATED_THANK_IMAGE",AnimatedThankImageWithTextMessage:"ANIMATED_THANK_IMAGE_WITH_TEXT_MESSAGE"}),me=e({Unknown:"UNKNOWN",BulkReply:"BULK_REPLY",AutoReply:"AUTO_REPLY"}),pe=e({AttachmentPreviewMedia:"ATTACHMENT_PREVIEW_MEDIA",AttachmentPreviewHeaderMedia:"ATTACHMENT_PREVIEW_HEADER_MEDIA"}),_e=e({Simple:"SIMPLE",Retro:"RETRO",Messages:"MESSAGES"}),fe=e({Simple:"SIMPLE",Retro:"RETRO",Messages:"MESSAGES"}),ge=e({Unactioned:"UNACTIONED",Accepted:"ACCEPTED",Deleted:"DELETED"}),he=e({FbmInbox:"FBM_INBOX",Profile:"PROFILE",Feed:"FEED",FbSearch:"FB_SEARCH",Watch:"WATCH",Shorts:"SHORTS",Ufi:"UFI",Ctm:"CTM",Cts:"CTS",Psrib:"PSRIB",Srib:"SRIB",Rta:"RTA",Mp:"MP",CommentMentions:"COMMENT_MENTIONS",ZorroMessage:"ZORRO_MESSAGE",FbHelpCenterXsMetaAi:"FB_HELP_CENTER_XS_META_AI",Dating:"DATING",IgReels:"IG_REELS",IgStory:"IG_STORY",IgFeed:"IG_FEED",IgProfile:"IG_PROFILE",IgNotes:"IG_NOTES",IgLive:"IG_LIVE",IgExternalLink:"IG_EXTERNAL_LINK",IgComment:"IG_COMMENT",FbNotes:"FB_NOTES",FbGroups:"FB_GROUPS",GenAiSuggestedPrompts:"GEN_AI_SUGGESTED_PROMPTS",GenAiMultiModal:"GEN_AI_MULTI_MODAL",GenAiFlAshImagine:"GEN_AI_FlASH_IMAGINE",GenAiAssistant:"GEN_AI_ASSISTANT",GenAiLocation:"GEN_AI_LOCATION",Sharesheet:"SHARESHEET",ProductHighlights:"PRODUCT_HIGHLIGHTS",MagicMessenger:"MAGIC_MESSENGER",SpectraAction:"SPECTRA_ACTION"}),ye=e({MsgrE2EeGenai:"MSGR_E2EE_GENAI"}),Ce=e({Statusupdate:"STATUSUPDATE",Grouppost:"GROUPPOST",Shareurl:"SHAREURL",Unifiedresponse:"UNIFIEDRESPONSE"}),be=e({Single:"SINGLE",Hscroll:"HSCROLL",Xcenter:"XCENTER",Portrait:"PORTRAIT",Layered:"LAYERED",Placeholder:"PLACEHOLDER",ExpiredPlaceholder:"EXPIRED_PLACEHOLDER",PilePrompt:"PILE_PROMPT",Stack:"STACK",SharedStack:"SHARED_STACK",StackCard:"STACK_CARD",StandardDxma:"STANDARD_DXMA",DxmaPlaceholder:"DXMA_PLACEHOLDER",Grid:"GRID"}),ve=e({Share:"SHARE",Reply:"REPLY",Mention:"MENTION",Bump:"BUMP"}),Se=e({XmaWebUrl:"XMA_WEB_URL"}),Re=e({Mention:"MENTION",Reply:"REPLY"}),Le=e({Note:"NOTE",Prompt:"PROMPT",PromptResponse:"PROMPT_RESPONSE"}),Ee=e({Video:"VIDEO",Image:"IMAGE",Other:"OTHER"}),ke=e({Love:"LOVE",Giftwrap:"GIFTWRAP",Celebration:"CELEBRATION",Fire:"FIRE",AvatarLove:"AVATAR_LOVE",AvatarAngry:"AVATAR_ANGRY",AvatarCry:"AVATAR_CRY",AvatarLaugh:"AVATAR_LAUGH",Halloween:"HALLOWEEN",NomNomDash:"NOM_NOM_DASH",NewYears:"NEW_YEARS",ValentinesDay:"VALENTINES_DAY",AntiValentines:"ANTI_VALENTINES"}),Ie=e({None:"NONE",BasicSuperReactAnimation:"BASIC_SUPER_REACT_ANIMATION",FbEmoji:"FB_EMOJI",NonDefaultEmoji:"NON_DEFAULT_EMOJI"}),Te=e({Text:"TEXT",Media:"MEDIA"}),De=e({SenderParent:"SENDER_PARENT",RecipientParent:"RECIPIENT_PARENT",Classifier:"CLASSIFIER",ReactiveEnforcement:"REACTIVE_ENFORCEMENT"}),xe=e({Takedown:"TAKEDOWN",Restore:"RESTORE"}),$e=e({Unknown:"UNKNOWN",SoftDeleteWithAppeal:"SOFT_DELETE_WITH_APPEAL",SoftDeleteWithoutAppeal:"SOFT_DELETE_WITHOUT_APPEAL",PermanentDelete:"PERMANENT_DELETE",SoftDeleteWithAppealParentUnviewable:"SOFT_DELETE_WITH_APPEAL_PARENT_UNVIEWABLE",SoftDeleteWithoutAppealParentUnviewable:"SOFT_DELETE_WITHOUT_APPEAL_PARENT_UNVIEWABLE"}),Pe=e({Unknown:"UNKNOWN",TwoOptionCombined:"TWO_OPTION_COMBINED",IgTwoOptionCombined:"IG_TWO_OPTION_COMBINED",FiveOptionStarRating:"FIVE_OPTION_STAR_RATING"}),Ne=e({Unknown:"UNKNOWN",Location:"LOCATION",People:"PEOPLE",Event:"EVENT",ResharedPost:"RESHARED_POST",ResharedContent:"RESHARED_CONTENT",Page:"PAGE",Fundraiser:"FUNDRAISER",Product:"PRODUCT",AntiBully:"ANTI_BULLY",Instagram:"INSTAGRAM"}),Me=e({Unspecified:"UNSPECIFIED",QuickEmoji:"QUICK_EMOJI",Avatar:"AVATAR",SuggestedReply:"SUGGESTED_REPLY",PostLwrSuggestedReply:"POST_LWR_SUGGESTED_REPLY",WriteWithAi:"WRITE_WITH_AI",GifLightWeight:"GIF_LIGHT_WEIGHT",StickerLightWeight:"STICKER_LIGHT_WEIGHT",QuickEmojiPalette:"QUICK_EMOJI_PALETTE",SuggestedText:"SUGGESTED_TEXT",SuggestedEmoji:"SUGGESTED_EMOJI",SuggestedEmojiText:"SUGGESTED_EMOJI_TEXT"}),we=e({RequestStart:"REQUEST_START",Searching:"SEARCHING",Imagining:"IMAGINING",UnderstandingImage:"UNDERSTANDING_IMAGE",Generating:"GENERATING",StreamingImage:"STREAMING_IMAGE"}),Ae=e({BanUser:"BAN_USER",RemoveUser:"REMOVE_USER",SuspendUser:"SUSPEND_USER",RemoveMessage:"REMOVE_MESSAGE",ReportMessage:"REPORT_MESSAGE",HideMessage:"HIDE_MESSAGE"}),Fe=e({Foo:"FOO",Bar:"BAR",Baz:"BAZ"}),Oe=e({Foo:"FOO",Bar:"BAR",Baz:"BAZ"}),Be=e({Untranscribed:"UNTRANSCRIBED",Transcribing:"TRANSCRIBING",Success:"SUCCESS",Error:"ERROR",UnsupportedLanguage:"UNSUPPORTED_LANGUAGE"}),We=e({Unknown:"UNKNOWN",Product:"PRODUCT",Faq:"FAQ",Chat:"CHAT",Post:"POST",Other:"OTHER"}),qe=e({Unknown:"UNKNOWN",Product:"PRODUCT",Faq:"FAQ",Chat:"CHAT",Post:"POST",Pricelist:"PRICELIST",Other:"OTHER"}),Ue=e({Keyword:"KEYWORD",Method:"METHOD",Str:"STR",Number:"NUMBER",Comment:"COMMENT",Default:"DEFAULT"}),Ve=e({Chevron:"CHEVRON"}),He=e({Square:"SQUARE",Circle:"CIRCLE"}),Ge=e({Album:"ALBUM",Clips:"CLIPS",Video:"VIDEO"}),ze=e({Test:"TEST",None:"NONE",IgMediaShare:"IG_MEDIA_SHARE",IgMultipostShare:"IG_MULTIPOST_SHARE",IgStoryReply:"IG_STORY_REPLY",IgStoryPhotoShare:"IG_STORY_PHOTO_SHARE",IgStoryPhotoMention:"IG_STORY_PHOTO_MENTION",IgClipsShare:"IG_CLIPS_SHARE",IgSingleVideoPostShare:"IG_SINGLE_VIDEO_POST_SHARE",IgStoryVideoShare:"IG_STORY_VIDEO_SHARE",IgStoryReaction:"IG_STORY_REACTION",IgIgtvShare:"IG_IGTV_SHARE",IgShopShare:"IG_SHOP_SHARE",IgProfileShare:"IG_PROFILE_SHARE",IgStoryPhotoHighlightShare:"IG_STORY_PHOTO_HIGHLIGHT_SHARE",IgStoryVideoHighlightShare:"IG_STORY_VIDEO_HIGHLIGHT_SHARE",IgStoryVideoMention:"IG_STORY_VIDEO_MENTION",IgStoryHighlightReply:"IG_STORY_HIGHLIGHT_REPLY",IgStoryHighlightReaction:"IG_STORY_HIGHLIGHT_REACTION",IgExternalLink:"IG_EXTERNAL_LINK",IgReceiverFetch:"IG_RECEIVER_FETCH",IgTextPostAppShare:"IG_TEXT_POST_APP_SHARE",FbFeedShare:"FB_FEED_SHARE",FbStoryReply:"FB_STORY_REPLY",FbStoryShare:"FB_STORY_SHARE",FbStoryMention:"FB_STORY_MENTION",FbFeedVideoShare:"FB_FEED_VIDEO_SHARE",FbGamingCustomUpdate:"FB_GAMING_CUSTOM_UPDATE",FbProducerStoryReply:"FB_PRODUCER_STORY_REPLY",FbEvent:"FB_EVENT",FbFeedPostPrivateReply:"FB_FEED_POST_PRIVATE_REPLY",FbShort:"FB_SHORT",FbCommentMentionShare:"FB_COMMENT_MENTION_SHARE",FbPostMention:"FB_POST_MENTION",FbFeedPostReactionReply:"FB_FEED_POST_REACTION_REPLY",MsgExternalLinkShare:"MSG_EXTERNAL_LINK_SHARE",MsgP2PPayment:"MSG_P2P_PAYMENT",MsgOpgP2PPayment:"MSG_OPG_P2P_PAYMENT",MsgLocationSharingDeprecated:"MSG_LOCATION_SHARING_DEPRECATED",MsgLocationSharingV2:"MSG_LOCATION_SHARING_V2",MsgReceiverFetch:"MSG_RECEIVER_FETCH",MsgIgMediaShare:"MSG_IG_MEDIA_SHARE",MsgGenAiSearchPluginResponse:"MSG_GEN_AI_SEARCH_PLUGIN_RESPONSE",MsgReelsList:"MSG_REELS_LIST",MsgContact:"MSG_CONTACT",MsgFile:"MSG_FILE",MsgAiContact:"MSG_AI_CONTACT",MsgMemoriesShare:"MSG_MEMORIES_SHARE",MsgEarlyAccessFbShare:"MSG_EARLY_ACCESS_FB_SHARE",MsgSharedAlbum:"MSG_SHARED_ALBUM",MsgPhoneNumber:"MSG_PHONE_NUMBER",MsgPrivateXma:"MSG_PRIVATE_XMA",MsgMusicSticker:"MSG_MUSIC_STICKER",MsgReceiverFetchFallback:"MSG_RECEIVER_FETCH_FALLBACK",MsgAiBotSearchResult:"MSG_AI_BOT_SEARCH_RESULT",MsgGenAiSubscription:"MSG_GEN_AI_SUBSCRIPTION",MsgGenAiReminder:"MSG_GEN_AI_REMINDER",MsgGenAiTask:"MSG_GEN_AI_TASK",MsgGenAi_1PSearchResult:"MSG_GEN_AI_1P_SEARCH_RESULT",MsgGenAiMemuOnboardingResponse:"MSG_GEN_AI_MEMU_ONBOARDING_RESPONSE",MsgGenAiRichResponse:"MSG_GEN_AI_RICH_RESPONSE",RtcAudioCall:"RTC_AUDIO_CALL",RtcVideoCall:"RTC_VIDEO_CALL",RtcMissedAudioCall:"RTC_MISSED_AUDIO_CALL",RtcMissedVideoCall:"RTC_MISSED_VIDEO_CALL",RtcGroupAudioCall:"RTC_GROUP_AUDIO_CALL",RtcGroupVideoCall:"RTC_GROUP_VIDEO_CALL",RtcMissedGroupAudioCall:"RTC_MISSED_GROUP_AUDIO_CALL",RtcMissedGroupVideoCall:"RTC_MISSED_GROUP_VIDEO_CALL",RtcOngoingVideoCall:"RTC_ONGOING_VIDEO_CALL",RtcOngoingAudioCall:"RTC_ONGOING_AUDIO_CALL",LiveLocation:"LIVE_LOCATION",OcAvatarStaticSticker:"OC_AVATAR_STATIC_STICKER"}),je=e({None:"NONE",Fb:"FB",FbAlwaysWhite:"FB_ALWAYS_WHITE",DotsThreeHorizontal:"DOTS_THREE_HORIZONTAL",ChevronDown:"CHEVRON_DOWN",FbInfoSmall:"FB_INFO_SMALL"}),Ke=e({Default:"DEFAULT",P2PPreviewImageWithTextOverlay:"P2P_PREVIEW_IMAGE_WITH_TEXT_OVERLAY",Playable:"PLAYABLE",AutoPlayable:"AUTO_PLAYABLE",BlurredImage:"BLURRED_IMAGE",BlurredPlayable:"BLURRED_PLAYABLE",InformTreatmentWithLabel:"INFORM_TREATMENT_WITH_LABEL",InformTreatmentWithWarningScreen:"INFORM_TREATMENT_WITH_WARNING_SCREEN",YoutubePlayer:"YOUTUBE_PLAYER",ImageWithPlayButton:"IMAGE_WITH_PLAY_BUTTON",Placeholder:"PLACEHOLDER",AutoPlayableWithAspectRatio:"AUTO_PLAYABLE_WITH_ASPECT_RATIO"}),Qe=e({OnTime:"ON_TIME",Delayed:"DELAYED",Cancelled:"CANCELLED",Arrived:"ARRIVED",Departed:"DEPARTED",Unknown:"UNKNOWN"}),Xe=e({MediaLabel:"MEDIA_LABEL",Misinformation:"MISINFORMATION",PostCover:"POST_COVER",PostLabel:"POST_LABEL",Private:"PRIVATE",Sensitive:"SENSITIVE",WarningScreens:"WARNING_SCREENS"}),Ye=e({None:"NONE",Collage:"COLLAGE",Photo:"PHOTO",Video:"VIDEO",MultiPhoto:"MULTI_PHOTO",MessengerIcon:"MESSENGER_ICON",InstagramIcon:"INSTAGRAM_ICON",ReelsIcon:"REELS_ICON",Live:"LIVE",YoutubeVideo:"YOUTUBE_VIDEO",YoutubeShorts:"YOUTUBE_SHORTS",Blur:"BLUR",Pill:"PILL"}),Je=e({Grid:"GRID",Hscroll:"HSCROLL",Portrait:"PORTRAIT",Single:"SINGLE",Vstack:"VSTACK",SharedStack:"SHARED_STACK"}),Ze=e({Started:"STARTED",Ended:"ENDED",Active:"ACTIVE",Expired:"EXPIRED"}),et=e({Default:"DEFAULT",Rounded:"ROUNDED",BlurredCircle:"BLURRED_CIRCLE",TemplateAsset:"TEMPLATE_ASSET",DefaultWithGradient:"DEFAULT_WITH_GRADIENT"}),tt=e({Paypal:"PAYPAL",Venmo:"VENMO"}),nt=e({Payment:"PAYMENT",Request:"REQUEST"}),rt=e({None:"NONE",VodVideo:"VOD_VIDEO",LiveVideo:"LIVE_VIDEO",ShortsVideo:"SHORTS_VIDEO"}),ot=e({Missed:"MISSED",Ended:"ENDED",Started:"STARTED"}),at=e({Video:"VIDEO",Audio:"AUDIO"}),it=e({Default:"DEFAULT",Overlay:"OVERLAY"}),lt=e({Regular:"REGULAR",Bold:"BOLD"}),st=e({Weekly:"WEEKLY",Daily:"DAILY"}),ut=e({Default:"DEFAULT",ThreadsIcon:"THREADS_ICON",FacebookIcon:"FACEBOOK_ICON",ExternalLinkIcon:"EXTERNAL_LINK_ICON",MessengerIcon:"MESSENGER_ICON",InstagramIcon:"INSTAGRAM_ICON",OculusIcon:"OCULUS_ICON",MetaAiIcon:"META_AI_ICON",MetaHorizonIcon:"META_HORIZON_ICON"}),ct=e({Left:"LEFT",Center:"CENTER"}),dt=e({Default:"DEFAULT"}),mt=e({None:"NONE",YoutubeVideo:"YOUTUBE_VIDEO",YoutubeShorts:"YOUTUBE_SHORTS"});i.AiBotEmbodimentTrigger=l,i.ClientInstructionType=s,i.GenAiAddonActionAlignment=u,i.GenAiAddonActionType=c,i.GenAiCodeBlockType=d,i.GenAiCompactEntityActionType=m,i.GenAiCompactEntityType=p,i.GenAiDividerType=_,i.GenAiFooterActionType=f,i.GenAiImageAssetQueryStatus=g,i.GenAiImaginePrimitiveStatus=h,i.GenAiImagineType=y,i.GenAiMapQueryStatus=C,i.GenAiMediaHorizontalAlignment=b,i.GenAiMediaShape=v,i.GenAiMediaVerticalAlignment=S,i.GenAiMultipleResponseLayoutType=R,i.GenAiOrchestratorSearchEngine=L,i.GenAiPostOrientation=E,i.GenAiPostType=k,i.GenAiSearchPlannerStepStatus=I,i.GenAiSourceApp=T,i.GenAiSourcedItemType=D,i.GenAiThreadSurfingActionType=x,i.GenAiThreadSurfingEntityType=$,i.GenAiUnifiedResponseSectionType=P,i.GenAiContextInjectionType=N,i.GenAiPromptType=M,i.MebSplitDatabaseExecutionType=w,i.MpsBackupContentType=A,i.MpsBackupOperation=F,i.MpsMessageBackupSource=O,i.MpsMessageRangeQueryDirection=B,i.MpsMessageTag=W,i.MpsQueryCaller=q,i.MpsServerAttachmentUploadStatus=U,i.MpsServerMessageUploadStatus=V,i.MpsUploadType=H,i.XmsgaiBotResponseImagineSource=G,i.XmsgaiInvocationOptions=z,i.XmsgaiLookupActionType=j,i.XmsgaiLookupEntityType=K,i.XmsgaiProduct=Q,i.XmsgctaType=X,i.XmsgContentBrandingOption=Y,i.Xmsge2EeGenAiEncryptedImageProductType=J,i.Xmsge2EeGenAiEncryptedVideoProductType=Z,i.XmsgFeatureTags=ee,i.XmsgGenAiBotResponseProductType=te,i.XmsgGenAiBotSubscriptionProductType=ne,i.XmsgGenAiMessageType=re,i.XmsgHighlightsTabMoment=oe,i.XmsgHighlightsTabReplySourceType=ae,i.XmsgIgReceiverFetchContentType=ie,i.XmsgIgReceiverFetchXmaMediaNoteFetchParamsMessageType=le,i.XmsgIgXmaActionType=se,i.XmsgImageGlyphType=ue,i.XmsgInlineEntityType=ce,i.XmsgMarketplaceLightweightReplyType=de,i.XmsgMarketplaceSmartRepliesTriggerType=me,i.XmsgMediaDispatchKey=pe,i.XmsgMemoriesE2EeSendTemplateType=_e,i.XmsgMemoriesTemplateType=fe,i.XmsgMessageRequestStatus=ge,i.XmsgMessageSendProductType=he,i.XmsgMessageStreamingProductType=ye,i.XmsgMsgrReceiverFetchContentType=Ce,i.XmsgMsgrReceiverFetchXmaLayoutType=be,i.XmsgMsgrXmaActionType=ve,i.XmsgMustacheCtaType=Se,i.XmsgNoteMessageType=Re,i.XmsgNoteModelType=Le,i.XmsgOculusMediaType=Ee,i.XmsgPowerUpStyle=ke,i.XmsgReactionStyle=Ie,i.XmsgReportedMessageType=Te,i.XmsgSpectraActionSource=De,i.XmsgSpectraActionType=xe,i.XmsgSpectraTakeDownActionType=$e,i.XmsgStoryOverlayPollStyle=Pe,i.XmsgStoryOverlayTagType=Ne,i.XmsgStoryReplyType=Me,i.XmsgStreamStatusType=we,i.XmsgSuggestedModerationActionType=Ae,i.XmsgTestEnum=Fe,i.XmsgTestMinimalEnum=Oe,i.XmsgTranscriptionStatus=Be,i.XmsgXmaBizAiUnifiedResponseAttributionType=We,i.XmsgXmaBizAiUnifiedResponseSourceAttributionType=qe,i.XmsgXmaCodeBlockType=Ue,i.XmsgXmaCompactGenericTemplateAccessoryType=Ve,i.XmsgXmaCompactGenericTemplatePreviewStyle=He,i.XmsgXmaContentAttributionIcon=Ge,i.XmsgXmaContentType=ze,i.XmsgXmaCtaIconType=je,i.XmsgXmaCustomPreviewType=Ke,i.XmsgXmaFlightStatusEnum=Qe,i.XmsgXmaGatingType=Xe,i.XmsgXmaImageDecorationType=Ye,i.XmsgXmaLayoutType=Je,i.XmsgXmaLiveLocationSessionState=Ze,i.XmsgXmaMessagingAttachmentFaviconStyle=et,i.XmsgXmaOpgP2pPaymentMethodType=tt,i.XmsgXmaOpgP2pTransactionType=nt,i.XmsgXmaOverlayContentType=rt,i.XmsgXmaRtcCallState=ot,i.XmsgXmaRtcCallType=at,i.XmsgXmaStandardGenericBodyLayoutType=it,i.XmsgXmaStandardGenericBodyTitleStyle=lt,i.XmsgXmaSubscriptionRecurrenceType=st,i.XmsgXmaSubtitleDecorationType=ut,i.XmsgXmaVStackLayoutHeaderAlignmentType=ct,i.XmsgXmaVerifiedType=dt,i.XmsgXmaYoutubePreviewMediaType=mt}),66);
__d("WAFrankingTypes",[],(function(t,n,r,o,a,i){"use strict";function e(e){return e}function l(e){return e}function s(e){return e}i.castToFrankingTag=e,i.castToFrankingKey=l,i.castToReportingTag=s}),66);
__d("EBMinosProcessMessages",["Base64Utils","EBMinosLogger","EBMinosMessageEncryptionVersion","EBMinosMessageMetadataVersion","EBMinosTypes","MSGDataclassTypes.flow","MpsTypes","WAFrankingTypes","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C;function b(t){var n=t!=null?t:{},r=n.actor_token,a=n.encrypted_protobuf,i=n.franking_tag,l=n.mek_fbid,c=n.mek_id,d=n.message_encryption_version,m=n.message_metadata_version,p=n.protobuf_timestamp,_=n.reporting_tag,f=n.transport_sender_message_signature,g=n.transport_sender_signing_pk;if(d==null&&o("EBMinosLogger").minosLogger.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["missing message_encryption_version on restore"]))),r==null||a==null||d==null||m==null||l==null||c==null||p==null||f==null||g==null)return o("WAResultOrError").makeError("top-level-missing-fields");var h=o("EBMinosMessageEncryptionVersion").MinosMessageEncryptionVersion.cast(d);if(h==null)return o("EBMinosLogger").minosLogger.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Failed to cast message encryption version: ",""])),d),o("WAResultOrError").makeError("invalid-message-encryption-version");var y=o("EBMinosMessageMetadataVersion").MinosMessageMetadataVersion.cast(m);return y==null?(o("EBMinosLogger").minosLogger.ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Failed to cast message metadata version: ",""])),m),o("WAResultOrError").makeError("invalid-message-metadata-version")):o("WAResultOrError").makeResult({actorToken:o("EBMinosTypes").unsafeCastToUserFbId(r),encryptedProtobuf:o("EBMinosTypes").unsafeCastToEncryptedMessage(o("Base64Utils").toArrayBuffer(a)),frankingTag:i!=null?o("WAFrankingTypes").castToFrankingTag(new Uint8Array(o("Base64Utils").toArrayBuffer(i))):null,mekFbid:o("EBMinosTypes").unsafeCastToMekFbId(l),mekId:o("EBMinosTypes").unsafeCastToMekId(o("Base64Utils").toArrayBuffer(c)),messageEncryptionVersion:h,messageMetadataVersion:y,protobufTimestamp:o("MpsTypes").toTimestamp(parseInt(p,10)),reportingTag:_!=null?o("WAFrankingTypes").castToReportingTag(new Uint8Array(o("Base64Utils").toArrayBuffer(_))):null,transportSenderMessageSignature:o("EBMinosTypes").unsafeCastToEncryptedMessageSignature(o("Base64Utils").toArrayBuffer(f)),transportSenderSigningPk:o("EBMinosTypes").unsafeCastToTransportSigningPK(o("Base64Utils").toArrayBuffer(g))})}function v(e){return e==="PHOTO"?o("MSGDataclassTypes.flow").MpsMessageTag.Photo:e==="PERMANENT"?o("MSGDataclassTypes.flow").MpsMessageTag.Permanent:e==="EPHEMERAL"?o("MSGDataclassTypes.flow").MpsMessageTag.Ephemeral:e==="VIDEO"?o("MSGDataclassTypes.flow").MpsMessageTag.Video:e==="GIF"?o("MSGDataclassTypes.flow").MpsMessageTag.Gif:e==="AUDIO"?o("MSGDataclassTypes.flow").MpsMessageTag.Audio:e==="FILE"?o("MSGDataclassTypes.flow").MpsMessageTag.File:e==="RAVEN"?o("MSGDataclassTypes.flow").MpsMessageTag.Raven:e==="UNREAD_RAVEN"?o("MSGDataclassTypes.flow").MpsMessageTag.UnreadRaven:e==="SHARE_IG_MEDIA"?o("MSGDataclassTypes.flow").MpsMessageTag.ShareIgMedia:e==="SHARE_LINK"?o("MSGDataclassTypes.flow").MpsMessageTag.ShareLink:e==="SHARE_IG_CLIPS"?o("MSGDataclassTypes.flow").MpsMessageTag.ShareIgClips:e==="SHH"?o("MSGDataclassTypes.flow").MpsMessageTag.Shh:e==="STORY_REPLY"?o("MSGDataclassTypes.flow").MpsMessageTag.StoryReply:e==="DISAPPEARING_MESSAGE"?o("MSGDataclassTypes.flow").MpsMessageTag.DisappearingMessage:e==="RAVEN_SEEN"?o("MSGDataclassTypes.flow").MpsMessageTag.RavenSeen:e==="RAVEN_REPLAYED"?o("MSGDataclassTypes.flow").MpsMessageTag.RavenReplayed:e==="RAVEN_READ_ONCE"?o("MSGDataclassTypes.flow").MpsMessageTag.RavenReadOnce:e==="RAVEN_REPLAYABLE"?o("MSGDataclassTypes.flow").MpsMessageTag.RavenReplayable:e==="RAVEN_PERMANENT"?o("MSGDataclassTypes.flow").MpsMessageTag.RavenPermanent:e==="ACTION_LOG"?o("MSGDataclassTypes.flow").MpsMessageTag.ActionLog:null}function S(e){if(e==null)return[];var t=[];for(var n of e){var r=v(n);r==null?o("EBMinosLogger").minosLogger.ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["processMinosMessages: protobuf_stanzas is null"]))):t.push(r)}return t}function R(e){var t=e!=null?e:{},n=t.actor_token,r=t.encrypted_protobuf,a=t.franking_tag,i=t.mek_fbid,l=t.mek_id,s=t.message_encryption_version,u=t.message_metadata_version,c=t.protobuf_timestamp,_=t.reporting_tag,f=t.supplemental_key,g=t.supplemental_otid,h=t.transport_sender_message_signature,y=t.transport_sender_signing_pk;if(s==null&&o("EBMinosLogger").minosLogger.ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["missing message_encryption_version on restore"]))),n==null||r==null||s==null||u==null||i==null||l==null||c==null||h==null||y==null||f==null||g==null)return null;var C=o("EBMinosMessageEncryptionVersion").MinosMessageEncryptionVersion.cast(s);if(C==null)return o("EBMinosLogger").minosLogger.ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Failed to cast message encryption version: ",""])),s),null;var b=o("EBMinosMessageMetadataVersion").MinosMessageMetadataVersion.cast(u);return b==null?(o("EBMinosLogger").minosLogger.ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Failed to cast message metadata version: ",""])),u),null):{actorToken:o("EBMinosTypes").unsafeCastToUserFbId(n),encryptedProtobuf:o("EBMinosTypes").unsafeCastToEncryptedMessage(o("Base64Utils").toArrayBuffer(r)),frankingTag:a!=null?o("WAFrankingTypes").castToFrankingTag(new Uint8Array(o("Base64Utils").toArrayBuffer(a))):null,mekFbid:o("EBMinosTypes").unsafeCastToMekFbId(i),mekId:o("EBMinosTypes").unsafeCastToMekId(o("Base64Utils").toArrayBuffer(l)),messageEncryptionVersion:C,messageMetadataVersion:b,protobufTimestamp:o("MpsTypes").toTimestamp(parseInt(c,10)),reportingTag:_!=null?o("WAFrankingTypes").castToReportingTag(new Uint8Array(o("Base64Utils").toArrayBuffer(_))):null,supplementalKey:o("MpsTypes").toSupplementalKey(f),supplementalOtid:o("MpsTypes").toMessageId(g),transportSenderMessageSignature:o("EBMinosTypes").unsafeCastToEncryptedMessageSignature(o("Base64Utils").toArrayBuffer(h)),transportSenderSigningPk:o("EBMinosTypes").unsafeCastToTransportSigningPK(o("Base64Utils").toArrayBuffer(y))}}function L(e){return e==null?[]:e.map(function(e){var t=e.echo_document,n=e.otid,r=e.protobuf_stanzas;if(n==null)return o("EBMinosLogger").minosLogger.ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["processMinosMessages: otid is null"]))),null;if(r==null)return t==null&&o("EBMinosLogger").minosLogger.ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["processMinosMessages: protobuf_stanzas and echo_documents are null"]))),null;var a=r.message_tags,i=r.supplemental_protobufs_v2,l=i===void 0?[]:i,s=r.top_level_protobuf_v2;if(s==null)return null;var u=b(s);if(!u.success)return o("EBMinosLogger").minosLogger.ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["processMinosMessages: top_level_protobuf_v2 conversion failed"]))),null;var c=l.map(function(e){var t=e==null?void 0:e.supplemental_key,n=R(e);if(t==null){o("EBMinosLogger").minosLogger.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["processMinosMessages: minos supplementalKey is null"])));return}if(n==null){o("EBMinosLogger").minosLogger.LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["processMinosMessages: minosSupplementalProtobuf is null"])));return}return n}).filter(Boolean),d=o("MpsTypes").toMessageId(n);return{messageTags:S(a),otid:d,supplementalProtobufsV2:c,topLevelProtobufV2:u.value}}).filter(Boolean)}function E(e,t,n){return t===o("EBMinosMessageMetadataVersion").MinosMessageMetadataVersion.V1?e:isNaN(n)?(o("EBMinosLogger").minosLogger.ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["createMessageTimestamp: otid is not a number"]))),o("MpsTypes").toTimestamp(0)):k(n)}function k(e){return o("MpsTypes").toTimestamp(Number(BigInt(e)>>BigInt(22)))}l.convertArrayToMpsMessageTags=S,l.processMinosMessages=L,l.createMessageTimestamp=E,l.extractTimestampFromOtid=k}),98);
__d("EBMinosInterfaceTypes",["EBMinosProcessMessages","EBMinosTypes"],(function(t,n,r,o,a,i,l){"use strict";var e;l.unsafeCastToBase64StringIntToEpochNumber=(e=o("EBMinosTypes")).unsafeCastToBase64StringIntToEpochNumber,l.unsafeCastToEpochHead=e.unsafeCastToEpochHead,l.unsafeCastToEpochSelfSig=e.unsafeCastToEpochSelfSig,l.unsafeCastToMailboxAuthPK=e.unsafeCastToMailboxAuthPK,l.unsafeCastToMailboxEncryptionPK=e.unsafeCastToMailboxEncryptionPK,l.processMinosMessages=o("EBMinosProcessMessages").processMinosMessages,l.unsafeCastToMekMiThreadId=e.unsafeCastToMekMiThreadId,l.unsafeCastToMailboxSigningPK=e.unsafeCastToMailboxSigningPK,l.convertArrayToMpsMessageTags=o("EBMinosProcessMessages").convertArrayToMpsMessageTags,l.unsafeCastToUserFbId=e.unsafeCastToUserFbId,l.unsafeCastToMailboxFbId=e.unsafeCastToMailboxFbId,l.unsafeCastToEpochCreationTime=e.unsafeCastToEpochCreationTime,l.unsafeCastToDecryptedMessage=e.unsafeCastToDecryptedMessage}),98);
__d("EBMinosQplFlow",["QPLUserFlow","Random","gkx","justknobx","qpl"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.threadId;return u({annotations:{string:{threadId:t}},event:r("qpl")._(521473369,"2834")})}function s(e){var t=e.threadId;return u({annotations:{string:{threadId:t}},event:r("qpl")._(521485893,"2835")})}function u(e){var t=e.annotations,n=e.event,a=o("Random").uint32();return r("QPLUserFlow").start(n,{annotations:babelHelpers.extends({},t,{bool:babelHelpers.extends({},t==null?void 0:t.bool,{minos_rollout_enabled:r("gkx")("20911"),occam_only_mailbox_users:r("gkx")("16674"),use_minos_thread_id:!0}),int:babelHelpers.extends({},t==null?void 0:t.int,{instanceKey:a,retryCount:0})}),instanceKey:a,timeoutInMs:r("justknobx")._("1405")}),p(n,a)}function c(){return u({event:r("qpl")._(521473150,"2143")})}function d(e){var t=e.entryPoint;return u({annotations:{string:{entryPoint:t}},event:r("qpl")._(521482880,"16")})}function m(){return u({event:r("qpl")._(521479165,"3055")})}function p(e,t){return{addAnnotations:function(o){r("QPLUserFlow").addAnnotations(e,o,{instanceKey:t})},addPoint:function(o,a){a&&r("QPLUserFlow").addAnnotations(e,a,{instanceKey:t}),r("QPLUserFlow").addPoint(e,o,{instanceKey:t})},endFailWithError:function(o,a,i){var n=babelHelpers.extends({},i,{string:babelHelpers.extends({},i==null?void 0:i.string,{failReason:a})});r("QPLUserFlow").endFailure(e,o,{annotations:n,instanceKey:t})},endSuccess:function(o){r("QPLUserFlow").endSuccess(e,{annotations:o,instanceKey:t})},getInstanceKey:function(){return t}}}l.startMinosMessageEnqueueQpl=e,l.startMinosMessageUploadQpl=s,l.startMinosWritePublicKeysQpl=c,l.startMinosVerifySingleEpochQpl=d,l.startMinosCreateEpochParamsQpl=m}),98);
__d("EncryptedBackupsSymmetricEncryptionUtils",[],(function(t,n,r,o,a,i){"use strict";var e=16,l=28,s=16,u=128;i.hChaCha20SubKeyNonceLengthInBytes=e,i.totalNonceLengthInBytes=l,i.aesGcmTagLengthInBytes=s,i.aesGcmTagLength=u}),66);
__d("FuncChannel",["FBLogger","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(){function t(t){var o=this,a;this.$2=[],this.callMessageHandler=function(t){return new(e||(e=n("Promise")))(function(e,n){t.result={resolveFunc:e,rejectFunc:n},o.$2.push(t)})},this.messageToCall=function(e){var t,n,a=o.proxyMethods[e.method];if(typeof a!="function"){r("FBLogger")("worker").mustfix("proxyMethods[%s] is not a functions",e.method);return}var i=(t=e.result)==null?void 0:t.resolveFunc,l=(n=e.result)==null?void 0:n.rejectFunc;if(typeof i=="function"&&typeof l=="function")try{var s=a.apply(e.thisArg,e.argList);i(s)}catch(e){l(e)}else return a.apply(e.thisArg,e.argList)};var i=this,l={},s=(a=t==null?void 0:t(l))!=null?a:{},u=babelHelpers.extends({},l);function c(e){u[e]=function(){var t={type:"call",method:e,thisArg:null,argList:Array.from(arguments)};return i.callMessageHandler(t)},l[e]=function(){var t=i.$1[e];if(typeof t!="function"){r("FBLogger")("worker").mustfix("_backend[%s] is not a functions",e);return}return t.apply(i.$1,arguments)},s[e]==null&&(s[e]=l[e])}if(this.$1=u,t!=null){var d=Object.keys(s);d.forEach(c),this.proxyMethods=s}else this.proxyMethods=new Proxy(s,{get:function(t,n){var e=n;return s[e]==null&&c(e),s[e]}})}var o=t.prototype;return o.flushBuffer=function(){var e=this.$2;this.$2=[],e.forEach(this.messageToCall)},o.setBackend=function(t){return this.$1!==t&&(this.$1=t,this.flushBuffer()),this},o.setCallMessageHandler=function(t){this.callMessageHandler=t,this.flushBuffer()},t})();l.default=s}),98);
__d("HChaCha20",["err"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){}e.fromHexString=function(t){var e=t.match(/[A-Fa-f0-9]{1,2}/g);if(t.length===0||t.length%2!==0||e==null)throw r("err")('The string "'+t+'" is not valid hex.');return new Uint8Array(e.map(function(e){return parseInt(e,16)}))},e.bufferToUint32Array=function(t){for(var e=new DataView(t),n=[],r=t.byteLength/4,o=0;o<r;o++)n.push(new DataView(e.buffer.slice(o*4,o*4+4)).getInt32(0));return Uint32Array.from(n)},e.rotate=function(t,n){var e=t&4294967295,r=n&31;return(e<<r|e>>>32-r)>>>0},e.quarterRound=function(n,r,o,a){var t=n,i=r,l=o,s=a;return t=t+i&4294967295,s=e.rotate(s^t,16),l=l+s&4294967295,i=e.rotate(i^l,12),t=t+i&4294967295,s=e.rotate(s^t,8),l=l+s&4294967295,i=e.rotate(i^l,7),[t>>>0,i>>>0,l>>>0,s>>>0]};var t=e.prototype;return t.createHCtx=function(n,o){var t=new Uint32Array(16),a=e.fromHexString("657870616e642033322d62797465206b");if(a.byteLength!==16)throw r("err")("Could not create context. Invalid constant buffer length of "+a.byteLength+". Expected a length of 16");if(n.byteLength!==32)throw r("err")("Could not create context. Invalid key buffer length of "+n.byteLength+". Expected a length of 32");if(o.byteLength!==16)throw r("err")("Could not create context. Invalid nonce buffer length of "+o.byteLength+". Expected a length of 16");var i=e.bufferToUint32Array(a.buffer),l=e.bufferToUint32Array(n),s=e.bufferToUint32Array(o);return t.set(i),t.set(l,i.length),t.set(s,i.length+l.length),t.buffer},t.hChaCha20Bytes=function(n,r){for(var t=new DataView(this.createHCtx(r,n)),o=t.getInt32(0),a=t.getInt32(4),i=t.getInt32(8),l=t.getInt32(12),s=t.getInt32(16),u=t.getInt32(20),c=t.getInt32(24),d=t.getInt32(28),m=t.getInt32(32),p=t.getInt32(36),_=t.getInt32(40),f=t.getInt32(44),g=t.getInt32(48),h=t.getInt32(52),y=t.getInt32(56),C=t.getInt32(60),b=0;b<10;b++){var v=e.quarterRound(o,s,m,g);o=v[0],s=v[1],m=v[2],g=v[3];var S=e.quarterRound(a,u,p,h);a=S[0],u=S[1],p=S[2],h=S[3];var R=e.quarterRound(i,c,_,y);i=R[0],c=R[1],_=R[2],y=R[3];var L=e.quarterRound(l,d,f,C);l=L[0],d=L[1],f=L[2],C=L[3];var E=e.quarterRound(o,u,_,C);o=E[0],u=E[1],_=E[2],C=E[3];var k=e.quarterRound(a,c,f,g);a=k[0],c=k[1],f=k[2],g=k[3];var I=e.quarterRound(i,d,m,h);i=I[0],d=I[1],m=I[2],h=I[3];var T=e.quarterRound(l,s,p,y);l=T[0],s=T[1],p=T[2],y=T[3]}return Uint32Array.from([o,a,i,l,g,h,y,C]).buffer},e})();l.HChaCha20=e}),98);
__d("IGDInteractionTraceAnnotations",["I64","IGDInstamadilloUtils","IGDRouteProvider.react","IGDThreadTTLCUtils","Int64Hooks","InteractionTracing","LSIntEnum","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=(e||(e=o("react"))).useEffect;function d(e){return babelHelpers.extends({},o("IGDThreadTTLCUtils").getTTLCBooleanAnnotations(e),{is_dm:o("IGDInstamadilloUtils").isIGDDisappearingModeEnabled(e),is_instamadillo:o("IGDInstamadilloUtils").isInstamadilloTransportEnabled(e),is_instamadillo_tlc:o("IGDInstamadilloUtils").isInstamadilloCutover(e)})}function m(e,t){var n,r=o("IGDInstamadilloUtils").isInstamadilloCutover(e),a=o("IGDInstamadilloUtils").isInstamadilloTransportEnabled(e),i=o("IGDInstamadilloUtils").isIGDDisappearingModeEnabled(e);t.addAnnotationBoolean("is_instamadillo",a),t.addAnnotationBoolean("is_instamadillo_tlc",r),t.addAnnotationBoolean("is_dm",i),t.addAnnotationBoolean("is_instamadillo_ttlc",(n=o("IGDThreadTTLCUtils")).isIGDTTLCEnabledForThread(e)),t.addAnnotationBoolean("is_instamadillo_ttlc_audio",n.isInstamadilloTTLCAudioEnabled(e)),t.addAnnotationBoolean("is_instamadillo_ttlc_clip",n.isInstamadilloTTLCClipEnabled(e)),t.addAnnotationBoolean("is_instamadillo_ttlc_generic_xma",n.isInstamadilloTTLCGenericXmaEnabled(e)),t.addAnnotationBoolean("is_instamadillo_ttlc_image",n.isInstamadilloTTLCImageEnabled(e)),t.addAnnotationBoolean("is_instamadillo_ttlc_link",n.isInstamadilloTTLCLinkEnabled(e)),t.addAnnotationBoolean("is_instamadillo_ttlc_media_share",n.isInstamadilloTTLCMediaShareEnabled(e)),t.addAnnotationBoolean("is_instamadillo_ttlc_profile",n.isInstamadilloTTLCProfileEnabled(e)),t.addAnnotationBoolean("is_instamadillo_ttlc_reel_share",n.isInstamadilloTTLCReelShareEnabled(e)),t.addAnnotationBoolean("is_instamadillo_ttlc_story_share",n.isInstamadilloTTLCStoryShareEnabled(e)),t.addAnnotationBoolean("is_instamadillo_ttlc_text",n.isInstamadilloTTLCTextEnabled(e)),t.addAnnotationBoolean("is_instamadillo_ttlc_video",n.isInstamadilloTTLCVideoEnabled(e))}function p(e){var t=o("react-compiler-runtime").c(3),n,a;t[0]!==e?(n=function(){r("InteractionTracing").getPendingInteractions().forEach(function(t){m(e,t)})},a=[e],t[0]=e,t[1]=n,t[2]=a):(n=t[1],a=t[2]),o("Int64Hooks").useEffectInt64(n,a)}var _=new Set;function f(e){var t=o("react-compiler-runtime").c(7),n;t[0]!==e.consistentThreadFbid||t[1]!==e.threadKey||t[2]!==e.threadSubtype||t[3]!==e.threadType?(n=function(){var t=(s||(s=o("I64"))).to_string(e.threadKey);return r("InteractionTracing").getPendingInteractions().forEach(function(n){var r=_.has(t);n.addAnnotationBoolean("is_thread_visited",r),n.addAnnotation("thread_key",(s||(s=o("I64"))).to_string(e.threadKey)),e.consistentThreadFbid!=null&&n.addAnnotation("consistent_thread_fbid",(s||(s=o("I64"))).to_string(e.consistentThreadFbid)),n.addAnnotationInt("thread_type",(u||(u=o("LSIntEnum"))).toNumber(e.threadType)),e.threadSubtype!=null&&n.addAnnotation("thread_subtype",(s||(s=o("I64"))).to_string(e.threadSubtype))}),(function(){_.add(t)})},t[0]=e.consistentThreadFbid,t[1]=e.threadKey,t[2]=e.threadSubtype,t[3]=e.threadType,t[4]=n):n=t[4];var a;t[5]!==e?(a=[e],t[5]=e,t[6]=a):a=t[6],o("Int64Hooks").useEffectInt64(n,a)}function g(){var e=o("react-compiler-runtime").c(3),t=o("IGDRouteProvider.react").useThreadKeyFromCurrentRoute(),n,a;e[0]!==t?(n=function(){r("InteractionTracing").getPendingInteractions().forEach(function(e){if(t==null){e.addAnnotationInt("rendered_direct_null_state",1),e.addAnnotationInt("has_thread_key",0);return}e.addAnnotationInt("has_thread_key",1),e.addAnnotationInt("rendered_direct_null_state",0)})},a=[t],e[0]=t,e[1]=n,e[2]=a):(n=e[1],a=e[2]),c(n,a)}l.getInstamadilloBooleanAnnotations=d,l.addInstamadilloAnnotationsToInteractionTrace=m,l.useAddInstamadilloAnnotationsToInteractionTraces=p,l.useAddThreadAnnotationToInteractionTraces=f,l.useAddThreadRouteAnnotations=g}),98);
__d("LSAppendDataTraceAddonStoredProcedure",["LSAppendDataTraceAddon","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSAppendDataTraceAddon"),a.dataTraceId,a.checkPointId,a.syncChannel,a.errorMessage,a.tags);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSBase64Decode",["Base64Utils","CryptoLogger","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.replace(/-/g,"+").replace(/_/g,"/").replace(/\./g,"=").replace("/,/","="),n=4-t.length%4;if(n<4)for(var r=0;r<n;r++)t+="=";return t}function s(t){var n=o("CryptoLogger").CryptoLogger("base64decode");try{return t!=null?o("Base64Utils").toArrayBuffer(e(t)):void 0}catch(e){var a=r("getErrorSafe")(e);if(a.message==null)return;n.catching(a).mustfix(a.message)}}l.decode=s}),98);
__d("LSBase64Decode.nop",["LSBase64Decode","LSResult","LSSynchronousPromise"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t,n,a){return o("LSSynchronousPromise").makeSynchronousPromise(r("LSResult")(o("LSBase64Decode").decode(a)))};e.__nop_name__="LSBase64Decode",l.default=e}),98);
__d("LSBase64Encode.nop",["EBBase64Encode","LSResult","LSSynchronousPromise"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t,n,a){return o("LSSynchronousPromise").makeSynchronousPromise(r("LSResult")(a?r("EBBase64Encode")(a):void 0))};e.__nop_name__="LSBase64Encode",l.default=e}),98);
__d("LSCreateDerivedKeys.nop",["CreateDerivedKeys","LSVec"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t,n,a,i,l,s){return o("CreateDerivedKeys").CreateDerivedKeys(a,i,l,r("LSVec").toArray(s))};e.__nop_name__="LSCreateDerivedKeys",l.default=e}),98);
__d("LSIsMobileClient",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return r[0]=!1,t.resolve(r)}e.__sproc_name__="LSEncryptedBackupsIsMobileClientStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSLogMEBUploadSuccessEvent.nop",["Promise","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("requireDeferred")("EncryptedBackupUploadFailureFalcoEvent").__setRef("LSLogMEBUploadSuccessEvent.nop"),u=r("requireDeferred")("EncryptedBackupUploadSuccessFalcoEvent").__setRef("LSLogMEBUploadSuccessEvent.nop"),c=function(r,o,a,i,l){if(a!=null){var t=l?u.load():s.load();t.then(function(e){return e.log(function(){return{message_id:a,trace_id:i}})})}return(e||(e=n("Promise"))).resolve()};c.__nop_name__="LSLogMEBUploadSuccessEvent",l.default=c}),98);
__d("MebClientLogsFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("3226"),s=o("FalcoLoggerInternal").create("meb_client_logs",e),u=s;l.default=u}),98);
__d("LSLogMebClientEvent.nop",["I64","LSVec","MebClientLogsFalcoEvent","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=function(a,i,l,u,c,d){return r("MebClientLogsFalcoEvent").log(function(){return{calling_class:l,device_family_id:void 0,device_registration_id:void 0,log_level:(s||(s=o("I64"))).to_string(d),msg:u,trace_ids:r("LSVec").toArray(c)}}),(e||(e=n("Promise"))).resolve()};u.__nop_name__="LSLogMebClientEvent",l.default=u}),98);
__d("LSQplAnnotateString.nop",["EBMarkerIdToQPLEvent","Promise","QPLUserFlow","WAHashStringToNumber","nullthrows"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(a,i,l,s,u,c){try{var t,d=r("nullthrows")(o("EBMarkerIdToQPLEvent").markerIdToQPLEvent(l)),m=o("WAHashStringToNumber").hashStringToNumber(s);return r("QPLUserFlow").addAnnotations(d,{string:(t={},t[u]=c,t)},{instanceKey:m}),(e||(e=n("Promise"))).resolve()}catch(t){return(e||(e=n("Promise"))).resolve()}};s.__nop_name__="LSQplAnnotateString",l.default=s}),98);
__d("LSQplMarkPoint.nop",["EBMarkerIdToQPLEvent","Promise","QPLUserFlow","WAHashStringToNumber","nullthrows"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(a,i,l,s,u){try{var t=r("nullthrows")(o("EBMarkerIdToQPLEvent").markerIdToQPLEvent(l)),c=o("WAHashStringToNumber").hashStringToNumber(s);return r("QPLUserFlow").addPoint(t,u,{instanceKey:c}),(e||(e=n("Promise"))).resolve()}catch(t){return(e||(e=n("Promise"))).resolve()}};s.__nop_name__="LSQplMarkPoint",l.default=s}),98);
__d("LSDeleteBackupOnClient",["LSAppendDataTraceAddon","LSIsMobileClient","LSLogMEBUploadSuccessEvent.nop","LSLogMebClientEvent.nop","LSQplAnnotateString.nop","LSQplMarkPoint.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(r){return e[3]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[3],"dasm_delete_backup_on_client_sproc_start"):t.resolve()},function(r){return e[3]!==void 0&&e[4]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,1021646192]),e[3],"dasm_delete_backup_on_client_error_message",e[4]):t.resolve()},function(e){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure] Beginning execution."),t.i64.neq(void 0,void 0)?(r[9]=["deleteBackupOnClient reason: "," ",t.i64.to_string(void 0)].join(""),(function(e){t.logger(e).info(e)})(["[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure] ","",r[9]].join("")),r[10]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteBackupOnClientStoredProcedure",[r[9]].join(""),r[10],t.i64.cast([0,4]))):t.resolve()},function(e){return r[1]="Beginning deleteBackupOnClient stored procedure",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][deleteBackupOnClient] ","",r[1]].join("")),r[2]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"deleteBackupOnClient",[r[1]].join(""),r[2],t.i64.cast([0,4]))},function(n){return t.i64.neq(e[0],void 0)?t.forEach(t.db.table(168).fetch([[[e[0]]]]),function(e){return e.delete()}):t.forEach(t.db.table(168).fetch(),function(e){return e.delete()})},function(n){return t.i64.neq(e[0],void 0)?t.forEach(t.db.table(169).fetch([[[e[0]]],"fk_secure_encrypted_backups_client_state"]),function(e){return e.delete()}):t.forEach(t.db.table(169).fetch(),function(e){return e.delete()})},function(e){return t.forEach(t.db.table(174).fetch(),function(e){return e.delete()})},function(n){return e[1]==="fetch_virtual_device"?t.db.table(178).put({pk:t.i64.cast([0,1]),recoveryCodeStatus:t.i64.cast([0,4])}):t.resolve()},function(o){return e[2]?t.sequence([function(e){return r[9]="Clearing state management backups tables",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][deleteBackupOnClient] ","",r[9]].join("")),r[10]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"deleteBackupOnClient",[r[9]].join(""),r[10],t.i64.cast([0,4]))},function(e){return t.forEach(t.db.table(172).fetch([[[t.i64.cast([0,1])]]]),function(e){var t=e.update,n=e.item;return t({backupId:void 0})})},function(n){return t.i64.neq(e[0],void 0)?t.forEach(t.filter(t.db.table(184).fetch(),function(n){return t.i64.eq(n.backupId,e[0])}),function(e){return e.delete()}):t.forEach(t.db.table(184).fetch(),function(e){return e.delete()})},function(n){return t.i64.neq(e[0],void 0)?t.forEach(t.db.table(196).fetch([[[e[0]]]]),function(e){return e.delete()}):t.forEach(t.db.table(196).fetch(),function(e){return e.delete()})}]):t.resolve()},function(e){return t.sequence([function(e){return t.sequence([function(e){return t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[10]=t[0],t})},function(e){return r[10]?r[11]=!0:r[11]=!1,r[11]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[13]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[13]].join("")),r[12]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[13],r[12],t.i64.cast([0,3]))):t.resolve()}])},function(e){return t.forEach(t.db.table(177).fetch(),function(e){var r=e.item;return t.sequence([function(e){return t.forEach(t.db.table(2).fetch([[[r.pendingBackupTaskId]]]),function(e){return e.delete()})},function(e){return t.i64.eq(r.contentType,t.i64.cast([0,1]))?t.nativeOperation(n("LSLogMEBUploadSuccessEvent.nop"),r.uniqueKey,r.lsTraceId,!0):t.resolve()}])})},function(e){return t.count(t.db.table(177).fetch()).then(function(e){return r[9]=e})},function(e){return t.i64.eq(r[9],t.i64.cast([0,0]))?t.sequence([function(e){return t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[10]=t[0],t})},function(e){return r[10]?r[11]=!0:r[11]=!1,r[11]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[13]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[13]].join("")),r[12]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[13],r[12],t.i64.cast([0,3]))):t.resolve()}]):t.sequence([function(e){return t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[10]=t[0],t})},function(e){return r[10]?r[11]=!0:r[11]=!1,r[11]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[13]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[13]].join("")),r[12]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[13],r[12],t.i64.cast([0,3]))):t.resolve()}])}])},function(o){return e[2]?(r[9]="Clearing data flow backups tables",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][deleteBackupOnClient] ","",r[9]].join("")),r[10]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"deleteBackupOnClient",[r[9]].join(""),r[10],t.i64.cast([0,4]))):t.resolve()},function(o){return e[5]?t.resolve(0):e[4]!==void 0?((function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure] ","",e[4]].join("")),r[9]=t.createArray(),e[3]!==void 0&&(r[10]=(r[9].push(e[3]),r[9])),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteBackupOnClientStoredProcedure",e[4],r[9],t.i64.cast([0,3]))):t.resolve()},function(e){return r[3]=t.i64.of_float(Date.now()),r[4]=t.i64.random(),r[6]="Finishing execution. Execution time: ",r[7]=t.i64.to_string(t.i64.sub(r[3],r[0])),r[8]=" ms",r[5]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure] ",r[5],r[6],r[5],r[7],r[5],r[8]].join("")),t.i64.eq(t.i64.mod_(r[4],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[9]=",",r[10]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteBackupOnClientStoredProcedure",[r[6],r[9],r[7],r[9],r[8]].join(""),r[10],t.i64.cast([0,4]))):t.resolve()},function(r){return e[3]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[3],"dasm_delete_backup_on_client_sproc_end"):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsDeleteBackupOnClientStoredProcedure",e.__tables__=["secure_encrypted_backups_client_state","secure_encrypted_backups_epochs","secure_encrypted_backups_generated_recovery_code","secure_encrypted_backups_recovery_code_status","encrypted_backups","encrypted_backups_virtual_devices","encrypted_backups_metadata","pending_backups_context_v2","pending_tasks"],a.exports=e}),null);
__d("LSDeleteAndReenrollDeviceState",["LSArrayGetObjectAt","LSDeleteBackupOnClient","LSIsEncryptionVersionSecure","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure] Beginning execution."),t.i64.neq(e[0],void 0)?t.sequence([function(e){return t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))||!1}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[13]=new t.Map,r[13].set("error_msg","Expected a nonempty query result"),r[13].set("code",t.i64.cast([0,3])),r[13].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),r[14]=t.createArray(),r[15]=(r[14].push(r[13]),r[14]),o=[void 0,r[14]],r[7]=o[0],r[8]=o[1]):(n=l.item,r[13]=new t.Map,r[13].set("backup_id",n.backupId),r[13].set("device_public_key_blob",n.devicePublicKeyBlob),r[13].set("device_private_key_blob",n.devicePrivateKeyBlob),r[13].set("epoch_storage_public_key_blob",n.epochStoragePublicKeyBlob),r[13].set("epoch_storage_private_key_blob",n.epochStoragePrivateKeyBlob),r[13].set("epoch_auth_public_key_blob",n.epochAuthPublicKeyBlob),r[13].set("epoch_auth_private_key_blob",n.epochAuthPrivateKeyBlob),r[13].set("mailbox_root_key_blob",n.mailboxRootKeyBlob),r[13].set("ocmf_client_state_blob",n.ocmfClientStateBlob),r[13].set("orf_client_state_v2_blob",void 0),r[13].set("orf_v2_authority_level",void 0),r[13].set("oblivious_validation_token_blob",n.obliviousValidationTokenBlob),r[13].set("device_id",n.deviceId),r[13].set("backup_tenancy",n.backupTenancy),r[13].set("encryption_version",n.encryptionVersion),r[13].set("revision_version",n.revisionVersion),r[13].set("initialize_restore_result",void 0),r[13].set("device_creation_timestamp_sec",void 0),r[13].set("authority_level",n.authorityLevel),a=[r[13],void 0],r[7]=a[0],r[8]=a[1])})},function(o){return r[10]=new t.Map,r[10].set("value",r[7]),r[10].set("errors",r[8]),r[11]=r[10].get("value"),r[11]!==void 0?t.sequence([function(o){return r[13]=r[11].get("backup_id"),r[14]=r[11].get("device_public_key_blob"),r[15]=r[11].get("device_private_key_blob"),r[16]=r[11].get("epoch_storage_public_key_blob"),r[17]=r[11].get("epoch_storage_private_key_blob"),r[18]=r[11].get("epoch_auth_public_key_blob"),r[19]=r[11].get("epoch_auth_private_key_blob"),r[20]=r[11].get("mailbox_root_key_blob"),r[21]=r[11].get("ocmf_client_state_blob"),r[22]=r[11].get("orf_client_state_v2_blob"),r[23]=r[11].get("orf_v2_authority_level"),r[24]=r[11].get("oblivious_validation_token_blob"),r[25]=r[11].get("device_id"),r[26]=r[11].get("backup_tenancy"),r[27]=r[11].get("encryption_version"),r[28]=r[11].get("revision_version"),r[29]=r[11].get("initialize_restore_result"),r[30]=r[11].get("device_creation_timestamp_sec"),r[31]=r[11].get("authority_level"),t.i64.neq(r[25],void 0)?t.sequence([function(e){return r[33]=void 0,t.i64.neq(r[33],void 0)?t.resolve(r[34]=r[33]):t.sequence([function(e){return r[37]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[38]=t[0],t})},function(e){return r[38]&&(r[47]=(r[37].push(t.i64.cast([0,0])),r[37])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[39]=t[0],t})},function(e){return r[39]&&(r[47]=(r[37].push(t.i64.cast([0,2])),r[37])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[40]=t[0],t})},function(e){return r[40]&&(r[47]=(r[37].push(t.i64.cast([0,3])),r[37])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[41]=t[0],t})},function(e){return r[41]&&(r[47]=(r[37].push(t.i64.cast([0,4])),r[37])),r[42]=t.createArray(),r[43]=t.i64.of_int32(r[37].length),t.i64.gt(r[43],t.i64.cast([0,0]))?t.loopAsync(r[43],function(e){return r[47]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[37],r[47]).then(function(e){var t;return t=e,r[48]=t[0],r[49]=t[1],t})},function(e){return r[50]=(r[42].push(r[48]),r[42])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[47]=t.createArray(),r[48]=t.i64.of_int32(r[42].length),t.i64.gt(r[48],t.i64.cast([0,0]))?t.loopAsync(r[48],function(e){return r[50]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[42],r[50]).then(function(e){var t;return t=e,r[51]=t[0],r[52]=t[1],t})},function(e){return r[53]=(r[47].push(t.i64.to_string(r[51])),r[47])}])}):t.resolve()},function(e){return r[49]=r[47].join(","),r[44]=r[49]}])},function(e){return r[42].some(function(e){return t.i64.eq(r[27],e)})?r[45]=r[27]:r[45]=void 0,t.i64.neq(r[45],void 0)?r[46]=r[45]:r[46]=void 0,r[34]=r[46]}])},function(o){return t.i64.neq(r[34],void 0)?r[35]=r[34]:r[35]=t.i64.cast([0,0]),t.i64.neq(r[26],void 0)?r[36]=r[26]:r[36]=t.i64.cast([0,1]),t.i64.eq(r[25],e[0])?t.sequence([function(e){return t.storedProcedure(n("LSDeleteBackupOnClient"),r[13],void 0,!1,void 0,void 0,!0)},function(n){return r[37]=t.i64.of_float(Date.now()),t.db.table(343).add({pk:void 0,deviceReenrollmentReason:e[1],reenrollmentTimestamp:r[37]})}]):t.resolve(0)},function(e){return r[32]=!0}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure] Failed to load client state: 24"),r[34]="Failed to load client state: 24",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure] ","",r[34]].join("")),r[33]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure",r[34],r[33],t.i64.cast([0,3]))},function(e){return r[32]=!1}])},function(e){return r[12]=r[32]}]):t.sequence([function(e){return r[13]=r[10].get("errors"),r[14]=r[10].get("errors"),(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure] Failed to load client state: 1"),r[16]="Failed to load client state: 1",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure] ","",r[16]].join("")),r[15]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure",r[16],r[15],t.i64.cast([0,3]))},function(e){return r[12]=!1}])}]):t.sequence([function(e){return t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))||!0}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[13]=new t.Map,r[13].set("error_msg","Expected a nonempty query result"),r[13].set("code",t.i64.cast([0,3])),r[13].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),r[14]=t.createArray(),r[15]=(r[14].push(r[13]),r[14]),o=[void 0,r[14]],r[7]=o[0],r[8]=o[1]):(n=l.item,r[13]=new t.Map,r[13].set("backup_id",n.backupId),r[13].set("device_public_key_blob",n.devicePublicKeyBlob),r[13].set("device_private_key_blob",n.devicePrivateKeyBlob),r[13].set("epoch_storage_public_key_blob",n.epochStoragePublicKeyBlob),r[13].set("epoch_storage_private_key_blob",n.epochStoragePrivateKeyBlob),r[13].set("epoch_auth_public_key_blob",n.epochAuthPublicKeyBlob),r[13].set("epoch_auth_private_key_blob",n.epochAuthPrivateKeyBlob),r[13].set("mailbox_root_key_blob",n.mailboxRootKeyBlob),r[13].set("ocmf_client_state_blob",n.ocmfClientStateBlob),r[13].set("orf_client_state_v2_blob",void 0),r[13].set("orf_v2_authority_level",void 0),r[13].set("oblivious_validation_token_blob",n.obliviousValidationTokenBlob),r[13].set("device_id",n.deviceId),r[13].set("backup_tenancy",n.backupTenancy),r[13].set("encryption_version",n.encryptionVersion),r[13].set("revision_version",n.revisionVersion),r[13].set("initialize_restore_result",void 0),r[13].set("device_creation_timestamp_sec",void 0),r[13].set("authority_level",n.authorityLevel),a=[r[13],void 0],r[7]=a[0],r[8]=a[1])})},function(e){return r[10]=new t.Map,r[10].set("value",r[7]),r[10].set("errors",r[8]),r[11]=r[10].get("value"),r[11]!==void 0?t.sequence([function(e){return r[13]=r[11].get("backup_id"),r[14]=r[11].get("device_public_key_blob"),r[15]=r[11].get("device_private_key_blob"),r[16]=r[11].get("epoch_storage_public_key_blob"),r[17]=r[11].get("epoch_storage_private_key_blob"),r[18]=r[11].get("epoch_auth_public_key_blob"),r[19]=r[11].get("epoch_auth_private_key_blob"),r[20]=r[11].get("mailbox_root_key_blob"),r[21]=r[11].get("ocmf_client_state_blob"),r[22]=r[11].get("orf_client_state_v2_blob"),r[23]=r[11].get("orf_v2_authority_level"),r[24]=r[11].get("oblivious_validation_token_blob"),r[25]=r[11].get("device_id"),r[26]=r[11].get("backup_tenancy"),r[27]=r[11].get("encryption_version"),r[28]=r[11].get("revision_version"),r[29]=r[11].get("initialize_restore_result"),r[30]=r[11].get("device_creation_timestamp_sec"),r[31]=r[11].get("authority_level"),t.i64.neq(r[25],void 0)?t.sequence([function(e){return r[33]=void 0,t.i64.neq(r[33],void 0)?t.resolve(r[34]=r[33]):t.sequence([function(e){return r[37]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[38]=t[0],t})},function(e){return r[38]&&(r[47]=(r[37].push(t.i64.cast([0,0])),r[37])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[39]=t[0],t})},function(e){return r[39]&&(r[47]=(r[37].push(t.i64.cast([0,2])),r[37])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[40]=t[0],t})},function(e){return r[40]&&(r[47]=(r[37].push(t.i64.cast([0,3])),r[37])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[41]=t[0],t})},function(e){return r[41]&&(r[47]=(r[37].push(t.i64.cast([0,4])),r[37])),r[42]=t.createArray(),r[43]=t.i64.of_int32(r[37].length),t.i64.gt(r[43],t.i64.cast([0,0]))?t.loopAsync(r[43],function(e){return r[47]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[37],r[47]).then(function(e){var t;return t=e,r[48]=t[0],r[49]=t[1],t})},function(e){return r[50]=(r[42].push(r[48]),r[42])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[47]=t.createArray(),r[48]=t.i64.of_int32(r[42].length),t.i64.gt(r[48],t.i64.cast([0,0]))?t.loopAsync(r[48],function(e){return r[50]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[42],r[50]).then(function(e){var t;return t=e,r[51]=t[0],r[52]=t[1],t})},function(e){return r[53]=(r[47].push(t.i64.to_string(r[51])),r[47])}])}):t.resolve()},function(e){return r[49]=r[47].join(","),r[44]=r[49]}])},function(e){return r[42].some(function(e){return t.i64.eq(r[27],e)})?r[45]=r[27]:r[45]=void 0,t.i64.neq(r[45],void 0)?r[46]=r[45]:r[46]=void 0,r[34]=r[46]}])},function(e){return t.i64.neq(r[34],void 0)?r[35]=r[34]:r[35]=t.i64.cast([0,0]),t.i64.neq(r[26],void 0)?r[36]=r[26]:r[36]=t.i64.cast([0,1]),r[32]=!0}]):t.resolve(r[32]=!1)},function(e){return r[12]=r[32]}]):t.resolve((r[13]=r[10].get("errors"),r[14]=r[10].get("errors"),r[12]=!1))},function(o){return r[12]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure] Failure. Attempted to reset nux flags on an onboarded device"),r[14]="Failure. Attempted to reset nux flags on an onboarded device",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure] ","",r[14]].join("")),r[13]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure",r[14],r[13],t.i64.cast([0,3]))):(r[13]=t.i64.of_float(Date.now()),t.db.table(343).add({pk:void 0,deviceReenrollmentReason:e[1],reenrollmentTimestamp:r[13]}))}])},function(e){return r[1]=t.i64.of_float(Date.now()),r[2]=t.i64.random(),r[4]="Finishing execution. Execution time: ",r[5]=t.i64.to_string(t.i64.sub(r[1],r[0])),r[6]=" ms",r[3]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure] ",r[3],r[4],r[3],r[5],r[3],r[6]].join("")),t.i64.eq(t.i64.mod_(r[2],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[7]=",",r[8]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure",[r[4],r[7],r[5],r[7],r[6]].join(""),r[8],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure",e.__tables__=["secure_encrypted_backups_client_state","encrypted_backups_reenrollment_trigger"],a.exports=e}),null);
__d("LSGetBlobFromString.nop",["CryptoLogger","LSResult","LSSynchronousPromise","XPlatReactTextEncoder","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t,n,a){var e=new(o("XPlatReactTextEncoder")).TextEncoder;try{var i=e.encode(a).buffer;return o("LSSynchronousPromise").makeSynchronousPromise(r("LSResult")(i))}catch(e){var l=r("getErrorSafe")(e),s=o("CryptoLogger").CryptoLogger("get_blob_from_string");throw s.catching(l).mustfix(l.message),l}};e.__nop_name__="LSGetBlobFromString",l.default=e}),98);
__d("LSInitSyncCompleteSubscription",["I64","LSIntEnum","Promise","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(t,r){return new(u||(u=n("Promise")))(function(n,a){var i=o("ReQL").fromTableAscending(t.tables.sync_groups).getKeyRange(r).subscribe(function(t,r){if(r.operation!=="delete"&&(e||(e=o("I64"))).equal(r.value.syncStatus,(s||(s=o("LSIntEnum"))).ofNumber(2)))return i(),n()})})}function d(t,n){return o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.tables.sync_groups).getKeyRange(n)).then(function(r){if(!(r!=null&&(e||(e=o("I64"))).equal(r.syncStatus,(s||(s=o("LSIntEnum"))).ofNumber(2))))return c(t,n)})}function m(e){return c(e,(s||(s=o("LSIntEnum"))).ofNumber(1))}l.maybeWaitForSyncGroup=d,l.use=m}),98);
__d("LSIssueNextSync",["LSIssueNewTaskAndGetTaskID"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(n){return t.count(t.filter(t.db.table(310).fetch(),function(t){return t.projectName===e[1]})).then(function(e){return r[0]=e})},function(o){return t.i64.gt(r[0],t.i64.cast([0,0]))&&e[3]===!0?t.resolve(0):t.sequence([function(n){return t.forEach(t.filter(t.db.table(310).fetch(),function(t){return t.projectName===e[1]}),function(e){return e.delete()})},function(o){return t.i64.gt(e[2],t.i64.cast([0,0]))?(r[3]=t.i64.of_float(Date.now()),r[1]=t.i64.add(r[3],e[2])):r[1]=t.i64.cast([0,0]),t.storedProcedure(n("LSIssueNewTaskAndGetTaskID"),["acs_sync","_",e[1]].join(""),t.i64.cast([0,362]),"",void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,r[1],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[2]=t[0],t})},function(n){return t.db.table(310).add({taskId:r[2],projectName:e[1],maxClientTokenPoolSize:e[0]})}])}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSAnonymousCredentialsIssueNextSyncStoredProcedure",e.__tables__=["acs_request_context"],a.exports=e}),null);
__d("LSMailboxTaskCompletionApiOnTaskCompletion",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(n){return t.forEach(t.db.table(233).fetch([[[e[0]]]]),function(t){var n=t.update,r=t.item;return n({success:e[1]})})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSCoreMailboxTaskCompletionApiOnTaskCompletionStoredProcedure",e.__tables__=["mailbox_task_completion_api_tasks"],a.exports=e}),null);
__d("LSMessagingThreadAttributionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNKNOWN:0,UNKNOWN_TEST:1,UNKNOWN_FAILURE_RETRY:2,MESSENGER_INBOX:65536,MESSENGER_INBOX_IN_THREAD:65537,MESSENGER_INBOX_THREAD_LIST:65538,MESSENGER_INBOX_NESTED_FOLDER:65539,MESSENGER_INBOX_RECENT_THREADS:65540,MESSENGER_INBOX_REMAINING_THREADS:65541,MESSENGER_INBOX_MESSAGE_SEARCH:65542,MESSENGER_INBOX_IMAGE_SENDING:65543,MESSENGER_INBOX_FORWARD:65544,MESSENGER_INBOX_ARCHIVED_THREADS:65545,MESSENGER_INBOX_PENDING_REQUESTS:65546,MESSENGER_INBOX_ACTIVE_CONTACTS:65547,MESSENGER_INBOX_THREAD_BANNER_BOTTOM_SHEET:65548,MESSENGER_INBOX_PEOPLE_YOU_MAY_KNOW:65549,MESSENGER_INBOX_HOLIDAY_CARD_SHARE_SHEET:65550,MESSENGER_INBOX_HOLIDAY_CARD_SHARE_SHEET_QP:65551,MESSENGER_INBOX_META_AI_FAB:65552,MESSENGER_INBOX_META_AI_LONG_PRESS_MENU:65553,MESSENGER_INBOX_PINNED_THREAD:65554,MESSENGER_INBOX_PEOPLE_YOU_MAY_MESSAGE:65555,MESSENGER_INBOX_META_AI_INVOCATION:65556,MESSENGER_INBOX_FOLLOWUP_SENDER:65557,MESSENGER_INBOX_FOLLOWUP_RECEIVER:65558,MESSENGER_INBOX_DRAFT_MESSAGE:65559,MESSENGER_INBOX_META_AI_DIGEST:65560,MESSENGER_UNIVERSAL_SEARCH:131072,MESSENGER_UNIVERSAL_SEARCH_NULL_STATE:131073,MESSENGER_UNIVERSAL_SEARCH_KEY_PRESSED:131074,MESSENGER_UNIVERSAL_SEARCH_MESSAGE_SEARCH:131075,MESSENGER_UNIVERSAL_SEARCH_ADVANCED_CONTENT_SEARCH:131076,MESSENGER_UNIVERSAL_SEARCH_AI_PROMPT:131077,MESSENGER_UNIVERSAL_SEARCH_AI_TYPEAHEAD:131078,MESSENGER_UNIVERSAL_SEARCH_AI_TYPEAHEAD_AIRPLANE_SEND:131079,MESSENGER_UNIVERSAL_SEARCH_AI_TYPEAHEAD_KEYBOARD_SEND:131080,MESSENGER_UNIVERSAL_SEARCH_AI_TYPEAHEAD_DONUT:131081,MESSENGER_UNIVERSAL_SEARCH_AI_NULLSTATE_DONUT:131082,MESSENGER_UNIVERSAL_SEARCH_AI_NULLSTATE_AIRPLANE_SEND:131083,MESSENGER_UNIVERSAL_SEARCH_META_AI_SEARCH_RESULT:131084,MESSENGER_UNIVERSAL_SEARCH_AI_TYPEAHEAD_SNIPPET:131085,MESSENGER_UNIVERSAL_SEARCH_AI_TYPEAHEAD_KEYBOARD_SEND_SNIPPET:131086,MESSENGER_UNIVERSAL_SEARCH_SERP_SNIPPET:131087,MESSENGER_UNIVERSAL_SEARCH_SERP_SNIPPET_PILL:131088,MESSENGER_UNIVERSAL_SEARCH_AI_DISCOVERY_MODULE:131089,MESSENGER_UNIVERSAL_SEARCH_KEY_PRESSED_WITH_SNIPPET:131090,MONTAGE_AND_ACTIVE_NOW:196608,MONTAGE_AND_ACTIVE_NOW_MONTAGE_INBOX_UNIT:196609,MONTAGE_AND_ACTIVE_NOW_ACTIVE_NOW:196610,MONTAGE_AND_ACTIVE_NOW_INBOX_COMPOSER:196611,MONTAGE_AND_ACTIVE_NOW_ACTIVE_AND_HAS_STORY:196612,MONTAGE_AND_ACTIVE_NOW_CUSTOM_STATUS:196613,MONTAGE_AND_ACTIVE_NOW_NOTES:196614,MONTAGE_AND_ACTIVE_NOW_SEE_ALL_ACTIVE:196615,MONTAGE_AND_ACTIVE_NOW_AN_TRAY_STORY_REPLY:196616,MESSENGER_ACTIVE_NOW_FRIENDS_TAB:262144,MESSENGER_ACTIVE_NOW_FRIENDS_TAB_FRIENDS_TAB:262145,MESSENGER_ACTIVE_NOW_FRIENDS_TAB_PLACE_HOLDER:262146,MESSENGER_ACTIVE_NOW_FRIENDS_TAB_RECENT_ACTIVE:262147,MESSENGER_ACTIVE_NOW_FRIENDS_TAB_RECENT_ACTIVE_AND_STORY:262148,MESSENGER_ACTIVE_NOW_FRIENDS_TAB_CONTENT_DISCOVERY:262149,MESSENGER_ACTIVE_NOW_FRIENDS_TAB_META_AI_FAB:262150,MESSENGER_PENDING_REQUESTS:327680,MESSENGER_PENDING_REQUESTS_INBOX_THREAD_LIST:327681,MESSENGER_PENDING_REQUESTS_PENDING_REQUESTS_PAGE:327682,MESSENGER_BROADCAST_FLOW:393216,MESSENGER_BROADCAST_FLOW_FROM_MESSENGER:393217,MESSENGER_BROADCAST_FLOW_FROM_FB:393218,MESSENGER_BROADCAST_FLOW_FROM_EXTERNAL:393219,MESSENGER_BROADCAST_FLOW_FROM_FB__NEWSFEED_SHARESHEET:393220,MESSENGER_BROADCAST_FLOW_FROM_FB__NEWSFEED_GOODWILL_COMPOSER:393221,MESSENGER_BROADCAST_FLOW_FROM_FB__SHORTS_VIEWER:393222,MESSENGER_BROADCAST_FLOW_FORWARD_GUTTER:393223,MESSENGER_BROADCAST_FLOW_FORWARD_LONGCLICK:393224,MESSENGER_BROADCAST_FLOW_MESSENGER_PHOTO_VIEW:393225,MESSENGER_OMNIPICKER:458752,MESSENGER_OMNIPICKER_NULL_STATE:458753,MESSENGER_OMNIPICKER_KEY_PRESSED:458754,MESSENGER_NOTIFICATION:524288,MESSENGER_NOTIFICATION_IN_THREAD_REPLY:524289,MESSENGER_NOTIFICATION_LONGPRESS_REPLY:524290,MESSENGER_NOTIFICATION_LONGPRESS_REACTION:524291,MESSENGER_NOTIFICATION_JEWEL_NOTIF_PUSH_UPSELL:524292,CLICK_TO_MESSENGER_AD:589824,CLICK_TO_MESSENGER_AD_FROM_NEWSFEED:589825,CLICK_TO_MESSENGER_AD_SEND_MESSAGE_CTA:589826,CLICK_TO_MESSENGER_AD_VIEW_AND_MESSAGE:589827,CLICK_TO_MESSENGER_AD_SEND_MESSAGE_CTA__NEWSFEED_CTM_ADS_CTA:589828,CLICK_TO_MESSENGER_AD_FROM_NEWSFEED_OPTIMISTIC_LTV:589829,CLICK_TO_MESSENGER_AD_FROM_NEWSFEED_LEAD_GEN:589830,PAYMENTS:655360,PAYMENTS_BUBBLE_CLICK:655361,RTC:720896,RTC_VOIP_INCALL:720897,RTC_DRAWER_PROMOTION:720898,FB_PAGE:786432,FB_PAGE_ABOUT_CARD:786433,FB_PAGE_PROFILE_HEADER_MESSAGE_BUTTON:786434,FB_PAGE_PROFILE_FOOTER_MESSAGE_BUTTON:786435,FB_PAGE_PROFILE_MORE_DRAWER:786436,FB_PAGE_RESPONSIVENESS_CONTEXT_CARD:786437,FB_PAGE_PYMM_RHC:786439,FB_PAGE_PAGES_HOME_FRIENDS_DIALOG:786440,FB_PAGE_PAGES_PRIVATE_REPLY:786441,FB_PROFILE:851968,FB_PROFILE_TIMELINE_MESSAGE_BUTTON:851969,FB_PROFILE_FACEBOOK_PROFILE:851970,FB_PROFILE_MESSAGE_BUTTON:851971,FB_PROFILE_MESSAGE_BUTTON_BLOKS_URL:851972,FB_PROFILE_PROFILE_HEADER_COMPOSER:851973,FB_PROFILE_MUTUAL_FRIENDS_DIALOG:851974,FB_PROFILE_DIRECTORY_MESSENGER_MESSAGE_BLOKS_URL:851975,FB_PROFILE_PROFILE_DIRECTORY_MESSAGE_BUTTON:851976,FB_SEARCH:917504,FB_SEARCH_CONTEXTUAL_PROFILE_ACTION_BAR_FROM_SEARCH:917505,FB_SEARCH_SEARCH_MESSAGE_BUTTON:917506,FB_SEARCH_FB_MESSAGE_SEARCH_RESULTS:917507,FB_SEARCH_HIGH_CONFIDENCE_CARD:917508,FB_SEARCH_MENTIONS:917509,FB_SEARCH_NULLSTATE_CTA:917510,FB_SEARCH_NULL_STATE:917511,FB_SEARCH_TYPEAHEAD:917512,FB_SEARCH_TYPEAHEAD_AIRPLANE_SEND:917513,FB_SEARCH_TYPEAHEAD_KEYBOARD_SEND:917514,FB_SEARCH_TYPEAHEAD_DONUT:917515,FB_SEARCH_NULL_STATE_DONUT:917516,FB_SEARCH_NULL_STATE_AIRPLANE_SEND:917517,FB_SEARCH_NULL_STATE_KEYBOARD_SEND:917518,FB_SEARCH_SERP_PROMPT_SUGGESTIONS:917519,FB_SEARCH_AI_DISCOVERY_MODULE:917520,FB_SEARCH_TYPEAHEAD_AI_SHORTCUT:917521,CRYPTO:983040,MESSENGER_MONTAGE_COMPOSER:1048576,MESSENGER_MONTAGE_COMPOSER_FRIENDS_TAB:1048577,MESSENGER_MONTAGE_COMPOSER_FRIENDS_TAB_STORY_AND_ACTIVE_NOW:1048578,MESSENGER_MONTAGE_REPLY:1114112,MESSENGER_MONTAGE_REPLY_INBOX_THREAD_LIST_PROFILE:1114113,MESSENGER_MONTAGE_REPLY_REPLY_CONTEXT:1114114,MESSENGER_MONTAGE_REPLY_THREAD_NAV_BAR:1114115,MESSENGER_MONTAGE_REPLY_INBOX_THREAD_LIST_PROFILE_AUTHOR_PROFILE:1114116,MESSENGER_MONTAGE_REPLY_REPLY_CONTEXT_AUTHOR_PROFILE:1114117,MESSENGER_MONTAGE_REPLY_THREAD_NAV_BAR_AUTHOR_PROFILE:1114118,MESSENGER_MONTAGE_REPLY_ONE_TO_ONE_CHAT_THREAD_STORY_BUBBLE:1114119,MESSENGER_THREAD_MEMBERS_LIST:1179648,MARKETPLACE:1245184,MARKETPLACE_ACTIVITY_BANNER:1245185,MARKETPLACE_SEND_MESSAGE:1245186,MARKETPLACE_GEN_AI_ACCORDION_META_AI_PILL:1245187,MARKETPLACE_GEN_AI_ACCORDION_FOLLOW_UP_QUESTION:1245188,MARKETPLACE_GEN_AI_PRICE_CHECK_META_AI_PILL:1245189,MARKETPLACE_GEN_AI_PRICE_CHECK_FOLLOW_UP_QUESTION:1245190,MARKETPLACE_META_AI_PILLS_MODULE_META_AI_PILL_GENERIC:1245191,MARKETPLACE_META_AI_PILLS_MODULE_META_AI_PILL_WITH_PROMPT:1245192,MARKETPLACE_GEN_AI_ENRICHED_DESCRIPTION_META_AI_PILL_GENERIC:1245193,MARKETPLACE_GEN_AI_ENRICHED_DESCRIPTION_META_AI_PILL_WITH_PROMPT:1245194,MARKETPLACE_META_AI_FAB:1245195,MARKETPLACE_ASSISTANT:1245196,FB_STORY:1310720,FB_STORY_VIEWER_SHEET_MENU:1310721,FB_STORY_VIEWER_SHEET_ROW:1310722,FB_STORY_STORIES_JEWEL_NOTIFICATION:1310723,FB_STORY_STORIES_PUSH_NOTIFICATION:1310724,FB_STORY_STORIES_VIEWER_CONSUMER_REPLY:1310725,FB_STORY_STORIES_VIEWER_CONSUMER_ARTIFACT:1310726,FB_STORY_STORIES_PAGE_STORY_CONVERSATIONS:1310727,FB_STORY_SOCIAL_CONTEXT_CONVERSATIONS:1310728,FB_STORY_MENTIONS:1310729,FB_STORY_SELF_STORY_SEND:1310730,FB_STORY_SHARESHEET:1310731,FB_STORY_NOTES:1310732,FB_STORY_TRY_META_AI_STICKER:1310733,FB_STORY_CHALLENGES_NOMINATION:1310734,FB_STORY_NOTES_STORY_VIEWER:1310735,FB_STORY_STORIES_PAGE_STORY_ADMIN_CONVERSATIONS:1310736,WORKSPEED:1376256,WORKSPEED_COMPOSER_LIKE_BUTTON:1376257,WORKSPEED_COMPOSER_GIF_PICKER:1376258,MDOTME:1441792,MDOTME_ORGANIC_POST:1441793,MDOTME_MARKETING_EMAIL:1441794,MDOTME_MBS_OFFSITE_EMAIL:1441795,CUSTOMER_CHAT_PLUGIN:1507328,CUSTOMER_CHAT_PLUGIN_MOBILE_REDIRECT:1507329,CUSTOMER_CHAT_PLUGIN_UPGRADE_FLOW:1507330,CUSTOMER_CHAT_PLUGIN_RE_ENGAGEMENT:1507331,FB_FEED:1572864,FB_FEED_ORGANIC_POST:1572865,FB_FEED_ORGANIC_POST_VIEW_AND_MESSAGE:1572866,FB_FEED_QUESTION_TRIGGERED_CONVO:1572867,FB_FEED_DYNAMIC_HOVER_CARD:1572868,FB_FEED_ORGANIC_POST__NEWSFEED_PAGE_POST_CTA:1572869,FB_FEED_ORGANIC_POST__NEWSFEED_BUMPER_SMCTA:1572870,FB_FEED_BCF_OPEN_CHAT_BUTTON:1572871,FB_FEED_REACTORS_LIST_MESSAGE_BUTTON:1572872,FB_FEED_REPLY_TO_AUTHOR:1572873,FB_FEED_UFI_SEND_SUGGESTIONS:1572874,FB_FEED_BCF:1572875,FB_FEED_COMMUNITY_CHATS_FEED_POST:1572876,FB_FEED_SOCIAL_CONNECTIONS_QP:1572877,FB_FEED_META_AI_DEEP_DIVES:1572878,FB_FEED_META_AI_SHARE_SHEET:1572879,FB_FEED_META_AI_TRENDING_DISCOVER_UNIT:1572880,FB_FEED_META_AI_POST_DEEPDIVE_PILL:1572881,FB_FEED_META_AI_EDUCATIONAL_QP:1572882,FB_FEED_META_AI_ENTITY_SUMMARIZATION_DISCOVER_UNIT:1572883,FB_FEED_META_AI_COMMENTS_SUMMARY:1572884,FB_FEED_META_AI_FAB:1572885,FB_FEED_META_AI_ADS_CAMPAIGN:1572886,FB_FEED_META_AI_ANSWERSHEET:1572887,FB_FEED_META_AI_BOOKMARK:1572888,FB_FEED_META_AI_FAB_COMMENTS_SUMMARY:1572889,FB_FEED_META_AI_FAB_CONTEXTUAL:1572890,FB_FEED_FEED_POLL:1572891,FB_FEED_BIZ_VOICE_AGENT:1572892,FB_FEED_MESSAGE_CREATOR_OF_POST:1572893,FB_FEED_HORIZON_WORLD_INVITE_FRIENDS:1572894,FB_NOTIFICATION:1638400,FB_NOTIFICATION_JEWEL_NOTIF:1638401,FB_NOTIFICATION_PUSH_NOTIF:1638402,FB_EVENT:1703936,FB_EVENT_MESSAGE_HOST:1703937,FB_EVENT_SHARE_CLASS_MATERIALS:1703938,SUPPORT_RESOURCES:1769472,SUPPORT_RESOURCES_FRX_ACTION:1769473,LEAD_GEN_MESSAGING:1835008,LEAD_GEN_MESSAGING_PRE_SUBMISSION:1835009,LEAD_GEN_MESSAGING_POST_SUBMISSION:1835010,LEAD_GEN_MESSAGING_CROSS_CHANNEL_VERTICAL_PRESENT_ANDROID:1835011,LEAD_GEN_MESSAGING_CROSS_CHANNEL_HSCROLL_ANDROID:1835012,MESSENGER_GRAPH:1900544,MESSENGER_GRAPH_SELECT_CONTACT:1900545,MESSENGER_CHAT:1966080,MESSENGER_CHAT_FROM_JEWEL__THREAD_LIST:1966081,MESSENGER_CHAT_IN_THREAD:1966082,MESSENGER_CHAT_FORWARD:1966083,MESSENGER_CHAT_NOTE_POPOVER:1966084,MESSENGER_ARCHIVED_THREADS:2031616,MESSENGER_ARCHIVED_THREADS_ARCHIVED_THREADS_FOLDER:2031617,JEWEL:2097152,JEWEL_THREAD_LIST:2097153,JEWEL_SEARCH:2097154,JEWEL_NEW_MESSAGE:2097155,JEWEL_NESTED_FOLDER:2097156,JEWEL_META_AI_FAB:2097157,CHATHEADS:2162688,CHATHEADS_RECENT_THREADS:2162689,CHATHEADS_OVERFLOW:2162690,CHATHEADS_NEW_MESSAGE:2162691,SIDEBAR:2228224,SIDEBAR_CONTACTS_LIST:2228225,SIDEBAR_CONTACTS_SEARCH:2228226,SIDEBAR_CONTACTS_GROUPS:2228227,SIDEBAR_CONTACTS_COMMUNITY_CHATS:2228228,MESSENGER_COMMUNITY_MESSAGING:2293760,MESSENGER_COMMUNITY_MESSAGING_COMMUNITY_CHANNEL:2293761,MESSENGER_COMMUNITY_MESSAGING_FULLSCREEN_CHAT:2293762,MESSENGER_COMMUNITY_MESSAGING_CHANNEL_CREATION_NOTIFICATION:2293763,MESSENGER_COMMUNITY_MESSAGING_FRIEND_JOINED_COMMUNITY_CHAT_NOTIFICATION:2293764,MESSENGER_COMMUNITY_MESSAGING_COMMUNITY_FRIENDS_DIALOG:2293765,MESSENGER_COMMUNITY_MESSAGING_META_AI_FAB:2293766,FB_PLATFORM_LOGIN:2359296,FB_PLATFORM_LOGIN_LOGIN_CONNECT_WITH_MESSENGER:2359297,CONTACT_MANAGER:2424832,CONTACT_MANAGER_CONTACT_SHARE:2424833,CONTACT_MANAGER_PEOPLE_TAB_CONTACT_LIST:2424834,CONTACT_MANAGER_PEOPLE_TAB_CONTACT_SEARCH:2424835,CONTACT_MANAGER_ICON_CONTACT_LIST:2424836,CONTACT_MANAGER_ICON_CONTACT_SEARCH:2424837,MESSAGING_INBOX_IN_BLUE:2490368,MESSAGING_INBOX_IN_BLUE_THREAD_LIST:2490369,MESSAGING_INBOX_IN_BLUE_PEOPLE_PICKER:2490370,MESSAGING_INBOX_IN_BLUE_INBOX_ICON:2490371,MESSAGING_INBOX_IN_BLUE_SWIPE_FROM_RIGHT:2490372,MESSAGING_INBOX_IN_BLUE_MIB_NOTIFICATION:2490373,MESSAGING_INBOX_IN_BLUE_ACTIVE_NOW:2490374,MESSAGING_INBOX_IN_BLUE_SUGGESTED_CHATS:2490375,MESSAGING_INBOX_IN_BLUE_CHAT_PREVIEW_BANNER:2490376,MESSAGING_INBOX_IN_BLUE_THREAD_VIEW_CORE_NULL_STATE:2490377,MESSAGING_INBOX_IN_BLUE_MESSAGE_REQUESTS:2490378,MESSAGING_INBOX_IN_BLUE_SPAM:2490379,MESSAGING_INBOX_IN_BLUE_FB_GROUPS:2490380,MESSAGING_INBOX_IN_BLUE_MESSENGER_PEEK_STATE_BUTTON:2490381,MESSAGING_INBOX_IN_BLUE_MESSENGER_PEEK_STATE_TOOLTIP:2490382,MESSAGING_INBOX_IN_BLUE_BROADCAST_FLOW:2490383,MESSAGING_INBOX_IN_BLUE_THREAD_VIEW_HEADER:2490384,MESSAGING_INBOX_IN_BLUE_PRIVACY_SETTINGS:2490385,MESSAGING_INBOX_IN_BLUE_ARCHIVED_CHATS:2490386,MESSAGING_INBOX_IN_BLUE_UNIVERSAL_SEARCH:2490387,MESSAGING_INBOX_IN_BLUE_INBOX_SEARCH_BAR:2490388,MESSAGING_INBOX_IN_BLUE_PREVIEW_SHEET:2490389,MESSAGING_INBOX_IN_BLUE_PEOPLE_YOU_MAY_MESSAGE:2490390,MIB_NOTIFICATION:2555904,MIB_NOTIFICATION_PUSH_NOTIFICATION:2555905,MIB_NOTIFICATION_JEWEL_NOTIFICATION:2555906,MIB_NOTIFICATION_DIRECT_PUSH_NOTIF:2555907,MIB_NOTIFICATION_DIRECT_JEWEL_NOTIF:2555908,MESSENGER_RESTRICTED_ACCOUNTS:2621440,ARMADILLO_CUTOVER_THREAD_LINKING_MESSAGE:2686976,CALLS_TAB:2752512,MINI_SHOP_VIEW_MENU_BUTTON:2818048,SHARESHEET:2883584,SHARESHEET_GENERALIZED_BROADCAST_FLOW:2883585,SHARESHEET_OFF_PLATFORM_SHARING_H_SCROLL:2883586,SHARESHEET_BROADCAST_CHANNEL:2883587,UFI:2949120,UFI_GENERALIZED_BROADCAST_FLOW:2949121,CHATHEAD_CLICK_COLLAPSED:3014656,TIMELINE_MESSAGE_BUTTON:3080192,DIRECT_REPLY_INTENT:3145728,FB_GROUPS:3211264,FB_GROUPS_INBOX:3211265,FB_GROUPS_PICKER_EXISTING_CHAT:3211266,FB_GROUPS_PICKER_JOIN_CHAT:3211267,FB_GROUPS_MEMBER_LIST:3211268,FB_GROUPS_INLINE_COMPOSER:3211269,FB_GROUPS_SCOPED_SEARCH:3211270,FB_GROUPS_UNJOINED_MALL_HEADER:3211271,FB_GROUPS_DISCOVER_FEED_UNIT:3211272,FB_GROUPS_ANSWER_AGENT_CONTEXTUAL_PROFILE:3211273,FB_GROUPS_ANSWER_AGENT_FOLLOWUP_SECTION:3211274,FB_GROUPS_NOTIFICATION_MESSAGING_IN_BLUE_DIRECT_MESSAGE:3211275,FB_GROUPS_UGC:3211276,FB_GROUPS_UGC_POST:3211277,FB_GROUPS_UGC_MALL_PLINK:3211278,FB_GROUPS_UGC_MALL_NUX:3211279,FB_GROUPS_UGC_ADMIN_TESTING:3211280,FB_GROUPS_UGC_INTRO_POST:3211281,FB_GROUPS_UGC_QP:3211282,FB_GROUPS_UGC_DEEP_DIVE_GET_ANSWER_PILL:3211283,FB_GROUPS_UGC_DEEP_DIVE_PILL:3211284,FB_GROUPS_UGC_FAB:3211285,FB_GROUPS_UGC_REMINDER_NOTIF:3211286,FB_GROUPS_UGC_COMMENT_RESPONSE_UPSELL:3211287,FB_GROUPS_UGC_CONTEXTUAL_PROFILE:3211288,FB_GROUPS_UGC_DEEP_DIVE_ASK_SOMETHING_ELSE:3211289,FB_GROUPS_UGC_CONTEXTUAL_CARD_ASK_SOMETHING_ELSE:3211290,DEVICES:3276800,DEVICES_STELLA:3276801,FB_WELLBEING:3342336,FB_WELLBEING_INCALL_UNBLOCKING_NOTIFICATION:3342337,MESSENGER_DEEP_LINKING:3407872,READ_ONLY_CUTOVER_THREAD:3473408,READ_ONLY_CUTOVER_THREAD_ARMADILLO_THREAD:3473409,READ_ONLY_CUTOVER_THREAD_THREAD_DETAIL:3473410,ARMADILLO_THREAD:3538944,ARMADILLO_THREAD_READ_ONLY_CUTOVER_THREAD:3538945,ARMADILLO_THREAD_EXTERNAL_LINK:3538946,FB_SHORTS:3604480,FB_SHORTS_PROFILE:3604481,FB_SHORTS_REACTORS_LIST_MESSAGE_BUTTON:3604482,FB_SHORTS_REACTIONS_OVERLAY:3604483,SEND_PLUGIN:3670016,SEND_AS_MESSAGE_FROM_NT:3735552,MESSENGER_PUBLIC_CHATS_MESSAGING:3801088,MESSENGER_GROWTH:3866624,MESSENGER_GROWTH_NOTIFICATIONS_ENTRYPOINT:3866625,MESSENGER_GROWTH_MESSAGE_REQUEST_JEWEL:3866626,MESSENGER_GROWTH_FRIENDLY_FEED_ACTIVE_NOW:3866627,FRIENDS_HOME:3932160,FRIENDS_HOME_ACTIVE_NOW:3932161,FRIENDS_HOME_MESSAGE_NEW_FRIENDS:3932162,FRIENDS_HOME_POST_ACCEPT_MESSAGING:3932163,FRIENDS_HOME_SENDER_POST_ACCEPT_WAVE:3932164,EXTERNAL_LINK_XMA:3997696,EXTERNAL_LINK_XMA_FROM_COMPOSER:3997697,EXTERNAL_LINK_XMA_FROM_DEEP_LINKING:3997698,EXTERNAL_LINK_XMA_FROM_SHARE_EXTENSION:3997699,FB_NOTIFICATIONS:4063232,QUICK_PROMOTION:4128768,QUICK_PROMOTION_CTA:4128769,QUICK_PROMOTION_INTERSTITIAL:4128770,QUICK_PROMOTION_TOP_BANNER:4128771,FBM_IN_APP_NOTIFS:4194304,CREATOR_SUPPORT:4259840,CREATOR_SUPPORT_MESSENGER_TOAST:4259841,FB_INSTANT_GAME:4325376,COMMUNITY_CHATS_IN_FEED:4390912,COMMUNITY_CHATS_IN_FEED_PERMALINK:4390913,UNIFIED_BUSINESS_INBOX:4456448,ROLLCALL:4521984,HIGHLIGHTS_TAB:4587520,HIGHLIGHTS_TAB_FEED_INLINE:4587521,HIGHLIGHTS_TAB_MEDIA_VIEWER:4587522,HIGHLIGHTS_TAB_THREAD_VIEW:4587523,HIGHLIGHTS_TAB_FEED_INLINE_CONNECTED_CHAT:4587524,HIGHLIGHTS_TAB_FEED_INLINE_LOCAL_EVENT:4587525,HIGHLIGHTS_TAB_FEED_INLINE_FRIENDS_UPDATE:4587526,HIGHLIGHTS_TAB_FEED_INLINE_BIRTHDAY:4587527,HIGHLIGHTS_TAB_MEDIA_VIEWER_CONNECTED_CHAT:4587528,HIGHLIGHTS_TAB_MEDIA_VIEWER_FRIENDS_UPDATE:4587529,HIGHLIGHTS_TAB_THREAD_VIEW_CONNECTED_CHAT:4587530,HIGHLIGHTS_TAB_THREAD_VIEW_LOCAL_EVENT:4587531,HIGHLIGHTS_TAB_THREAD_VIEW_FRIENDS_UPDATE:4587532,HIGHLIGHTS_TAB_THREAD_VIEW_BIRTHDAY:4587533,HIGHLIGHTS_TAB_THREAD_VIEW_NOTE:4587534,HIGHLIGHTS_TAB_FEED_INLINE_NOTE:4587535,HIGHLIGHTS_TAB_CONNECTED_BROADCAST_CHANNEL_SHARE_SHEET:4587536,HIGHLIGHTS_TAB_SMART_REPLY_DRAWER_BIRTHDAY:4587537,HIGHLIGHTS_TAB_SHARE_SHEET_HOLIDAY_CARD:4587538,HIGHLIGHTS_TAB_META_AI_BIRTHDAY:4587539,HIGHLIGHTS_TAB_QUICK_REACT_CONNECTED_CHAT:4587540,HIGHLIGHTS_TAB_QUICK_REACT_LOCAL_EVENT:4587541,HIGHLIGHTS_TAB_QUICK_REACT_FRIENDS_UPDATE:4587542,HIGHLIGHTS_TAB_QUICK_REACT_BIRTHDAY:4587543,HIGHLIGHTS_TAB_QUICK_REACT_STORIES:4587544,HIGHLIGHTS_TAB_QUICK_REACT_NOTE:4587545,HIGHLIGHTS_TAB_QUICK_REACT_LIFE_EVENT:4587546,HIGHLIGHTS_TAB_META_AI_FAB:4587547,HIGHLIGHTS_TAB_FEED_INLINE_CHAT_WITH_FRIENDS:4587548,HIGHLIGHTS_TAB_THREAD_VIEW_CHAT_WITH_FRIENDS:4587549,HIGHLIGHTS_TAB_SMART_REPLY_DRAWER_LOCAL_EVENT:4587550,HIGHLIGHTS_TAB_SMART_REPLY_DRAWER_FRIENDS_UPDATE:4587551,HIGHLIGHTS_TAB_SMART_REPLY_DRAWER_NOTE:4587552,HIGHLIGHTS_TAB_SMART_REPLY_DRAWER_CHAT_WITH_FRIENDS:4587553,HIGHLIGHTS_TAB_FB_POST_MEMORIES_SHARE_SHEET:4587554,HIGHLIGHTS_TAB_FEED_INLINE_FB_POST_MEMORIES:4587555,HIGHLIGHTS_TAB_THREAD_VIEW_FB_POST_MEMORIES:4587556,HIGHLIGHTS_TAB_QUICK_REACT_FB_POST_MEMORIES:4587557,HIGHLIGHTS_TAB_SMART_REPLY_DRAWER_FB_POST_MEMORIES:4587558,MARKETPLACE_INBOX:4653056,ONE_TAP_MESSAGE_QUICK_SHARE:4718592,HIGHLIGHTS_TAB_STORIES_TRAY:4784128,FB_BIRTHDAY_CENTER:4849664,MESSENGER_SIRIKIT:4915200,MESSENGER_SIRIKIT_CALLKIT_QUICK_REPLY:4915201,MESSENGER_SIRIKIT_VOICE_COMMAND:4915202,CLICK_TO_SUBSCRIBE_AD:4980736,HIGHLIGHTS_TAB_SMART_REPLY_DRAWER:5046272,FB_UNIVERSAL_SEARCH:5111808,FB_UNIVERSAL_SEARCH_NULL_STATE_SUGGESTED:5111809,FB_UNIVERSAL_SEARCH_NULL_STATE_RECENT:5111810,FB_UNIVERSAL_SEARCH_QUERY_RESULTS:5111811,FBLITE_MESSAGING:5177344,FBLITE_MESSAGING_FROM_EXTERNAL:5177345,FBLITE_MESSAGING_FORWARD_FROM_BROADCAST_FLOW:5177346,FBLITE_MESSAGING_IN_THREAD:5177349,FBLITE_MESSAGING_ACTIVE_NOW:5177352,FBLITE_MESSAGING_ARCHIVED_CHATS:5177353,FBLITE_MESSAGING_SPAM:5177354,FBLITE_MESSAGING_MESSAGE_REQUESTS:5177355,FBLITE_MESSAGING_MARKETPLACE:5177356,FBLITE_MESSAGING_THREAD_MEMBERS_LIST:5177357,FBLITE_MESSAGING_READONLY_VERSION_OF_CUTOVER_THREAD:5177358,FBLITE_MESSAGING_QP:5177359,FBLITE_MESSAGING_META_AI_PROFILE_SHARE:5177360,FBLITE_MESSAGING_IMAGE_VIEWER_REPLY_COMPOSER:5177361,FBLITE_MESSAGING_META_AI_BOOKMARK:5177362,FBLITE_MESSAGING_NOTIFICATION:5242880,FBLITE_MESSAGING_NOTIFICATION_IN_THREAD_REPLY:5242881,FBLITE_MESSAGING_NOTIFICATION_DIRECT_REPLY:5242882,FBLITE_MESSAGING_NOTIFICATION_REPLY_REMINDER_NOTIFICATION:5242883,FBLITE_INBOX:5308416,FBLITE_INBOX_UNIVERSAL_SEARCH:5308417,FBLITE_INBOX_PEOPLE_PICKER:5308418,FBLITE_INBOX_RECENT_THREADS:5308419,FBLITE_INBOX_REMAINING_THREADS:5308420,FBLITE_INBOX_INBOX_FOLLOWUP:5308421,FBLITE_INBOX_THREAD_WITH_DRAFT_MESSAGE:5308422,FBLITE_INBOX_META_AI_FAB:5308423,SHARED_ALBUM:5373952,QUICK_REPLIES:5439488,QUICK_REPLIES_TRAY:5439489,MESSENGER_CTA_AFTER_CALL_ENDS:5505024,MESSENGER_CONVERSATION_SHORTCUT:5570560,CC_ADMIN_SEND_MESSAGE_HINT_CARD:5636096,CC_MEMBER_SEND_MESSAGE_HINT_CARD:5701632,MSGR_AVATAR_DETAILS:5767168,PRIVATE_SHARING_FORWARD_SUPER_SHARE_SHEET:5832704,MEMORIES:5898240,META_AI_TAB:5963776,MEMORIES_NOTIFICATION:6029312,MEMORIES_QUICK_PROMOTION:6094848,MEMORIES_HIGHLIGHTS_TAB:6160384,MEMORIES_LIST:6225920,MSGR_PYMK_LIST_SCREEN:6291456,INSTAGRAM_WEB_SENDS:6356992,AI_SUGGESTED_PROMPT_TRAY:6422528,AI_SUGGESTED_PROMPT_ICEBREAKER:6488064,COMMUNITY_INVITE:6553600,COMMUNITY_CHAT_INVITE:6619136,AI_DISCOVERY_BOTTOM_SHEET:6684672,IN_THREAD_INVITE_MODEL:6750208,SUPPORT_FOLDER:6815744,MARKETPLACE_PDP:6881280,QR_CODE:6946816,WRITE_WITH_AI:7012352,AI_HOME_CHAT_WITH_AI:7077888,AI_HOME_INBOX_QP:7143424,AI_AGENT_MESSAGE_SHARE:7208960,AI_HOME_FROM_THREAD:7274496,AI_HOME_FROM_THREAD_DETAIL:7274497,AI_HOME_FROM_THREAD_HEADER:7274498,AI_HOME_FROM_THREAD_META_AI_THREAD_DETAIL:7274499,AI_HOME_FROM_THREAD_META_AI_THREAD_HEADER:7274500,AI_HOME_FROM_FOLDER_LIST:7340032,AI_HOME_FROM_FB_BOOKMARK:7405568,FB_FANDOM:7471104,AI_HOME_INBOX_RETENTION_QP:7536640,MEMORIES_INBOX_TRAY:7602176,MESSENGER_VOICEMAIL:7667712,AI_UGC_FB_FEED_QP:7733248,MESSENGER_INBOX_IP_QP:7798784,COMMUNITY_GROUP_CHAT_UPGRADES_INVITE:7864320,MESSENGER_SECRET_CONVERSATIONS:7929856,MESSENGER_SECRET_CONVERSATIONS_SECRET_CONVERSATIONS_FOLDER:7929857,CROSS_CUSTOMER_SUPPORT:7995392,CROSS_CUSTOMER_SUPPORT_FB_HELP_CENTER_META_AI_CARD:7995393,AI_LOOKUP:8060928,PINNED_MESSAGES_THREAD_DETAILS:8126464,CM_MEMBER_REPORTS_BLOKS:8192e3,MEMORIES_TEMPLATE:8257536,FB_TREP_UGC_CREATION:8323072,MESSENGER_STORIES_TAB:8388608,MESSENGER_STORIES_TAB_META_AI_FAB:8388609,META_AI_ENTITY_DETECTION:8454144,AI_HOME_FROM_AI_STUDIO_TAB:8519680,QR_CODE_LINK:8585216,META_AI_PROMPT_SHEET:8650752,UGC_BOT_IMMERSIVE_THREAD:8716288,UGC_BOT_IMMERSIVE_THREAD_AI_STUDIO_TAB:8716289,UGC_BOT_IMMERSIVE_THREAD_INBOX:8716290,UGC_BOT_IMMERSIVE_THREAD_AI_HOME:8716291,IGD_WEB_CHAT_TAB:8781824,IGD_WEB_CHAT_TAB_IN_THREAD:8781825,IGD_WEB_CHAT_TAB_NOTIFICATION:8781826,FB_PYMK_FEED_MESSAGE_BUTTON:8847360,MSGR_UGC_IMMERSIVE_THREAD:8912896,MSGR_UGC_IMMERSIVE_THREAD_AI_STUDIO_TAB:8912897,MSGR_UGC_IMMERSIVE_THREAD_LEFT_NAV_AI_STUDIO_TAB:8912898,MSGR_UGC_IMMERSIVE_THREAD_MORE_MENU_AI_STUDIO_TAB:8912899,MSGR_UGC_IMMERSIVE_THREAD_AI_STUDIO_TAB_AI_HOME:8912900,MSGR_UGC_IMMERSIVE_THREAD_COMPOSER_AI_HOME:8912901,MSGR_UGC_IMMERSIVE_THREAD_INBOX:8912902,MSGR_UGC_IMMERSIVE_THREAD_ACTIVE_NOW:8912903,MSGR_UGC_IMMERSIVE_THREAD_META_AI_HEADER_AI_HOME:8912904,MSGR_UGC_IMMERSIVE_THREAD_UGC_HEADER_AI_HOME:8912905,MSGR_UGC_IMMERSIVE_THREAD_THREAD_DETAIL_AI_HOME:8912906,MSGR_UGC_IMMERSIVE_THREAD_META_AI_THREAD_DETAIL_AI_HOME:8912907,MSGR_UGC_IMMERSIVE_THREAD_DEEPLINK:8912908,MSGR_UGC_IMMERSIVE_THREAD_NOTIFICATION:8912909,MSGR_UGC_IMMERSIVE_THREAD_AI_CREATION:8912910,MSGR_UGC_IMMERSIVE_THREAD_LEFT_NAV_AI_STUDIO_TAB_AI_HOME:8912911,MSGR_UGC_IMMERSIVE_THREAD_MORE_MENU_AI_STUDIO_TAB_AI_HOME:8912912,AI_THREAD_FROM_FF_THREAD:8978432,AI_THREAD_FROM_FF_THREAD_FF_THREAD_VIEW_META_AI_TASK:8978433,AI_THREAD_FROM_FF_THREAD_META_AI_SIDECHAT:8978434,AI_THREAD_FROM_FF_THREAD_SIDECHAT_RIGHT_SWIPE:8978435,AI_THREAD_FROM_FF_THREAD_SIDECHAT_RIGHT_SWIPE_SUMMARY:8978436,PHONE_NUMBER_MESSAGES:9043968,FUNDRAISER_SUPPORTERS_LIST:9109504,META_AI_SUMMARY:9175040,META_AI_SUMMARY_IN_THREAD:9175041,MESSENGER_NOTES:9240576,MESSENGER_NOTES_SELF_CONSUMPTION_DETAILS_LIST:9240577,MESSENGER_NOTES_NOTE_PROMPT_CONSUMPTION:9240578,MESSENGER_NOTES_NOTE_PROMPT_RESPONSE_CONSUMPTION:9240579,POKES_PLUS:9306112,POKES_PLUS_POKE_PLUS_DASHBOARD:9306113,STORIES_ATTRIBUTION:9371648,STORIES_ATTRIBUTION_STACKED_STORIES:9371649,ARMADILLO_CUTOVER_THREAD_BANNER:9437184,DMA_MSPLIT_FALLBACK_THREAD_NAVIGATION:9502720,MESSENGER_MENU:9568256,MESSENGER_MENU_META_AI_FAB:9568257,MESSENGER_MESSAGE_REQUEST:9633792,MESSENGER_MESSAGE_REQUEST_META_AI_FAB:9633793,MESSENGER_ARCHIVED:9699328,MESSENGER_ARCHIVED_META_AI_FAB:9699329,MESSENGER_FB_GROUPS:9764864,MESSENGER_FB_GROUPS_META_AI_FAB:9764865,MESSENGER_PEOPLE_TAB:9830400,MESSENGER_PEOPLE_TAB_ACTIVE_NOW:9830401,MESSENGER_PEOPLE_TAB_CONTACT_LIST:9830402,MESSENGER_PEOPLE_TAB_CURRENT_CITY:9830403,MESSENGER_PEOPLE_TAB_EDUCATION:9830404,MESSENGER_PEOPLE_TAB_HOMETOWN:9830405,MESSENGER_PEOPLE_TAB_WORK:9830406,MARKETPLACE_TAB_ASSISTANT_BOT:9895936,UGC_PROFILE:9961472,UGC_PROFILE_FB_FEED_BOTTOM_ATTACHMENT:9961473,FB_TOP_OF_FRIENDLY_FEED:10027008,FB_TOP_OF_FRIENDLY_FEED_CONVERSATION_SPARK_REPLY:10027009,FB_TOP_OF_FRIENDLY_FEED_STORIES_VIEWER_CONSUMER_REPLY:10027010,MESSENGER_FB_QUICKSNAP:10092544,MSGR_META_AI_DEP_IN_THREAD:10158080,FB_GAMING_TAB:10223616,FB_GAMING_TAB_INVITE_FRIENDS_WORLD_GAME_LIST_SHARE_BUTTON:10223617,FB_GAMING_TAB_HORIZON_WORLD_INVITE_FRIENDS:10223618,FB_GAMING_TAB_HORIZON_WORLD_INVITE_FRIENDS_WITH_REWARDS:10223619,VOICEMAIL_MESSAGE:10289152,GEMSTONE:10354688,GEMSTONE_MESSAGE_INBOX:10354689,GEMSTONE_MESSAGE_NOTIFICATION:10354690,GLIMPSE_PROFILE_PREVIEW:10420224,CRISIS_RESPONSE:10485760});i.default=e}),66);
__d("LSQplMarkEnd.nop",["EBMarkerIdToQPLEvent","Promise","QPLUserFlow","WAHashStringToNumber","nullthrows"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(a,i,l,s,u){try{var t=r("nullthrows")(o("EBMarkerIdToQPLEvent").markerIdToQPLEvent(l)),c=o("WAHashStringToNumber").hashStringToNumber(s);return u?r("QPLUserFlow").endSuccess(t,{instanceKey:c}):r("QPLUserFlow").endFailure(t,"failure",{instanceKey:c}),(e||(e=n("Promise"))).resolve()}catch(t){return(e||(e=n("Promise"))).resolve()}};s.__nop_name__="LSQplMarkEnd",l.default=s}),98);
__d("LSRemoveBlindedTokens",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(n){return t.forEach(t.filter(t.db.table(308).fetch(),function(t){return t.configId===e[0]}),function(e){return e.delete()})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSAnonymousCredentialsRemoveBlindedTokensStoredProcedure",e.__tables__=["secure_acs_blinded_tokens"],a.exports=e}),null);
__d("MAWAppVersion",["SiteData"],(function(t,n,r,o,a,i,l){"use strict";function e(){return"302.0."+r("SiteData").client_revision}function s(){return{primary:302,secondary:0,tertiary:r("SiteData").client_revision}}l.getVersionNumber=e,l.getAppVersionParts=s}),98);
__d("MAWReliabilityMonitor",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["PENDING","OK","ERROR","UNKNOWN"]),l=(function(){function e(){this.$1=new Map,this.$2=new Map,this.$3=[]}var t=e.prototype;return t.startMonitoring=function(t,n){var e=new u(t,n,this);return this.$1.set(t,e),this.recordReport(e),e},t.stopMonitoring=function(t){this.$1.delete(t.identifier),this.$2.delete(t.identifier)},t.recordReport=function(t){this.$2.set(t.identifier,babelHelpers.extends({},t.selfAssessmentFn(),{identifier:t.identifier,timestamp:Date.now()})),this.$4()},t.onAggregatedReportChange=function(t){this.$3.push(t)},t.$4=function(){var e=this.getAggregatedReportEntity();this.$3.forEach(function(t){return t(e)})},t.getAggregatedReportEntity=function(){return new s(this.$2)},t.triggerAllSelfAssessments=function(){var e=this;this.$1.forEach(function(t){e.recordReport(t)})},t.getAggregatedReport=function(){return this.triggerAllSelfAssessments(),this.$2},t.TEST_ONLY_reset=function(){this.$1.clear(),this.$2.clear(),this.$3=[]},e})(),s=(function(){function e(e){this.$1=e}var t=e.prototype;return t.toAckPayloadFormat=function(){return Array.from(this.$1.values())},t.toString=function(){var e=Object.fromEntries(this.$1);return JSON.stringify(e)},e})(),u=(function(){function e(e,t,n){this.identifier=e,this.selfAssessmentFn=t,this.$1=n}var t=e.prototype;return t.stopMonitoring=function(){this.$1.stopMonitoring(this)},t.updateState=function(){this.$1.recordReport(this)},e})(),c=new l;i.HealthReportState=e,i.ReliabilityAggregatedReport=s,i.ReportableModule=u,i.MAWReliabilityMonitorSingleton=c}),66);
__d("MAWSetupWorkerAuxStateForLogging",["nullthrows"],(function(t,n,r,o,a,i,l){"use strict";var e=[],s=3,u={getWorkerAge:function(){if(u.workerStartTime!=null)return Math.floor((Date.now()-r("nullthrows")(u.workerStartTime))/1e3)},restartMessageTypes:[],restartReasons:[],workerStartTime:null,workerTerminatedPermanently:!1};function c(){u.workerStartTime=Date.now()}function d(t){e.push(t),e.length>s&&e.shift()}function m(){return e.join(",")}l.HEART_BEAT_HISTORY=e,l.WorkerLifeCycleState=u,l.resetWorkerCreationTime=c,l.addWorkerHeartbeatToHistory=d,l.getHeartbeatHistoryAsString=m}),98);
__d("MAWTrackPendingOccamadilloThreads",["Deferred","LSDatabaseSingleton","LSInitSyncCompleteSubscription","LSIntEnum","LSPlatformLsInitLog","MAWMIC","MAWMICSchema","QuickPerformanceLogger","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=(e={},e[o("MAWMICSchema").ANNOTATIONS.occamadilloBatchesSentToWorker]=0,e[o("MAWMICSchema").ANNOTATIONS.occamadilloPendingThreadsAfterInitSync]=0,e[o("MAWMICSchema").ANNOTATIONS.occamadilloDuplicateThreads]=0,e);(function(){Object.keys(d).forEach(function(e){o("MAWMIC").addIntAnnotation(e,0)})})();function m(e){o("MAWMIC").addIntAnnotation(e,++d[e])}function p(){return d.occamadilloBatchesSentToWorker}var _=new(r("Deferred")),f=new Set,g=new Set,h=new Set,y=new Set;function C(e){var t=e.callingSource;y.add((c||(c=o("LSIntEnum"))).toNumber(t)),o("MAWMIC").addIntArrayAnnotation(o("MAWMICSchema").ANNOTATIONS.occamadilloCallingSources,Array.from(y))}var b=null;function v(e){if(o("MAWMIC").addPoint(o("MAWMICSchema").POINTS.thread_mapping_start),f.has(e)){m(o("MAWMICSchema").ANNOTATIONS.occamadilloDuplicateThreads);return}g.add(e),o("LSPlatformLsInitLog").LsSync.isRunning()&&h.add(e),b=(s||(s=r("QuickPerformanceLogger"))).currentTimestamp(),f.add(e),o("MAWMIC").addIntAnnotation("occamadilloThreadCount",f.size),o("LSPlatformLsInitLog").LsSync.hasEnded()&&m(o("MAWMICSchema").ANNOTATIONS.occamadilloPendingThreadsAfterInitSync)}function S(){o("MAWMIC").addBoolAnnotation("threadMappingAcked",!0)}function R(e){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(r("gkx")("2661"))yield _.getPromise();else{var t=yield(u||(u=o("LSDatabaseSingleton"))).LSDatabaseSingleton;yield o("LSInitSyncCompleteSubscription").maybeWaitForSyncGroup(t,(c||(c=o("LSIntEnum"))).ofNumber(95))}g.delete(e),h.delete(e),o("MAWMIC").addIntAnnotation("occamadilloCompleteThreadCount",f.size-g.size),k()}),L.apply(this,arguments)}function E(){_.resolve(),k()}function k(){if(o("MAWMIC").addIntAnnotation("occamadilloThreadCount",f.size),o("LSPlatformLsInitLog").LsSync.hasEnded()&&h.size===0){o("MAWMIC").addPoint(o("MAWMICSchema").POINTS.thread_mapping_end);return}g.size===0&&o("MAWMIC").addPoint(o("MAWMICSchema").POINTS.thread_mapping_end)}l.incrementCounter=m,l.getBatchesSentNumber=p,l.markThreadPassedToNativeOp=C,l.addPendingThread=v,l.markBridgeCallAcked=S,l.removePendingThread=R,l.completeSync=E,l.maybeEndOccamadilloThreadMapping=k}),98);
__d("MAWInitError",[],(function(t,n,r,o,a,i){"use strict";var e=(function(e){function t(t,n){var r;return r=e.call(this,t)||this,r.error=void 0,r.name="MAWInitError",r.message=t,r.error=n,r}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));i.MAWInitError=e}),66);
__d("MAWInit",["MAWCurrentUser","MAWInitError","MAWMIC","MWQPLJoinId","MultipleTabsLogger","QPLUserFlow","QuickPerformanceLogger","WAGetStorageQplAnnotations","asyncToGeneratorRuntime","gkx","qpl","shouldUseMAWSharedWorker"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("qpl")._(25310776,"6155"),u=!1,c=[],d=[],m=!1;function p(){m||(m=!0,r("QPLUserFlow").addAnnotations(s,{bool:{armadillo_init_sync_api_improvements:r("gkx")("24025"),isArmadilloPublicLaunchUser:r("gkx")("23405"),isTlcPublicUser:o("MAWCurrentUser").isTlcPublicUser(),useSharedWorker:o("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()}}))}var _=!1,f=function(){return document.visibilityState!==void 0?document.visibilityState==="hidden":document.hidden},g=function(){y("visibility_change_"+(f()?"hidden":"visible"))};function h(){_||(o("MAWMIC").addPoint("maw_init_start"),_=!0,r("QPLUserFlow").start(s,babelHelpers.extends({annotations:{bool:{initiallyHidden:f()},string:{hostname:window.location.hostname}},cancelOnUnload:!0},o("MWQPLJoinId").allowJoinId?{joinOptions:{joinId:o("MWQPLJoinId").MWQPLJoinId}}:{})),r("QPLUserFlow").addAlignmentPointForJoin(s,0,{requestId:o("MWQPLJoinId").MWQPLJoinId}),o("MultipleTabsLogger").addAnnotationToQPLEvent(s),o("WAGetStorageQplAnnotations").getStorageQplAnnotations().then(function(e){r("QPLUserFlow").addAnnotations(s,e)}),p(),document.addEventListener("visibilitychange",g),c.forEach(function(e){return e()}),d.forEach(function(e){return e()}),c.splice(0,c.length),d.splice(0,d.length))}function y(t,n){if(!_||u){if(!_&&n!=null&&n.allowEarlyLogPoints){var o=(e||(e=r("QuickPerformanceLogger"))).currentTimestamp();d.push(function(){r("QPLUserFlow").addPoint(s,t,{timestamp:o})})}return}p(),r("QPLUserFlow").addPoint(s,t)}function C(e,t,n){var o;if(!_||u){!_&&n!=null&&n.allowEarlyAnnotations&&c.push(function(){var n;r("QPLUserFlow").addAnnotations(s,{bool:(n={},n[e]=t,n)})});return}r("QPLUserFlow").addAnnotations(s,{bool:(o={},o[e]=t,o)})}function b(e,t,n){var o;if(!_||u){!_&&n!=null&&n.allowEarlyAnnotations&&c.push(function(){var n;r("QPLUserFlow").addAnnotations(s,{string:(n={},n[e]=t,n)})});return}r("QPLUserFlow").addAnnotations(s,{string:(o={},o[e]=t,o)})}function v(e,t,n){var o;if(!_||u){!_&&n!=null&&n.allowEarlyAnnotations&&c.push(function(){var n;r("QPLUserFlow").addAnnotations(s,{string_array:(n={},n[e]=t,n)})});return}r("QPLUserFlow").addAnnotations(s,{string_array:(o={},o[e]=t,o)})}function S(e,t,n){var o;if(!_||u){!_&&n!=null&&n.allowEarlyAnnotations&&c.push(function(){var n;r("QPLUserFlow").addAnnotations(s,{int:(n={},n[e]=t,n)})});return}r("QPLUserFlow").addAnnotations(s,{int:(o={},o[e]=t,o)})}function R(){p(),u=!0,m=!1,document.removeEventListener("visibilitychange",g)}function L(e,t){R();var n=t instanceof o("MAWInitError").MAWInitError&&t.error?t.error:t;r("QPLUserFlow").addAnnotations(s,{string:{errorDescription:n==null?void 0:n.message}}),r("QPLUserFlow").endFailure(s,e,{error:n}),o("MAWMIC").fail(e,n)}function E(e,t){R(),r("QPLUserFlow").addAnnotations(s,{string:{cancelReason:e}}),t&&r("QPLUserFlow").markError(s,"maw_init_cancel_with_error",{error:t}),r("QPLUserFlow").endCancel(s),o("MAWMIC").addStringAnnotation("mawInitCancelReason",e),o("MAWMIC").cancel("maw_init_cancel",t),r("QPLUserFlow").addAnnotations(r("qpl")._(29818881,"6702"),{string:{maw_cancel_reason:e,maw_error_message:t==null?void 0:t.message}})}function k(t){u||(R(),o("MAWMIC").addStringAnnotation("mawInitDropReason",t),(e||(e=r("QuickPerformanceLogger"))).markerDrop(s))}function I(){R(),r("QPLUserFlow").endSuccess(s),o("MAWMIC").addPoint("maw_init_end")}function T(e,t){return D.apply(this,arguments)}function D(){return D=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=e+"_start",r=e+"_end";y(n);var o=yield t();return y(r),o}),D.apply(this,arguments)}var x={isCompleted:function(){return u}},$={addBoolAnnotation:C,addIntAnnotation:S,addStringAnnotation:b,addStringArrayAnnotation:v,cancel:E,drop:k,endSuccess:I,fail:L,logPoint:y,measurePerformance:T,start:h};l.MAWInitState=x,l.MAWInit=$}),98);
__d("MAWStartupLoggingUtils",["FBLogger","MAWInit","MAWMIC","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){var a,i=(a=t==null?void 0:t.message)!=null?a:"";i.indexOf("Failed to execute 'importScripts'")>=0?o("MAWInit").MAWInit.fail("import_scripts_failure",r("getErrorSafe")(t)):o("MAWInit").MAWInit.fail("worker_error",r("getErrorSafe")(t)),r("FBLogger")("messenger_web").mustfix("[MAWWebWorkerSingletonAsync: "+e+"]: %s:%s:%s:%s:%s:%s:%s",JSON.stringify(t==null?void 0:t.message),t==null?void 0:t.lineno,t==null?void 0:t.colno,t==null?void 0:t.filename,JSON.stringify(t,window.Object.getOwnPropertyNames(t)),t==null?void 0:t.name,n)}function s(e){var t=function(o){var n=o==null?void 0:o.data;if(typeof n=="object")if((n==null?void 0:n.type)==="importScripts_error"){var a,i,l,s,u,c;e.removeEventListener("message",t);var d=r("FBLogger")("messenger_web");d=d.addMetadata("FBLOGGER","ERROR_STACK",(a=typeof(n==null?void 0:n.stack)=="string"?n==null?void 0:n.stack:JSON.stringify(n==null?void 0:n.stack))!=null?a:"no_stack");var m=n!=null?n:{},p=m.error_code,_=m.error_msg,f=m.error_name,g=m.source,h=(i=n==null?void 0:n.perfEntry)!=null?i:{},y=h.duration,C=h.encodedBodySize,b=h.responseStatus,v=h.transferSize;d.mustfix("[MAWWebWorkerSingletonAsync Script Import Error Details]: %s:%s:%s || errCode:%s || respStatus:%s || encBodySize:%s || duration:%s || transferSize:%s",g!=null&&JSON.stringify(g)||"no_source",f!=null&&JSON.stringify(f)||"no_name",_!=null&&JSON.stringify(_)||"no_msg",p!=null&&JSON.stringify(p)||"none",(l=JSON.stringify(b))!=null?l:"none",(s=JSON.stringify(C))!=null?s:"none",(u=JSON.stringify(y))!=null?u:"none",(c=JSON.stringify(v))!=null?c:"none")}else(n==null?void 0:n.type)==="importScripts_success"&&e.removeEventListener("message",t)};e.addEventListener("message",t)}var u=new Set(["worker_connection_established","worker_init_point_hsdp_end","worker_init_point_hblp_end","get_worker_rev_ack_received","old_worker_shutdown_end","old_worker_shutdown_start"]);function c(e){var t=e.data.annotations;if(t!=null){var n={allowEarlyAnnotations:!0};Object.keys(t).forEach(function(e){var r,a=(r=t[e])!=null?r:{};Object.entries(a).forEach(function(t){var r=t[0],a=t[1],i="workerInit"+r.charAt(0).toUpperCase()+r.substring(1);e==="int"&&typeof a=="number"?(o("MAWInit").MAWInit.addIntAnnotation(i,a,n),o("MAWMIC").addIntAnnotation(i,a)):e==="string"&&typeof a=="string"?(o("MAWInit").MAWInit.addStringAnnotation(i,a,n),o("MAWMIC").addStringAnnotation(i,a)):e==="bool"&&typeof a=="boolean"&&(o("MAWInit").MAWInit.addBoolAnnotation(i,a,n),o("MAWMIC").addBoolAnnotation(i,a))})})}var r={allowEarlyLogPoints:!0};if(e.type==="point"){if(u.has(e.data.event)){var a="worker_"+e.data.event;o("MAWInit").MAWInit.logPoint(a,r),o("MAWMIC").addPoint(a)}}else e.type==="end"&&(e.data.cancel===!0?o("MAWInit").MAWInit.logPoint("worker_creation_cancel",r):e.data.errorName!=null&&(o("MAWInit").MAWInit.addStringAnnotation("errorDescription",e.data.errorName,{allowEarlyAnnotations:!0}),o("MAWInit").MAWInit.logPoint("worker_creation_fail",r)))}l.logWorkerError=e,l.setImportScriptsErrorListener=s,l.logSharedWorkerQPLEvents=c}),98);
__d("MAWWorkerWatchdogRecovery",[],(function(t,n,r,o,a,i){"use strict";var e=null;function l(t){e=t}function s(){return e}i.setRecoveryForWatchdog=l,i.getWorkerRecoveryForWatchdog=s}),66);
__d("SharedWorkerDevChangeManager",["gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=!1,s=new Set;function u(e,t){var n=t.storageWorkerResource,r=t.tabResource;return!0}function c(e){return!1}function d(e){}l.shouldUseStorageWorkerForDev=u,l.shouldUpgradeWorkerForDevExperimental=c,l.trackCreatedWorker=d}),98);
__d("SharedWorkerEventManager",["FBLogger"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n=function(n){var e,o,a;if(typeof n.data=="object"&&((e=n.data)==null?void 0:e.type)==="console"&&typeof((o=n.data)==null?void 0:o.response)=="object"&&((a=n.data)==null?void 0:a.response)!=null){var i=n.data.response,l=i.method,s=i.args;if(typeof l!="string"||!["log","error","info","debug","warn"].includes(l)){r("FBLogger")("worker").mustfix("Unexpected console method: %s",String(l));return}if(!Array.isArray(s)){r("FBLogger")("worker").mustfix('Expected console args "%s" to be an array',JSON.stringify(s));return}t({method:l,args:s})}},o=e.port;return o.addEventListener("message",n),function(){return o.removeEventListener("message",n)}}function s(e,t){var n=function(n){var e;if(typeof n.data=="object"&&((e=n.data)==null?void 0:e.type)==="sw-uncaught-error"){var r,o,a=typeof((r=n.data)==null?void 0:r.e)=="object"?(o=n.data.e)!=null?o:{}:{},i=a.error,l=a.lineno,s=a.colno,u=a.filename,c=a.message;t({error:i instanceof Error?i:null,errorObject:{lineno:typeof l=="number"?l:null,colno:typeof s=="number"?s:null,filename:typeof u=="string"?u:null,message:typeof c=="string"?c:null}})}},r=e.port;return r.addEventListener("message",n),function(){return r.removeEventListener("message",n)}}function u(e,t,n){var o=function(o){var e;if(typeof o.data=="object"&&((e=o.data)==null?void 0:e.type)==="sw-get-rev"&&typeof o.data.response=="object"){var a,i;t==null||t.markPoint("get_worker_rev_ack_received");var l=typeof o.data=="object"&&typeof((a=o.data)==null?void 0:a.response)=="object"?(i=o.data)==null?void 0:i.response:{},s=l==null?void 0:l.workerRevision,u=l==null?void 0:l.spinTime,c=l==null?void 0:l.workerChecksum;if(s==null||typeof s!="number"){t==null||t.addAnnotations({string:{malformedData:"rev is non-number"}}),r("FBLogger")("worker").mustfix("Expected worker rev to be non-null number, but instead received: %s",String(s));return}if(u==null||typeof u!="number"){t==null||t.addAnnotations({string:{malformedData:"spin_time is non-number"}}),r("FBLogger")("worker").mustfix("Expected worker spin time to be non-null number, but instead received: %s",String(u));return}n({rev:s,spinTime:u,workerChecksum:typeof c=="string"?c:void 0})}},a=e.port;return a.addEventListener("message",o),function(){return a.removeEventListener("message",o)}}function c(e,t,n){var r=function(a){var o;if(typeof a.data=="object"&&((o=a.data)==null?void 0:o.type)==="sw-shutdown"&&typeof a.data.response=="object"){var i,l,s,u,c,d,m=typeof((i=a.data.response)==null?void 0:i.reason)=="string"?(l=a.data.response)==null?void 0:l.reason:null,p=typeof((s=a.data.response)==null?void 0:s.workerID)=="string"?(u=a.data.response)==null?void 0:u.workerID:null,_=typeof((c=a.data.response)==null?void 0:c.isInitialized)=="boolean"?(d=a.data.response)==null?void 0:d.isInitialized:null;t({reason:m,workerID:p,isInitialized:_}),(n==null?void 0:n.once)===!0&&e.port.removeEventListener("message",r)}},o=e.port;return o.addEventListener("message",r),function(){return o.removeEventListener("message",r)}}function d(e,t){e.port.addEventListener("message",function(e){var n,r,o;typeof e.data=="object"&&((n=e.data)==null?void 0:n.type)==="sw-uptime-tracking"&&typeof((r=e.data)==null?void 0:r.response)=="object"&&typeof((o=e.data)==null||(o=o.response)==null?void 0:o.trackerID)=="number"&&t({trackerID:e.data.response.trackerID})})}function m(e,t,n){var o=function(o){var e,a;if(typeof o.data=="object"&&((e=o.data)==null?void 0:e.type)==="execute-worker-ack"&&typeof((a=o.data)==null?void 0:a.response)=="object"){var i,l,s,u=typeof o.data=="object"&&typeof((i=o.data)==null?void 0:i.response)=="object"?(l=(s=o.data)==null?void 0:s.response)!=null?l:{}:{},c=u.workerRevision,d=u.spinMode,m=u.spinTime,p=u.firstInit,_=u.errorGettingSiteData,f=u.error;if(typeof p!="boolean"){t==null||t.addAnnotations({string:{malformedData:"firstInit is non-boolean"}}),r("FBLogger")("worker").mustfix("Expected firstInit to be a boolean, but instead received: %s",String(p));return}var g=_!=null?_:f;if(typeof g=="string")return n({err:g,isFirstInit:p});if(typeof c=="number"&&typeof d=="number"&&typeof m=="number")return n({workerRev:c,workerSpinTime:m,workerSpinMode:d,isFirstInit:p});t==null||t.addAnnotations({string:{malformedData:"workerRevision, spinMode, and/or spinTime are non-numbers"}}),r("FBLogger")("worker").mustfix("Expected workerRevision, spinMode, and spinTime to be non-null number, but instead received: %s %s %s",String(c),String(d),String(m))}},a=e.port;return a.addEventListener("message",o),function(){return a.removeEventListener("message",o)}}function p(e,t,n,o){var a=function(l){var i,s;if(typeof l.data=="object"&&((i=l.data)==null?void 0:i.type)==="execute-worker-imports"&&typeof((s=l.data)==null?void 0:s.response)=="object"){var u,c,d;(o==null?void 0:o.once)===!0&&e.port.removeEventListener("message",a),t==null||t.markPoint("bundle_imports_ack");var m=typeof l.data=="object"&&typeof((u=l.data)==null?void 0:u.response)=="object"?(c=(d=l.data)==null?void 0:d.response)!=null?c:{}:{},p=m.err,_=m.attempts;if(p!=null&&typeof p!="string"){t==null||t.addAnnotations({string:{malformedData:"err is neither null or a string"}}),r("FBLogger")("worker").mustfix("Expected err to be null or a string, but instead receieved: %s",String(p));return}if(_!=null&&typeof _!="number"){t==null||t.addAnnotations({string:{malformedData:"attempts is neither null or a number"}}),r("FBLogger")("worker").mustfix("Expected attempts to be a number or null, but instead receieved: %s",String(_));return}n({err:p,attempts:_})}},i=e.port;return i.addEventListener("message",a),function(){return i.removeEventListener("message",a)}}function _(e,t,n){var o=function(o){var e;if(typeof o.data=="object"&&((e=o.data)==null?void 0:e.type)==="ww-hrp-init"){var a,i,l;t==null||t.markEventEnd("hrp_init");var s=typeof o.data=="object"&&typeof((a=o.data)==null?void 0:a.response)=="object"?(i=(l=o.data)==null?void 0:l.response)!=null?i:{}:{},u=s.err;if(u!=null&&typeof u!="string"){t==null||t.addAnnotations({string:{malformedData:"err is neither null or a string"}}),r("FBLogger")("worker").mustfix("Expected err to be null or a string, but instead receieved: %s",String(u));return}n({err:u})}},a=e.port;return a.addEventListener("message",o),function(){return a.removeEventListener("message",o)}}function f(e,t){var n=function(n){var e,r,o;if(typeof n.data=="object"&&((e=n.data)==null?void 0:e.type)==="worker-init-mark"&&typeof((r=n.data)==null?void 0:r.response)=="object"&&typeof((o=n.data)==null||(o=o.response)==null?void 0:o.point)=="string"){var a;t((a=n.data)==null||(a=a.response)==null?void 0:a.point)}},r=e.port;return r.addEventListener("message",n),function(){return r.removeEventListener("message",n)}}function g(e,t,n){var r=function(a){var o,i,l;if(typeof a.data=="object"&&((o=a.data)==null?void 0:o.type)==="self-terminate"&&typeof((i=a.data)==null?void 0:i.response)=="object"&&typeof((l=a.data)==null||(l=l.response)==null?void 0:l.from)=="string"){var s,u,c,d,m,p,_,f=(s=a.data)==null||(s=s.response)==null?void 0:s.from,g=typeof((u=a.data)==null||(u=u.response)==null?void 0:u.reason)=="string"?(c=a.data)==null||(c=c.response)==null?void 0:c.reason:"unknown",h=typeof((d=a.data)==null||(d=d.response)==null?void 0:d.workerID)=="string"?(m=a.data)==null||(m=m.response)==null?void 0:m.workerID:"unknown",y=typeof((p=a.data)==null||(p=p.response)==null?void 0:p.error)=="string"?(_=a.data)==null||(_=_.response)==null?void 0:_.error:void 0;(n==null?void 0:n.once)===!0&&e.port.removeEventListener("message",r),t(f,g,h,y)}},o=e.port;return o.addEventListener("message",r),function(){return o.removeEventListener("message",r)}}function h(e,t){var n=t!=null?t:{},r=n.reason,o=n.upgrade;e.port.postMessage({type:"sw-shutdown",args:[{reason:r,upgrade:o}]})}function y(e){e.port.postMessage({type:"sw-get-rev",args:[]})}function C(e,t){var n=t!=null?t:{},r=n.jsModuleResource,o=n.isDev;e.port.postMessage({type:"execute-worker",args:[r!=null?r:{},o]})}var b=["no-hrp","initialized","processed"];function v(e,t,n){var r=function(a){var o,i,l;if(typeof a.data=="object"&&((o=a.data)==null?void 0:o.type)==="connection-ack"&&typeof((i=a.data)==null?void 0:i.response)=="object"&&typeof((l=a.data)==null||(l=l.response)==null?void 0:l.from)=="string"){var s,u,c,d,m,p=typeof((s=a.data)==null||(s=s.response)==null?void 0:s.workerID)=="string"?(u=a.data)==null||(u=u.response)==null?void 0:u.workerID:void 0,_=typeof((c=a.data)==null||(c=c.response)==null?void 0:c.hrpStatus)=="string"?(d=a.data)==null||(d=d.response)==null?void 0:d.hrpStatus:void 0;t((m=a.data)==null||(m=m.response)==null?void 0:m.from,p,_!=null&&b.includes(_)?_:void 0),(n==null?void 0:n.once)===!0&&e.port.removeEventListener("message",r)}},o=e.port;return o.addEventListener("message",r),function(){return o.removeEventListener("message",r)}}function S(e,t){var n=function(n){t(n.data)},r=e.port;return r.addEventListener("message",n),function(){return r.removeEventListener("message",n)}}function R(e){e.port.postMessage({type:"ww-connection-ack"})}function L(e,t,n){var r=t.isDev,o=t.hrp,a=t.js_env;e.port.postMessage({type:"ww-hrp-init",hrp:o,is_dev:r,js_env:a,tiered:!0})}function E(e,t){var n=t.trackerID;e.port.postMessage({type:"sw-uptime-tracking",args:{trackerID:n}})}function k(t){var n=e(t,function(e){var t,n=e.args,r=e.method;(t=console)[r].apply(t,n)}),o=s(t,function(e){var t=e.error,n=e.errorObject;t!=null?r("FBLogger")("worker").catching(t).mustfix("Shared Worker uncaught error."):r("FBLogger")("worker").mustfix("Shared Worker uncaught error with no Error object. %s:%d:%d:%s",n.message,n.lineno,n.colno,n.filename)});return function(){n(),o()}}l.registerLogFowardingListener=e,l.registerUncaughtErrorForwardingListener=s,l.registerGetWorkerRevListener=u,l.registerWorkerShutdownListener=c,l.registerUptimeTrackerListener=d,l.registerExecuteWorkerAckListener=m,l.registerExecuteWorkerImportsListener=p,l.registerHrpInitListener=_,l.registerWorkerInitPointsListener=f,l.registerWorkerSelfTerminationListener=g,l.emitWorkerShutdown=h,l.emitGetRev=y,l.emitExecuteWorker=C,l.registerConnectionAckListener=v,l.registerAnyMessageListener=S,l.emitConnectionAckRequest=R,l.emitHrpInit=L,l.emitUptimeTracking=E,l.registerForwardListeners=k}),98);
__d("WebStorageLockManager",["FBLogger","LocalStorageWrapper","LockManager","Promise","Run","asyncToGeneratorRuntime","clearInterval","err","promiseDone","setInterval","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e){r("FBLogger")("messenger_web").mustfix(e)}function u(t,a){var i="Failed to execute 'request' on 'LockManager'",l="Lock broken by another request with the 'steal' option.",u=function(t,n,r){var e=t.get(n);if(e!=null)return e;var o=r();return t.set(n,o),o};try{var c=o("LocalStorageWrapper").getStorage(s),d=function(t,n){o("LocalStorageWrapper").setItemGuarded(c,t,n,s,a==null?void 0:a.onQuotaExceeded)},m=function(t){o("LocalStorageWrapper").removeItemGuarded(c,t,s)},p=function(t){return o("LocalStorageWrapper").getItemGuarded(c,t,s)},_=(function(){function t(e,t){this.lockName=e,this.tabId=t,this.lockA=this.lockName+"-a",this.lockB=this.lockName+"-b"}var o=t.prototype;return o.run=function(t){return this.$1(t,0)},o.$1=function(o,a){var t=this,i=function(n){return window.requestAnimationFrame(function(){return t.$1(o,a+1).then(n)})},l=function(t){return p(t)==null};return d(this.lockA,this.tabId),new(e||(e=n("Promise")))(function(e){var n=function(){try{o(),e()}finally{m(t.lockB),m(t.lockA)}};l(t.lockB)||a>10?(a>10&&r("FBLogger")("messenger_web").warn("web-lock polyfill: Had to steal lock"),d(t.lockB,t.tabId),p(t.lockA)===t.tabId?n():window.requestAnimationFrame(function(){p(t.lockB)===t.tabId?n():i(e)})):i(e)})},t})(),f=(function(){function e(t){this.tabId=t,this.lock=new _(e.tabsKey,t),r("promiseDone")(this.$1()),this.$2(),this.keepOnlyTabs(function(t){return e.isAlive(t)})}e.isAlive=function(n){var t=p(e.$3(n));return t==null?!1:Date.now()-parseFloat(t)<1e3};var t=e.prototype;return t.keepOnlyTabs=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){yield this.lock.run(function(){var n,r=JSON.parse((n=p(e.tabsKey))!=null?n:"[]").filter(t);r.length>0?d(e.tabsKey,JSON.stringify(r)):m(e.tabsKey)})});function r(e){return t.apply(this,arguments)}return r})(),t.$2=function(){var t=e.$3(this.tabId);d(t,Date.now().toString());var n=r("setInterval")(function(){d(t,Date.now().toString())},500);o("Run").onUnload(function(){r("clearInterval")(n),m(t)})},t.$1=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=this;yield this.lock.run(function(){var n,r=JSON.parse((n=p(e.tabsKey))!=null?n:"[]");d(e.tabsKey,JSON.stringify([].concat(r,[t.tabId])))}),o("Run").onUnload(function(){return r("promiseDone")(t.keepOnlyTabs(function(e){return e!==t.tabId}))})});function a(){return t.apply(this,arguments)}return a})(),e.$3=function(t){return"$navigator.heartbeat-"+t},e})();f.tabsKey="$navigator.heartbeat-tabs";var g=(function(){function e(t,n){var a=this;this.requests=new Map,this.name=t,this.tabId=n,this.queueKey=e.storagePrefix+"-"+t+"-q",this.currentOwnerKey=e.storagePrefix+"-"+t+"-o",this.lock=new _(e.storagePrefix+"-"+t,this.tabId),o("Run").onUnload(function(){r("promiseDone")(a.keepOnlyRequests(function(e){return(e==null?void 0:e.t)!==a.tabId}))})}var t=e.prototype;return t.enqueue=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var o=this,a=r("uuidv4")().toString(),i={t:this.tabId,u:a},l=function(){e(null),o.markRequestReleased(a)},s=function(){e(a),o.markRequestReleased(a)};if(this.requests.set(a,[function(){return e(a)},function(){t(),o.markRequestReleased(a)}]),(n==null?void 0:n.signal)!=null&&(n.signal.onabort=function(){r("promiseDone")(o.keepOnlyRequests(function(e){return(e==null?void 0:e.u)!==a})),s()},n.signal.aborted))return s();yield this.lock.run(function(){var e=o.getOwner();if((n==null?void 0:n.steal)===!0&&o.$1(e==null?void 0:e.u),e==null||(n==null?void 0:n.steal)===!0||!f.isAlive(e.t))o.$2(o.currentOwnerKey,babelHelpers.extends({},i,(n==null?void 0:n.steal)===!0?{s:!0}:{})),o.$3(a);else if((n==null?void 0:n.ifAvailable)!==!0){var t=o.getQueue();t.push(i),o.$2(o.queueKey,t)}else l()})});function t(t,n,r){return e.apply(this,arguments)}return t})(),t.dequeue=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=this,r,o=null;yield this.lock.run(function(){var r=n.getOwner();if(!((r==null?void 0:r.t)!==n.tabId||(r==null?void 0:r.u)!==t)){var a=n.getQueue(),i=e.getNextOwner(a),l=i[0],s=i[1];o=l,n.$2(n.currentOwnerKey,l),n.$2(n.queueKey,s)}}),this.$3((r=o)==null?void 0:r.u)});function r(e){return t.apply(this,arguments)}return r})(),t.storageChangedOnOtherTab=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=this;e==="o"&&(yield this.lock.run(function(){var e=n.getOwner();if(e!=null&&(n.$3(e==null?void 0:e.u),e.s===!0)){var r=t==null?void 0:t.oldValue;if(r!=null){var o=JSON.parse(r);o.t===n.tabId&&n.$1(o.u)}}}))});function t(t,n){return e.apply(this,arguments)}return t})(),t.getQueue=function(){var e;return(e=this.$4(this.queueKey))!=null?e:[]},t.getOwner=function(){return this.$4(this.currentOwnerKey)},e.getQueueNameAndStorageType=function(n){if(!n.startsWith(e.storagePrefix))return null;var t=n.slice(e.storagePrefix.length+1,n.length-2),o=n.charAt(n.length-1);switch(o){case"q":case"o":case"a":case"b":break;default:throw r("err")("Queue was stored with a suffix other than q or o. This is either a bug in the web lock api polyfill code, or it means that something overwrote localStorage with a weird key. Key: "+n)}return[t,o]},e.getNextOwner=function(t){for(var e=0;e<t.length;e+=1)if(f.isAlive(t[e].t))return[t[e],t.slice(e+1)];return[null,[]]},t.$4=function(t){var e=p(t);return e!=null?JSON.parse(e):null},t.$2=function(t,n){var e=n==null||Array.isArray(n)&&n.length===0?null:JSON.stringify(n);e==null?m(t):d(t,e)},t.keepOnlyRequests=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=this;yield this.lock.run(function(){var r=n.getOwner(),o=n.getQueue().filter(t);if(t(r))n.$2(n.queueKey,o);else{var a=e.getNextOwner(o),i=a[0],l=a[1];n.$2(n.currentOwnerKey,i),n.$2(n.queueKey,l)}})});function r(e){return t.apply(this,arguments)}return r})(),t.markRequestReleased=function(t){t!=null&&this.requests.delete(t)},t.$3=function(t){if(t!=null){var e=this.requests.get(t);if(e!=null){var n=e[0];n()}}},t.$1=function(t){if(t!=null){var e=this.requests.get(t);if(e!=null){var n=e[0],r=e[1];r()}}},e})();g.storagePrefix="$navigator.locks";var h=(function(){function t(e){this.$1=new Map,this.storage=o("LocalStorageWrapper").getStorage(s),this.tabId=e;var t=new f(this.tabId);r("promiseDone")(this.$2()),this.$3()}var a=t.prototype;return a.request=function(){for(var t=this,a=arguments.length,s=new Array(a),u=0;u<a;u++)s[u]=arguments[u];return new(e||(e=n("Promise")))(function(a,u){r("promiseDone")(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a,c=s[0],d=s.length===3?s[1]:null,m=s.length===2?s[1]:s[2];if(c.startsWith("-"))throw new DOMException("Names cannot start with '-'.",i);if((d==null?void 0:d.ifAvailable)===!0&&(d==null?void 0:d.signal)!=null)throw new DOMException("The 'signal' and 'ifAvailable' options cannot be used together.",i);var p=t.$4(c),_=yield new(e||(e=n("Promise")))(function(e){r("promiseDone")(p.enqueue(e,function(){u(new DOMException(l,i))},d))});if((d==null||(a=d.signal)==null?void 0:a.aborted)===!0)throw new DOMException("The request was aborted.",i);try{var f;yield m(_!=null?{mode:(f=d==null?void 0:d.mode)!=null?f:o("LockManager").LockMode.Exclusive,name:c}:null)}finally{_!=null&&(yield p.dequeue(_)),p.markRequestReleased(_)}})(),a,u)})},a.query=function(){var t=[],r=[];for(var a of this.$5())if(a!=null){var i={mode:o("LockManager").LockMode.Exclusive,name:a.name};if(a.getOwner()!=null)t.push(i);else for(var l of a.getQueue())r.push(i)}return(e||(e=n("Promise"))).resolve({held:t,pending:r})},a.$4=function(t){var e=this;return u(this.$1,t,function(){return new g(t,e.tabId)})},a.$3=function(){var e=this;window.addEventListener("storage",function(t){var n,o=t.key;if(!(t.storageArea!==e.storage||o==null)){var a=g.getQueueNameAndStorageType(o);if(a!=null){var i=a[0],l=a[1];r("promiseDone")((n=e.$4(i))==null?void 0:n.storageChangedOnOtherTab(l,t))}}})},a.$2=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield(e||(e=n("Promise"))).all(this.$5().map(function(e){return e==null?void 0:e.keepOnlyRequests(function(e){return e==null?!1:f.isAlive(e.t)})}))});function r(){return t.apply(this,arguments)}return r})(),a.$5=function(){var e=this;return c==null?[]:Object.keys(c).map(function(t){var n=g.getQueueNameAndStorageType(t);if(n!=null){var r=n[0];return e.$4(r)}})},t})();return new h(t)}catch(e){return null}}l.make=u}),98);
__d("supportsNativeWebLock",[],(function(t,n,r,o,a,i){"use strict";function e(){return self.LockManager!=null&&self.navigator.locks instanceof self.LockManager}i.default=e}),66);
__d("SharedWorkerLockManager",["Deferred","FBLogger","WebStorageLockManager","emptyFunction","pageID","promiseDone","setTimeout","supportsNativeWebLock"],(function(t,n,r,o,a,i,l){"use strict";var e="shared_worker_mutex",s=6e5;function u(e){var t,n=(t=window)==null||(t=t.navigator)==null?void 0:t.locks;if(n!=null)return n;var a=o("WebStorageLockManager").make(r("pageID"));return a!=null?(e==null||e.addAnnotations({bool:{fallback_lock_manager:!0}}),{request:function(t,n){return a.request(t,n)}}):null}function c(e,t,n){r("setTimeout")(function(){e.isSettled()||(t==null||t.endFailure("lock_timeout"),r("FBLogger")("worker").warn("[SharedWorkerLockManager]: lock timed out in %s ms",s),e.resolve(),n==null||n())},s)}function d(t,n){var o=n.workerQPLLogger,a=n.onLockTimeout,i=n.onLockFail,l=u(o);if(o==null||o.addAnnotations({bool:{native_locks:l!=null?r("supportsNativeWebLock")():null}}),l==null){o==null||o.markPoint("no_lock_manager"),r("FBLogger")("worker").warn("Unable to initialize lock manager"),t(r("emptyFunction"));return}o==null||o.markPoint("lock_requested");var s=new(r("Deferred"));r("promiseDone")(l.request(e,function(){return o==null||o.markPoint("lock_obtained"),c(s,o,a),t(function(){o==null||o.markPoint("lock_released"),s.resolve()}),s.getPromise()}),void 0,i)}l.withWorkerLock=d}),98);
__d("SharedWorkerLoggingUtils",["ErrorSerializer","FBLogger","ODS","QPLUserFlow","getErrorSafe","pageID","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n,r,a){(e||(e=o("ODS"))).bumpEntityKey(6653,"shared_worker_infra","worker_self_termination."+n+"."+t),u(t,n,r,a,!0)}function u(e,t,n,o,a){a===void 0&&(a=!1);var i=r("qpl")._(931600201,"1438");r("QPLUserFlow").start(i),r("QPLUserFlow").endSuccess(i,{annotations:{string:{workerName:e,workerID:o,reason:n,location:t,pageID:r("pageID")},bool:{isSelfTermination:a}}})}function c(e,t,n,r,o,a){e==null||e.markEventEnd("execute_worker"),e==null||e.addAnnotations({int:{runningWorkerRev:o,runningWorkerSpinTime:t,runningWorkerSpinMode:a},string:{executeWorkerErr:n},bool:{isFirstInit:r}})}function d(e,t,n){var o,a,i,l,s,u,c=r("getErrorSafe")((o=t instanceof ErrorEvent&&(t==null?void 0:t.error))!=null?o:t);r("FBLogger")("worker").catching(c).warn("Worker %s onerror: %s type, %s message",n,String(t.type),r("ErrorSerializer").toReadableMessage(c)),e==null||e.addAnnotations({string_array:{onErrorHandler:[(a=JSON.stringify((i=c==null?void 0:c.message)!=null?i:t==null?void 0:t.message))!=null?a:"undefined",String((l=t==null?void 0:t.lineno)!=null?l:c==null?void 0:c.lineno),String((s=t==null?void 0:t.colno)!=null?s:c==null?void 0:c.colno),String((u=t==null?void 0:t.filename)!=null?u:c==null?void 0:c.filename)]}})}l.logSelfTermination=s,l.logShutdown=u,l.logExecuteAck=c,l.logSharedWorkerError=d}),98);
__d("mergeDeepInto",["invariant","mergeHelpers"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e=n("mergeHelpers")).ArrayStrategies,u=e.checkArrayStrategy,c=e.checkMergeArrayArgs,d=e.checkMergeLevel,m=e.checkMergeObjectArgs,p=e.isTerminal,_=e.normalizeMergeArg,f=function(t,n,r,o){m(t,n),d(o);for(var e=n?Object.keys(n):[],a=0;a<e.length;a++){var i=e[a];h(t,n,i,r,o)}},g=function(t,n,r,o){if(c(t,n),d(o),r===s.Concat)t.push.apply(t,n);else for(var e=Math.max(t.length,n.length),a=0;a<e;a++)h(t,n,a,r,o)},h=function(t,n,r,o,a){var e=n[r],i=Object.prototype.hasOwnProperty.call(n,r),u=i&&p(e),c=i&&Array.isArray(e),d=i&&!c&&!c,m=t[r],_=Object.prototype.hasOwnProperty.call(t,r),h=_&&p(m),y=_&&Array.isArray(m),C=_&&!y&&!y;h?u?t[r]=e:c?(t[r]=[],g(t[r],e,o,a+1)):d?(t[r]={},f(t[r],e,o,a+1)):i||(t[r]=m):y?u?t[r]=e:c?(o&&s[o]||l(0,5117),o===s.Clobber&&(m.length=0),g(m,e,o,a+1)):d&&(t[r]={},f(t[r],e,o,a+1)):C?u?t[r]=e:c?(t[r]=[],g(t[r],e,o,a+1)):d&&f(m,e,o,a+1):_||(u?t[r]=e:c?(t[r]=[],g(t[r],e,o,a+1)):d&&(t[r]={},f(t[r],e,o,a+1)))};function y(e,t,n){var r=_(t);u(n),f(e,r,n,0)}i.default=y}),66);
__d("WebAsyncStorage",["Deferred","Promise","err","mergeDeepInto","mergeHelpers"],(function(t,n,r,o,a,i,l){"use strict";var e,s=typeof window!="undefined"?window:self,u=s.indexedDB,c=1,d="data",m=!1,p,_=Date.now(),f=new(r("Deferred")),g=3;function h(){var e=u.open("AsyncStorage",c);e.onerror=function(t){var n,r=(n=e.error)!=null?n:new Error("Failed to open AsyncStorage IndexedDB instance.");if(r.name==="UnknownError"&&g>0)return g--,h();f.reject(r)},e.onsuccess=function(e){p=e.target.result,f.resolve({db:p}),p.onerror=function(e){var t=new Error("AsyncStorage error: "+e.target.error.message);t.message,f.reject(t)}},e.onupgradeneeded=function(e){var t=e.currentTarget.result;t.objectStoreNames&&t.objectStoreNames.contains(d)||t.createObjectStore(d,{keyPath:"key"})}}u&&h();function y(e,t){if(p)try{e()}catch(e){t&&t(e)}else f.getPromise().then(function(){m&&""+(Date.now()-_),y(e,t)},function(e){t&&t(e)})}var C={setItem:function(t,n,r){this.multiSet([[t,n]],function(e){r(e&&e[0]||null)})},getItem:function(t,n){this.multiGet([t],function(e,t){var r=t!==void 0&&t[0]!==void 0&&t[0][1]!==void 0?t[0][1]:null;n(e&&e[0]||null,r)})},removeItem:function(t,n){this.multiRemove([t],function(e){n(e&&e[0]||null)})},getOrSetItem:function(t,n,r){this.multiGetOrSet([[t,n]],function(e,t){var n=t!==void 0&&t[0]!==void 0&&t[0][1]!==void 0?t[0][1]:null;r(e&&e[0]||null,n)})},upsertAndSaveAtomic:function(t,n,r){var e=null;this._multiOp([t],"readwrite",function(t){return r(t,e)},function(e){return e},function(t,r,o){if(r&&t===r.key){var a=n(r.value.value);if(a!=null){var i=r.value;i.value=a,e=a,r.update(i)}}else{var l=n(null);l!=null&&(e=l,o.push([t,l]))}})},multiGet:function(t,n){var e=[];this._multiOp(t,"readonly",function(t){return n(t,e)},function(e){return e},function(t,n,r){n&&t===n.key?(m&&""+t,e.push([t,n.value.value])):e.push([t,null])})},multiSet:function(t,n){if(this._persistentWritesDisabled){n(new Array(t.length).fill("writes disabled"));return}this._multiOp(t,"readwrite",n,function(e){return e[0]},function(e,t,n){if(t&&e[0]===t.key){var r=t.value;r.value=e[1],m&&""+t.key+r.value,t.update(r)}else n.push(e)})},multiGetOrSet:function(t,n){if(this._persistentWritesDisabled){n(new Array(t.length).fill("writes disabled"));return}var e=[];this._multiOp(t,"readwrite",function(t){return n(t,e)},function(e){return e[0]},function(t,n,r){n&&t[0]===n.key?(e.push([t,n.value.value]),m&&""+n.key):r.push(t)})},multiMerge:function(t,n){this._multiOp(t,"readwrite",n,function(e){return e[0]},function(e,t,n){if(t&&e[0]===t.key){var o=t.value,a=JSON.parse(o.value);r("mergeDeepInto")(a,JSON.parse(e[1]),r("mergeHelpers").ArrayStrategies.Clobber),m&&""+e[0]+e[1]+o.value+JSON.stringify(a),o.value=JSON.stringify(a),t.update(o)}else m&&""+e[0],n.push(e)})},multiRemove:function(t,n){this._multiOp(t,"readwrite",n,function(e){return e},function(e,t,n){t&&e===t.key&&(m&&""+t.value,t.delete())})},getAllKeys:function(t){y(function(){var e=p.transaction([d],"readonly"),n=e.objectStore(d).openCursor(),r=[];n.onsuccess=function(e){var n=e.target.result;if(!n){t(null,r);return}r.push(n.key),n.continue()}},function(e){return t(null,[])})},clear:function(t){y(function(){var e=p.transaction([d],"readwrite"),n=e.objectStore(d).openCursor();n.onsuccess=function(e){var n=e.target.result;if(!n){t(null);return}n.delete(),n.continue()}},function(e){return t(null)})},_multiOp:function(t,n,r,o,a){y(function(){var e=!1,i=t.slice().sort(function(t,n){var a=o(t),i=o(n);if(a===i){var l=new Error("AsyncStorage._multiOp cannot process duplicate keys.");return l.message,r&&r([l]),e=!0,0}return a<i?-1:1});if(e)return;var l=p.transaction([d],n),s=l.objectStore(d).openCursor(),u=[],c=0;s.onsuccess=function(e){var t=e.target.result;if(!t){for(;c<i.length;)a(i[c],t,u),c++;_();return}var n=t.key;for(m&&""+n;o(i[c])<=n;)if(m&&""+i[c],a(i[c],t,u),c++,c===i.length){_();return}var r=o(i[c]);t.continue(r)};function _(){var e=l.objectStore(d);u.forEach(function(t){m&&""+t[0]+t[1],e.add({key:t[0],value:t[1]})})}l.oncomplete=function(){r&&r(null)},l.onerror=function(e){var t=new Error("IndexedDB error: "+e.target.error.message);""+t.message+t.stack,r&&r([t])}},function(e){r&&r([e])})},_persistentWritesDisabled:!1,disablePersistentWrites:function(){this._persistentWritesDisabled=!0},isOpenPromiseSettled:function(){return f.isSettled()},isOperational:function(){return u==null?(e||(e=n("Promise"))).resolve({success:!1,error:r("err")("IDB interface not available")}):f.getPromise().then(function(){return{success:!0}}).catch(function(e){return{success:!1,error:e}})}},b=C;l.default=b}),98);
__d("validateSharedWorkerReference",["ConstUriUtils","isRelativeURL","isSameOrigin","memoize"],(function(t,n,r,o,a,i,l){"use strict";var e=r("memoize")(function(){return o("ConstUriUtils").getUri(window.location.href)});function s(t){var n=e(),a=o("ConstUriUtils").getUri(t),i=n!=null&&a!=null?r("isSameOrigin")(a,n):!1;return i||r("isRelativeURL")(t)}function u(e){if(e==null||typeof e!="object")return null;var t=e.rev,n=e.spin_time,r=e.url,o=e.version,a=e.rsrcBundleUrl,i=e.sandboxOnlyChecksum;return typeof t!="number"||typeof n!="number"||o!=null&&o!==1&&o!==2||!Number.isInteger(t)||!Number.isInteger(n)||typeof r!="string"||!s(r)||a!=null&&typeof a!="string"||i!=null&&typeof i!="string"?null:{rev:t,spin_time:n,url:r,version:o!=null?o:1,rsrcBundleUrl:a,sandboxOnlyChecksum:i}}l.default=u}),98);
__d("SharedWorkerStorageManager",["Deferred","FBLogger","Promise","WebAsyncStorage","promiseDone","validateSharedWorkerReference"],(function(t,n,r,o,a,i,l){"use strict";var e,s="__swbundle__",u={};function c(e){return""+s+e}function d(e){var t=new(r("Deferred"));return r("WebAsyncStorage").removeItem(c(e),function(n){if(n)return t.reject(n);u[e]=null,t.resolve()}),t.getPromise()}function m(e,t){var n=new(r("Deferred"));return r("WebAsyncStorage").setItem(c(e),t,function(r){if(r!=null)return n.reject(r);u[e]=t,n.resolve()}),n.getPromise()}function p(e){var t=new(r("Deferred"));return r("WebAsyncStorage").getItem(c(e),function(n,r){if(n)return t.reject(n);u[e]=r,t.resolve(r)}),t.getPromise()}function _(){return u}function f(e,t){return p(e).then(function(e){var t=r("validateSharedWorkerReference")(e);return t==null?null:t}).catch(function(n){throw r("FBLogger")("worker").catching(n).mustfix("Failed to getSharedWorkerReference for bundleName %s",e),t==null||t.addAnnotations({bool:{failedToGetSharedWorkerResource:!0}}),n})}function g(e,t){return d(e).catch(function(n){throw r("FBLogger")("worker").catching(n).mustfix("Failed to removeSharedWorkerReference for bundleName %s",e),t==null||t.addAnnotations({bool:{failedToDeleteSharedWorkerResource:!0}}),n})}function h(t,o,a){var i=r("validateSharedWorkerReference")(o);return i==null?(r("FBLogger")("worker").mustfix('Failed to save worker reference for bundle "%s". Invalid reference: %s',t,JSON.stringify(o)),(e||(e=n("Promise"))).resolve()):m(t,i).catch(function(e){throw r("FBLogger")("worker").catching(e).mustfix("Failed to saveSharedWorkerReference for bundleName %s",t),a==null||a.addAnnotations({bool:{failedToSaveSharedWorkerResource:!0}}),e})}function y(e,t,n){var o=r("WebAsyncStorage").isOpenPromiseSettled();n==null||n.addAnnotations({bool:{isWebAsyncStorageIndexedDBOpened:o}}),o&&r("promiseDone")(r("WebAsyncStorage").isOperational(),function(e){n==null||n.addAnnotations({string:{idb_open_error:e.success===!1?e.error.message:"No IDB open error"}})});var a=new(r("Deferred"));return r("WebAsyncStorage").upsertAndSaveAtomic(c(e),function(e){var n=r("validateSharedWorkerReference")(e);return t(n)},function(t,o){if(n==null||n.markPoint("worker_reference_db_response"),t)return r("FBLogger")("worker").catching(t).mustfix("Failed to getOrUpdateWorkerReference for bundleName %s",e),a.reject(t);u[e]=o,a.resolve(o)}),a.getPromise()}l.SHARED_WORKER_STORAGE_KEY_BASE=s,l.getDebugState=_,l.getSharedWorkerReference=f,l.removeSharedWorkerReference=g,l.saveSharedWorkerReference=h,l.getOrUpdateWorkerReference=y}),98);
__d("TrustedTypesWebWorkerScriptURLPolicy",["TrustedTypes"],(function(t,n,r,o,a,i,l){"use strict";var e={createScriptURL:function(t){return t}},s=r("TrustedTypes").createPolicy("web-worker-url",e),u=s;l.default=u}),98);
__d("XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder",["jsRouteBuilder"],(function(t,n,r,o,a,i,l){var e=r("jsRouteBuilder")("/static_resources/webworker/init_script/",Object.freeze({}),void 0),s=e;l.default=s}),98);
__d("supportsModuleWorker",["UserAgent"],(function(t,n,r,o,a,i,l){"use strict";var e=null;function s(t){if(e!=null||e!=null)return e;if(r("UserAgent").isEngine("Blink"))return e=t?r("UserAgent").isEngine_DEPRECATED_DANGEROUS("Blink > 83"):r("UserAgent").isEngine_DEPRECATED_DANGEROUS("Blink > 80.1"),e;if(r("UserAgent").isBrowser("Safari"))return e=r("UserAgent").isBrowser("Safari > 14.9"),e;if(r("UserAgent").isBrowser("Firefox"))return e=r("UserAgent").isBrowser("Firefox > 113"),e;if(r("UserAgent").isEngine("WebKit"))return e=r("UserAgent").isEngine_DEPRECATED_DANGEROUS("WebKit > 606"),e;if(r("UserAgent").isBrowser("IE"))return e=!1,e;var n={get type(){e=!0}};try{if(t)var o=new SharedWorker("blob://",n);else var a=new Worker("blob://",n)}finally{return e=e!=null?e:!1,e}}l.default=s}),98);
__d("createSharedWorkerV2BundleUrlExperimental",["XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder","nullthrows","supportsModuleWorker"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t,n=r("supportsModuleWorker")(!0);return r("nullthrows")((t=r("XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder").buildUri({worker_type:n?"MODULE":"CLASSIC",name:e}))==null?void 0:t.toString())}l.default=e}),98);
__d("SharedWorkerMigrationUtils",["ConstUriUtils","Deferred","FBLogger","Promise","SharedWorkerEventManager","SharedWorkerStatusLock","SharedWorkerStorageManager","TrustedTypesWebWorkerScriptURLPolicy","asyncToGeneratorRuntime","clearTimeout","createSharedWorkerV2BundleUrlExperimental","err","getErrorSafe","setTimeout","supportsModuleWorker","supportsNativeWebLock"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!r("supportsNativeWebLock")())return!0;var t=yield self.navigator.locks.query();return t.held.some(function(t){return t.name===o("SharedWorkerStatusLock").getDynamicStringInitLockName(e)})}),u.apply(this,arguments)}function c(){return r("supportsNativeWebLock")()}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!r("supportsNativeWebLock")())return!0;var t=yield self.navigator.locks.query();return t.held.some(function(t){return t.name===o("SharedWorkerStatusLock").getStatusLockName(e)})}),m.apply(this,arguments)}function p(e,t){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(!r("supportsNativeWebLock")())return!0;var n=yield self.navigator.locks.query();return n.held.some(function(n){return n.name===o("SharedWorkerStatusLock").getWorkerIdStatusLockName(e,t)})}),_.apply(this,arguments)}var f={SharedWorkerBundle:!0,MAWMainWebWorkerV2Bundle:!0};function g(e){var t;return(t=f[e])!=null?t:!1}function h(e){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!(yield s(e)))return!1;var t=new(r("Deferred")),n=r("createSharedWorkerV2BundleUrlExperimental")(e),a=r("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(n),i=r("supportsModuleWorker")(!0)?new SharedWorker(a,{name:e,type:"module"}):new SharedWorker(a,e);return o("SharedWorkerEventManager").registerWorkerShutdownListener(i,function(e){t.resolve(!0)},{once:!0}),o("SharedWorkerEventManager").emitWorkerShutdown(i,{upgrade:!1,reason:"dynamic_string_worker_rollback"}),i.port.start(),t.getPromise()}),y.apply(this,arguments)}function C(e){var t=o("ConstUriUtils").getUri(e);return t!=null&&t.getQueryParam("hash")!=null}function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=t.name,i=t.logger;try{var l=yield(e||(e=n("Promise"))).all([d(a),s(a)]),u=l[0],c=l[1];if(!u||r("supportsNativeWebLock")()&&c){i.markPoint("legacy_termination_skipped"),i.addAnnotations({bool:{dynamicStringWorkerAlreadyRunning:c,workerAlreadyRunning:u,native_locks:r("supportsNativeWebLock")()}});return}var m=yield o("SharedWorkerStorageManager").getSharedWorkerReference(a);if(i.markPoint("storage_read"),i.addAnnotations({bool:{storageResourceSet:m!=null}}),m==null)return;try{yield o("SharedWorkerStorageManager").removeSharedWorkerReference(a),i.markPoint("storage_cleaned")}catch(e){i.markPoint("storage_error"),i.addAnnotations({string:{storageError:String(e)}}),r("FBLogger")("worker").catching(r("getErrorSafe")(e)).mustfix("Failed to remove reference from storage.")}var p=C(m.url);if(i.markPoint(p?"legacy_termination_start":"termination_skipped"),p){var _=new(r("Deferred")),f=r("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(m.url),g=r("supportsModuleWorker")(!0)?new SharedWorker(f,{name:a,type:"module"}):new SharedWorker(f,a),h=function(){i.markPoint("legacy_termination_end"),_.resolve(!0)};o("SharedWorkerEventManager").registerWorkerShutdownListener(g,h,{once:!0}),o("SharedWorkerEventManager").registerWorkerSelfTerminationListener(g,h,{once:!0}),g.port.start(),o("SharedWorkerEventManager").emitWorkerShutdown(g,{upgrade:!1,reason:"maw-request-refresh"});var y=r("setTimeout")(function(){i.markPoint("legacy_termination_timeout"),_.reject(r("err")("Failed to close Shared Web Worker properly. SelfTerminationTimeout was exceeded."))},1e3);yield _.getPromise(),r("clearTimeout")(y)}}catch(e){i.markPoint("legacy_check_and_termination_error"),i.addAnnotations({string:{legacyCheckError:String(e)}}),r("FBLogger")("worker").catching(r("getErrorSafe")(e)).mustfix("Failed to check storage and possibly terminate legacy worker.")}}),v.apply(this,arguments)}l.isDynamicStringWorkerRunning=s,l.supportsNativeWebLocks=c,l.isStatusLockHeld=d,l.isWorkerIdStatusLockHeld=p,l.shouldCheckForDynamicStringWorker=g,l.maybeTerminateDynamicStringWorker=h,l.isLegacyWorkerURL=C,l.checkStorageAndTerminateLegacyWorker=b}),98);
__d("SharedWorkerUptimeTracker",["FBLogger","ODS","SharedWorkerEventManager","clearInterval","performanceNow","setInterval","setTimeout"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=1e4,c=45e3,d=new Map;function m(e){return Math.floor(((s||(s=r("performanceNow")))()-e)/1e3)}function p(t,n){var a=0,i={};return o("SharedWorkerEventManager").registerUptimeTrackerListener(t,function(t){var r=t.trackerID,a=i[r];a!=null&&((e||(e=o("ODS"))).bumpFraction(6653,"shared_worker_infra","worker_uptime."+n,1,0),e.bumpEntityKey(6653,"shared_worker_infra","worker_uptime_elapsed_time_to_response_sec."+m(a.createdMs)+"."+n),delete i[r])}),r("setInterval")(function(){var l=a++;r("setTimeout")(function(){var e=i[l];e!=null&&delete i[l]},c),i[l]={createdMs:(s||(s=r("performanceNow")))()},(e||(e=o("ODS"))).bumpFraction(6653,"shared_worker_infra","worker_uptime."+n,0,1),o("SharedWorkerEventManager").emitUptimeTracking(t,{trackerID:l})},u)}function _(e,t){if(d.has(t)){r("FBLogger")("worker").mustfix('Uptime tracking for worker "%s" already started.',t);return}d.set(t,{intervalID:p(e,t)})}function f(e){var t=d.get(e);t!=null&&(r("clearInterval")(t.intervalID),d.delete(e))}l.startUptimeTracking=_,l.stopUptimeTracking=f}),98);
__d("XCometFBMultiSiteWebWorkerV2HasteResponseControllerRouteBuilder",["jsRouteBuilder"],(function(t,n,r,o,a,i,l){var e=r("jsRouteBuilder")("/static_resources/webworker/rsrc/",Object.freeze({}),void 0),s=e;l.default=s}),98);
__d("WebWorkerV2DynamicData",["FBLogger","Promise","XCometFBMultiSiteWebWorkerV2HasteResponseControllerRouteBuilder","cometAsyncFetchShared","err","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e,s=new Map;function u(e,t){t===void 0&&(t=!1);var n=e.name,r=s.get(n);if(r==null||t){var o=Math.floor(+Date.now()/1e3);r=c(e,t).then(function(e){return{time:o,data:e}}),s.set(n,r)}return r}function c(t,o){var a=t.name,i=t.v2HasteResponsePreloader;if(i==null||o)return d(a,o);var l=null,s=new(e||(e=n("Promise")))(function(e,t){i.onLoaded(function(t){var n=t.data;(n==null||n.hrp==null)&&r("FBLogger")("worker").mustfix("Preloaded data for worker %s is missing haste response, preload data keys: %s",a,n==null?"null":Object.keys(n).join(", ")),l=n,e(n)}).onError(t)});return e.race([s,new e(function(e,t){window.setTimeout(function(){l==null?r("promiseDone")(d(a,o),e,t):e(l)},1e4)})])}function d(e,t){var n=null;return t&&(n=new FormData,n.set("__rev","null"),n.set("__spin_r","null")),r("cometAsyncFetchShared")(r("XCometFBMultiSiteWebWorkerV2HasteResponseControllerRouteBuilder").buildUri({worker_module:e}).toString(),{formData:n!=null?n:void 0,data:{},getFullPayload:!0,method:"POST",skipSRState:!0,retryCount:t?2:void 0}).then(function(t){if(t!=null&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"hrp")&&typeof t.hrp=="object")return t;throw r("err")("Unexpected data from WorkerInitResourceDeliveryController for worker %s",e)})}l.readDynamicDataForWorker=u}),98);
__d("checkForIndexedDbSupported",[],(function(t,n,r,o,a,i){"use strict";function e(){return!!window.indexedDB}i.default=e}),66);
__d("buildSharedWorkerInitQPLLogger",["QPLUserFlow","SiteData","checkForIndexedDbSupported","pageID","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e=r("qpl")._(931595918,"2062"),s=0;function u(t){var n=!1,o=!1,a=s++;function i(i){var l=i.version,s=i.workerName,u=i.callReason,c=i.experimental_init,d=i.migrationEnabled;if(!(n||o)){n=!0;var m={int:{version:l,clientRev:r("SiteData").client_revision},bool:{isDev:!1,supportsIDB:r("checkForIndexedDbSupported")(),experimental_init:c!=null?c:!1,migrationEnabled:d!=null?d:!1},string:{workerName:s,hostname:window.location.hostname,callReason:u,pageID:r("pageID")}};r("QPLUserFlow").start(e,{onFlowTimeout:function(){r("QPLUserFlow").addAnnotations(e,{bool:{setupTimeout:!0}},{instanceKey:a}),o=!0},cancelOnUnload:!0,annotations:m,timeoutInMs:66e4,instanceKey:a}),t==null||t({type:"start",data:{annotations:m}})}}function l(i,l){var s=i+"_start";t==null||t({type:"point",data:{annotations:l,event:s}}),!(!n||o)&&r("QPLUserFlow").addPoint(e,s,{data:l,instanceKey:a})}function u(i,l){var s=i+"_end";t==null||t({type:"point",data:{annotations:l,event:s}}),!(!n||o)&&(r("QPLUserFlow").addPoint(e,s,{data:l,instanceKey:a}),t==null||t({type:"point",data:{annotations:l,event:s}}))}function c(i,l){t==null||t({type:"point",data:{annotations:l,event:i}}),!(!n||o)&&r("QPLUserFlow").addPoint(e,i,{data:l,instanceKey:a})}function d(i){t==null||t({type:"end",data:{annotations:i}}),!(!n||o)&&(r("QPLUserFlow").endSuccess(e,{annotations:i,instanceKey:a}),o=!0)}function m(i,l){t==null||t({type:"end",data:{errorName:i,annotations:l}}),!(!n||o)&&(r("QPLUserFlow").endFailure(e,i,{annotations:l,instanceKey:a}),o=!0)}function p(i){t==null||t({type:"end",data:{annotations:i,cancel:!0}}),!(!n||o)&&(r("QPLUserFlow").endCancel(e,{annotations:i,instanceKey:a}),o=!0)}function _(i){t==null||t({type:"annotate",data:{annotations:i}}),!(!n||o)&&r("QPLUserFlow").addAnnotations(e,i,{instanceKey:a})}return{start:i,endFailure:m,addAnnotations:_,endSuccess:d,endCancel:p,markEventStart:l,markEventEnd:u,markPoint:c}}l.default=u}),98);
__d("buildSharedWorkerTerminateQPLLogger",["QPLUserFlow","SiteData","pageID","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e=r("qpl")._(931600201,"1438"),s=0;function u(t){var n=!1,o=!1,a=s++;function i(i){var l=i.workerName,s=i.callReason;if(!(n||o)){n=!0;var u={int:{clientRev:r("SiteData").client_revision},bool:{isDev:!1},string:{workerName:l,hostname:window.location.hostname,callReason:s,pageID:r("pageID")}};r("QPLUserFlow").start(e,{onFlowTimeout:function(){r("QPLUserFlow").addAnnotations(e,{bool:{setupTimeout:!0}},{instanceKey:a}),o=!0},cancelOnUnload:!0,annotations:u,timeoutInMs:3e4,instanceKey:a}),t==null||t({type:"start",data:{annotations:u}})}}function l(i,l){if(!(!n||o)){var s=i+"_start";r("QPLUserFlow").addPoint(e,s,{data:l,instanceKey:a}),t==null||t({type:"point",data:{annotations:l,event:s}})}}function u(i,l){if(!(!n||o)){var s=i+"_end";r("QPLUserFlow").addPoint(e,s,{data:l,instanceKey:a}),t==null||t({type:"point",data:{annotations:l,event:s}})}}function c(i,l){!n||o||(r("QPLUserFlow").addPoint(e,i,{data:l,instanceKey:a}),t==null||t({type:"point",data:{annotations:l,event:i}}))}function d(i){!n||o||(r("QPLUserFlow").endSuccess(e,{annotations:i,instanceKey:a}),t==null||t({type:"end",data:{annotations:i}}),o=!0)}function m(i,l){!n||o||(r("QPLUserFlow").endFailure(e,i,{annotations:l,instanceKey:a}),t==null||t({type:"end",data:{errorName:i,annotations:l}}),o=!0)}function p(i){!n||o||(r("QPLUserFlow").endCancel(e,{annotations:i,instanceKey:a}),t==null||t({type:"end",data:{annotations:i,cancel:!0}}),o=!0)}function _(i){!n||o||(r("QPLUserFlow").addAnnotations(e,i,{instanceKey:a}),t==null||t({type:"annotate",data:{annotations:i}}))}return{start:i,endFailure:m,addAnnotations:_,endSuccess:d,endCancel:p,markEventStart:l,markEventEnd:u,markPoint:c}}l.default=u}),98);
__d("XCometFBMultiSiteSharedWorkerStaticInitScriptControllerRouteBuilder",["jsRouteBuilder"],(function(t,n,r,o,a,i,l){var e=r("jsRouteBuilder")("/static_resources/sharedworker/init_script/",Object.freeze({}),void 0),s=e;l.default=s}),98);
__d("getSharedWorkerHash",["uuidv4"],(function(t,n,r,o,a,i,l){"use strict";function e(){return r("uuidv4")()}l.default=e}),98);
__d("getWorkerInitScriptSPINParams",["SiteData","StaticSiteData","objectEntries"],(function(t,n,r,o,a,i,l){"use strict";function e(){var e,t,n,o,a=(n=r("SiteData"))[(o=r("StaticSiteData")).spin_mhenv_key],i=babelHelpers.extends((e={},e[o.hs_key]=n.haste_session,e[o.spin_rev_key]=n[o.spin_rev_key],e[o.spin_branch_key]=n[o.spin_branch_key],e[o.spin_time_key]=n[o.spin_time_key],e),a?(t={},t[r("StaticSiteData").spin_mhenv_key]=a,t):null);return new Map(r("objectEntries")(i))}l.default=e}),98);
__d("createSharedWorkerBundleUrl",["XCometFBMultiSiteSharedWorkerStaticInitScriptControllerRouteBuilder","getSharedWorkerHash","getWorkerInitScriptSPINParams","nullthrows"],(function(t,n,r,o,a,i,l){"use strict";function e(){var e;return r("nullthrows")((e=r("XCometFBMultiSiteSharedWorkerStaticInitScriptControllerRouteBuilder").buildUri({hash:r("getSharedWorkerHash")()}).addQueryParams(r("getWorkerInitScriptSPINParams")()))==null?void 0:e.toString())}l.default=e}),98);
__d("createSharedWorkerV2BundleUrl",["XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder","getSharedWorkerHash","getWorkerInitScriptSPINParams","gkx","justknobx","nullthrows","supportsModuleWorker"],(function(t,n,r,o,a,i,l){"use strict";function e(){var e,t=r("supportsModuleWorker")(!0),n=r("getWorkerInitScriptSPINParams")();return n.set("hash",r("getSharedWorkerHash")()),n.set("use_broadcast",r("justknobx")._("4177")),n.set("worker_id_in_terminate",r("gkx")("12766")),r("nullthrows")((e=r("XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder").buildUri({worker_type:t?"MODULE":"CLASSIC"}))==null||(e=e.addQueryParams(n))==null?void 0:e.toString())}var s=function(){return e()};l.createSharedWorkerV2BundleUrl=s}),98);
__d("handleWorkerWriteError",["FBLogger","WebStorageCleanupReason"],(function(t,n,r,o,a,i,l){"use strict";function e(e){if(e instanceof Error){r("FBLogger")("worker").catching(e).mustfix("Error occured checking in shared worker reference");return}if(e==="writes disabled"){var t;r("FBLogger")("worker").warn("Writes to WebAsyncStorage is disabled. Unable to save shared worker reference. Reason: %s",(t=o("WebStorageCleanupReason").getLastCleanupReason())!=null?t:"n/a");return}r("FBLogger")("worker").mustfix("Error occured checking in shared worker reference: %s",JSON.stringify(e))}l.default=e}),98);
__d("SharedWorkerInitFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("4266"),s=o("FalcoLoggerInternal").create("shared_worker_init",e),u=s;l.default=u}),98);
__d("logSharedWorkerInitStep",["SharedWorkerInitFalcoEvent","SiteData","gkx","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e=r("uuidv4")();function s(t,n,o,a){r("gkx")("21115")&&r("SharedWorkerInitFalcoEvent").log(function(){return{client_id:e,bundle_name:t,client_rev:String(r("SiteData").client_revision),local_shared_worker_ref:n!=null?{bundle_url:n.url,rev:String(n.rev),spin_time:String(n.spin_time)}:null,new_shared_worker_ref:o!=null?{bundle_url:o}:null,init_step:a}})}l.default=s}),98);
__d("SharedWorkerBundleResource",["BootloaderPreloader","Deferred","FBLogger","Promise","SharedWorkerDevChangeManager","SharedWorkerEventManager","SharedWorkerLockManager","SharedWorkerLoggingUtils","SharedWorkerMigrationUtils","SharedWorkerStorageManager","SharedWorkerUptimeTracker","SharedWorkerV2ResourceExperimental","SiteData","StaticSiteData","TrustedTypesWebWorkerScriptURLPolicy","WebWorkerV2DynamicData","asyncToGeneratorRuntime","buildSharedWorkerInitQPLLogger","buildSharedWorkerTerminateQPLLogger","createSharedWorkerBundleUrl","createSharedWorkerV2BundleUrl","createSharedWorkerV2BundleUrlExperimental","err","getErrorSafe","handleWorkerWriteError","justknobx","logSharedWorkerInitStep","pageID","promiseDone","qex","setTimeout","supportsModuleWorker","supportsNativeWebLock"],(function(t,n,r,o,a,i,l){"use strict";var e,s=5e3,u="shared_worker_broadcast_channel",c=(function(e){function t(t){var n;return n=e.call(this)||this,n.name="SelfTerminationError",n.message="Worker self terminated with the reason: "+t,n.reason=t,n}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));function d(e,t,n,a){a==null||a.markEventStart("shared_worker_construct");var i=new SharedWorker(r("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(e),t);a==null||a.markEventEnd("shared_worker_construct"),i.addEventListener("error",function(e){o("SharedWorkerLoggingUtils").logSharedWorkerError(a,e,t)});var l=new Set;o("SharedWorkerEventManager").registerWorkerSelfTerminationListener(i,function(e,n,r){o("SharedWorkerLoggingUtils").logSelfTermination(t,e,n,r)},{once:!0});var s=0;o("SharedWorkerEventManager").registerConnectionAckListener(i,function(e,t){if(s++,l.has("worker_connection_established")){a==null||a.addAnnotations({int:{connectionAckNum:s}});return}l.add("worker_connection_established"),a==null||a.addAnnotations({string:{connectedFrom:e,workerID:t}}),a==null||a.markPoint("worker_connection_established")}),o("SharedWorkerEventManager").registerWorkerInitPointsListener(i,function(e){l.has(e)||(l.add(e),a==null||a.markPoint("worker_init_point_"+e))}),i.port.start(),o("SharedWorkerEventManager").registerExecuteWorkerImportsListener(i,a,function(e){var t=e.err,n=e.attempts;a==null||a.addAnnotations({string:{importsError:t},int:{importAttempts:n}}),a==null||a.markPoint(t==null?"bundle_imports_success":"bundle_imports_failure")});var u=new(r("Deferred"));return o("SharedWorkerEventManager").registerExecuteWorkerAckListener(i,a,function(e){var t=e.workerSpinTime,n=e.err,i=e.isFirstInit,l=e.workerRev,s=e.workerSpinMode;o("SharedWorkerLoggingUtils").logExecuteAck(a,t,n,i,l,s),n!=null||t==null||l==null?u.reject(r("err")(n!=null?n:"no worker rev or spin time")):u.resolve({rev:l,spinTime:t})}),a==null||a.markEventStart("execute_worker"),o("SharedWorkerEventManager").emitExecuteWorker(i,{jsModuleResource:n,isDev:!1}),u.getPromise().then(function(e){var t=e.rev,n=e.spinTime;return{worker:i,rev:t,spinTime:n}})}function m(e,t,n){n==null||n.markEventStart("worker_constructor");var o=r("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(e),a=r("supportsModuleWorker")(!0)?new SharedWorker(o,{name:t,type:"module"}):new SharedWorker(o,t);return n==null||n.markEventEnd("worker_constructor",{string:{workerUrl:o.toString()}}),a}function p(e,t,n){var r=[],a=new Set;r.push(o("SharedWorkerEventManager").registerWorkerInitPointsListener(e,function(e){a.has(e)||(a.add(e),n==null||n.markPoint("worker_init_point_"+e))})),r.push(o("SharedWorkerEventManager").registerHrpInitListener(e,n,function(){}));var i=function(r){o("SharedWorkerLoggingUtils").logSharedWorkerError(n,r,t)};return e.addEventListener("error",i),r.push(function(){return e.removeEventListener("error",i)}),r}function _(e,t,n,a){o("SharedWorkerMigrationUtils").shouldCheckForDynamicStringWorker(t)&&(a==null||a.markEventStart("dynamic_string_worker_check"),r("promiseDone")(o("SharedWorkerMigrationUtils").maybeTerminateDynamicStringWorker(t),function(e){a==null||a.markEventEnd("dynamic_string_worker_check",{bool:{didTerminateDynamicStringWorker:e}})}));var i=m(e,t,a);o("SharedWorkerEventManager").registerConnectionAckListener(i,function(e,t,n){a==null||a.addAnnotations({string:{connectedFrom:e,workerID:t,hrpStatus:n}}),a==null||a.markPoint("worker_connection_established")});var l=new(r("Deferred"));return o("SharedWorkerEventManager").registerWorkerSelfTerminationListener(i,function(e,n,r,i){a==null||a.addAnnotations({string:{selfTerminationError:i}}),o("SharedWorkerLoggingUtils").logSelfTermination(t,e,n,r),l.reject(new c(n))},{once:!0}),p(i,t,a),i.port.start(),o("SharedWorkerEventManager").emitConnectionAckRequest(i),a==null||a.markPoint("read_dynamic_data"),r("promiseDone")(A(n,!1,a).then(function(e){var t=e.hrp;a==null||a.markEventStart("hrp_init"),o("SharedWorkerEventManager").emitHrpInit(i,{hrp:t.hrp,js_env:t.js_env,isDev:!1},a)},function(e){var t=r("getErrorSafe")(e);a==null||a.addAnnotations({string:{hrpInitErr:t.toString()}})})),o("SharedWorkerEventManager").registerExecuteWorkerAckListener(i,a,function(e){var t=e.workerSpinTime,n=e.err,i=e.isFirstInit,s=e.workerRev,u=e.workerSpinMode;o("SharedWorkerLoggingUtils").logExecuteAck(a,t,n,i,s,u),n!=null||s==null||t==null?l.reject(r("err")(n!=null?n:"no worker rev or spin time")):l.resolve({rev:s,spinTime:t})}),a==null||a.markEventStart("execute_worker"),o("SharedWorkerEventManager").emitExecuteWorker(i),l.getPromise().then(function(e){var t=e.rev,n=e.spinTime;return{worker:i,rev:t,spinTime:n}})}function f(e,t,n,a,i,l){var s=new(r("Deferred"));return o("SharedWorkerEventManager").registerGetWorkerRevListener(e,l,function(e){var u=e.rev,c=e.spinTime;r("promiseDone")(o("SharedWorkerStorageManager").saveSharedWorkerReference(n,{url:t,rev:u,spin_time:c,version:i.version,rsrcBundleUrl:i.getJSModuleBundleResource().url,sandboxOnlyChecksum:i.sandboxOnlyChecksum},l).then(function(){return o("SharedWorkerStorageManager").getSharedWorkerReference(n,l)}).then(function(e){r("logSharedWorkerInitStep")(n,e,i.resourceUrlForLogging,"after_worker_reference_save")}),function(){l.markEventEnd("get_worker_rev",{bool:{successfullySavedWorkerRef:!0}}),s.resolve(),a()},function(e){l.markEventEnd("get_worker_rev",{bool:{successfullySavedWorkerRef:!1}}),s.reject(e),r("handleWorkerWriteError")(e),a()})}),l.markEventStart("get_worker_rev"),o("SharedWorkerEventManager").emitGetRev(e),s.getPromise()}function g(e,t,n,a){a===void 0&&(a=null);var i=[],l=function(r,a,l){i.forEach(function(e){return e()}),t(r,a,l),o("SharedWorkerUptimeTracker").stopUptimeTracking(n)};i.push(o("SharedWorkerEventManager").registerForwardListeners(e)),i.push(o("SharedWorkerEventManager").registerWorkerShutdownListener(e,function(e){var t=e.reason,r=e.workerID;o("SharedWorkerLoggingUtils").logShutdown(n,null,t,r);var a=t==="dynamic_string_worker_rollback"?"requested-upgrade":t;l(a,r,"sw-shutdown")})),i.push(o("SharedWorkerEventManager").registerWorkerSelfTerminationListener(e,function(e,t,n){l(t,n,"self-terminate")})),o("SharedWorkerDevChangeManager").trackCreatedWorker(n),o("SharedWorkerUptimeTracker").startUptimeTracking(e,n),r("logSharedWorkerInitStep")(n,null,null,"create_worker_end")}function h(e,t,n,r,o,a){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a,i,l){l.addAnnotations({string:{initFlow:"use_existing_ref"}}),r("logSharedWorkerInitStep")(e,null,null,"using_existing_worker_ref");var s=o("SharedWorkerMigrationUtils").isLegacyWorkerURL(t.url),u=yield t.version===2?s?_(t.url,e,n.getJSModuleBundleResource(),l):o("SharedWorkerV2ResourceExperimental").startV2Worker(t.url,e,n.getJSModuleBundleResource(),l):d(t.url,e,n.getJSModuleBundleResource(),l),c=u.worker;return a(),t.version===2&&!s&&f(c,t.url,e,a,n,l),g(c,i,e),c}),y.apply(this,arguments)}function C(e,t,n,r){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a){n.markPoint("terminate_on_upgrade");var i=new(r("Deferred")),l=o("SharedWorkerMigrationUtils").isStatusLockHeld(e);if((yield o("SharedWorkerMigrationUtils").isDynamicStringWorkerRunning(e))&&r("supportsNativeWebLock")()&&a===!1)i.resolve(),n.addAnnotations({string:{oldWorkerShutdown:"not_needed_for_dynamic_string"}});else if(self.BroadcastChannel!=null){var s=N(e);s.postMessage({type:"terminate",reason:"requested-upgrade",pageID:r("pageID")}),i.resolve(),n.addAnnotations({string:{oldWorkerShutdown:"broadcast"}})}else if(yield l){var u;t.version===2&&r("supportsModuleWorker")(!0)?u=new SharedWorker(t.url,{name:e,type:"module"}):u=new SharedWorker(t.url,e),o("SharedWorkerEventManager").registerWorkerShutdownListener(u,function(e){var t=e.workerID,l=e.isInitialized;a?r("setTimeout")(function(){n.markEventEnd("old_worker_shutdown",{string:{oldWorkerID:t},bool:{oldWorkerWasInitialized:l}}),i.resolve()},o("SharedWorkerV2ResourceExperimental").DELAY_FOR_WORKER_SHUTDOWN_MS):(n.markEventEnd("old_worker_shutdown",{string:{oldWorkerID:t},bool:{oldWorkerWasInitialized:l}}),i.resolve()),n.addAnnotations({string:{oldWorkerShutdown:"success"}})},{once:!0}),n.markEventStart("old_worker_shutdown"),u.port.start(),o("SharedWorkerEventManager").emitWorkerShutdown(u,{upgrade:!0})}else i.resolve(),n.addAnnotations({string:{oldWorkerShutdown:"not_needed"}});a===!0?yield i.getPromise():i.resolve()}),b.apply(this,arguments)}function v(e,t,n,r,o,a,i){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,o,a,i){return a.addAnnotations({string:{initFlow:"upgrade_worker_ref"}}),yield C(e,t,a,i),L(e,n,r,o,a,"upgrading_worker_ref")}),S.apply(this,arguments)}function R(e,t,n,r,o){return o.addAnnotations({string:{initFlow:"new_worker_ref"}}),L(e,t,n,r,o,"new_worker_ref")}function L(e,t,n,r,o,a){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a,i,l){r("logSharedWorkerInitStep")(e,null,null,l),(yield o("SharedWorkerMigrationUtils").isStatusLockHeld(e))&&r("FBLogger")("worker").info("Trying to create a worker %s while old one is still running",e);var s=yield t.createSharedWorker(),u=s[0],c=s[1].worker;return l==="upgrading_worker_ref"&&(yield o("SharedWorkerStorageManager").removeSharedWorkerReference(e,i)),yield f(c,u,e,n,t,i),g(c,a,e),c}),E.apply(this,arguments)}function k(e,t){var n=o("SharedWorkerDevChangeManager").shouldUseStorageWorkerForDev(e.name,{storageWorkerResource:t,tabResource:e}),a=t.spin_time,i=t.version,l=t.rev;return l>=r("SiteData").client_revision&&(e.version===i||a>=r("SiteData")[r("StaticSiteData").spin_time_key])&&n}function I(e,t,n,r,o,a){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a,i,l){a.markEventStart("create_worker");var s=e.name;o("SharedWorkerUptimeTracker").stopUptimeTracking(s),a.addAnnotations({bool:{workerAlreadyRunning:r("supportsNativeWebLock")()?yield o("SharedWorkerMigrationUtils").isStatusLockHeld(s):null}});var u=r("supportsNativeWebLock")()?yield o("SharedWorkerMigrationUtils").isStatusLockHeld(s):!0;if(!i&&e.version===2)return U(e,t,n,a,l);var c=yield o("SharedWorkerStorageManager").getSharedWorkerReference(s,a);r("logSharedWorkerInitStep")(s,c,e.resourceUrlForLogging,"create_worker_start");var d=c!=null&&o("SharedWorkerMigrationUtils").isLegacyWorkerURL(c==null?void 0:c.url),m=i&&u===!1&&d;if(c==null||m)return R(s,e,t,n,a);var p=c.spin_time,_=c.version,f=c.rev;return a.addAnnotations({int:{storageWorkerSpinTime:p,storageWorkerVersion:_,storageWorkerRev:f}}),k(e,c)?h(s,c,e,t,n,a):v(s,c,e,t,n,a,i)}),T.apply(this,arguments)}function D(e,t,a){var i=a!=null?a:{},l=i.onQPLEvent,s=i.reason,u=e.name,c=r("buildSharedWorkerInitQPLLogger")(l);c.start({version:1,workerName:u,callReason:s});var m=new(r("Deferred"));return o("SharedWorkerLockManager").withWorkerLock(function(o){var a;r("promiseDone")(I({name:u,version:1,resourceUrlForLogging:(a=e.url)!=null?a:"",getJSModuleBundleResource:function(){return e},createSharedWorker:(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=r("createSharedWorkerBundleUrl")();return[t,yield d(t,u,e,c)]});function o(){return t.apply(this,arguments)}return o})()},o,t,c,!1),function(e){c.markEventEnd("create_worker"),c.endSuccess(),m.resolve(e)},function(e){var t=typeof e=="string"?r("err")(e):e;c.endFailure("worker_init_failure",{string:{workerInitFailureReason:t.message,errorName:t.name}}),m.reject(t),o()})},{workerQPLLogger:c,onLockTimeout:function(){return m.reject(r("err")("Worker lock timeout"))}}),m.getPromise()}function x(t,a,i,l){l===void 0&&(l=0);var s=t.name,u=i!=null?i:{},d=u.onQPLEvent,m=u.reason,p=r("buildSharedWorkerInitQPLLogger")(d);p.start({version:2,workerName:s,callReason:m,experimental_init:i==null?void 0:i.useDynamicStringInit}),p.addAnnotations({bool:{usingModuleWorker:r("supportsModuleWorker")(!0)}});var f=new(r("Deferred")),g=function(u){r("promiseDone")(I({name:s,version:2,getJSModuleBundleResource:function(){return t},sandboxOnlyChecksum:t.sandboxOnlyChecksum,createSharedWorker:(i==null?void 0:i.useDynamicStringInit)===!0?n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=r("createSharedWorkerV2BundleUrlExperimental")(s);return[e,yield o("SharedWorkerV2ResourceExperimental").startV2Worker(e,s,t,p)]}):n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("createSharedWorkerV2BundleUrl").createSharedWorkerV2BundleUrl();return[e,yield _(e,s,t,p)]})},u,a,p,(i==null?void 0:i.useDynamicStringInit)===!0,l),function(e){p.markEventEnd("create_worker"),p.endSuccess(),f.resolve(e)},function(e){var t=typeof e=="string"?r("err")(e):e;f.reject(t),u()})};return o("SharedWorkerLockManager").withWorkerLock(g,{workerQPLLogger:p,onLockTimeout:function(){return f.reject(r("err")("Worker lock timeout"))},onLockFail:function(t){f.reject(t)}}),f.getPromise().catch(function(o){if(o instanceof c&&l<2)return p.endCancel({string:{workerInitCancelReason:o.message},int:{workerInitRetry:l}}),new(e||(e=n("Promise")))(function(e,n){r("setTimeout")(function(){r("promiseDone")(x(t,a,i,l+1),e,n)},l===0?200:500)});throw p.endFailure("worker_init_failure",{string:{workerInitFailureReason:o.message,errorName:o.name}}),o})}function $(e,t,n){return P.apply(this,arguments)}function P(){return P=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i){var l=a!=null?a:t.name,u=new(r("Deferred")),c=r("buildSharedWorkerTerminateQPLLogger")();if(c.start({workerName:l}),r("promiseDone")(r("supportsNativeWebLock")()?o("SharedWorkerMigrationUtils").isStatusLockHeld(l):(e||(e=n("Promise"))).resolve(void 0),function(e){return c.addAnnotations({bool:{workerAlreadyRunning:e}})}),c.addAnnotations({string:{reason:i,terminatingPageId:r("pageID")}}),self.BroadcastChannel!=null){var m=N(l);return m.postMessage({type:"terminate",reason:i,pageID:r("pageID")}),r("promiseDone")(o("SharedWorkerStorageManager").removeSharedWorkerReference(l,c).then(function(){c.endSuccess(),u.resolve()})),u.getPromise()}return o("SharedWorkerLockManager").withWorkerLock(function(a){r("promiseDone")(o("SharedWorkerStorageManager").getSharedWorkerReference(l,c).then(function(a){if(c.markPoint("read_worker_reference",{int:{storageWorkerVersion:a==null?void 0:a.version},bool:{storageReferenceExists:a!=null}}),a!=null){var i=o("SharedWorkerMigrationUtils").isLegacyWorkerURL(a.url);c.addAnnotations({bool:{isLegacy:i}});var s=a.version===2?i?_(a.url,l,t,void 0).then(function(e){var t=e.worker;return t}):o("SharedWorkerV2ResourceExperimental").startV2Worker(a.url,l,t,void 0).then(function(e){var t=e.worker;return t}):d(a.url,l,t).then(function(e){var t=e.worker;return t}),u=r("justknobx")._("3569")?(e||(e=n("Promise"))).resolve(null):o("SharedWorkerStorageManager").removeSharedWorkerReference(l,c);return u.then(function(){return s})}return c.markPoint("storage_resource_empty"),null}),function(t){try{if(a(),o("SharedWorkerUptimeTracker").stopUptimeTracking(l),t==null){c.endSuccess(),u.resolve();return}o("SharedWorkerEventManager").registerWorkerShutdownListener(t,function(t){var a=t.workerID,i=t.isInitialized;c.markPoint("worker_shut_down",{string:{workerID:a},bool:{wasInitialized:i}});var s=r("justknobx")._("3569")?o("SharedWorkerStorageManager").removeSharedWorkerReference(l,c):(e||(e=n("Promise"))).resolve(null);r("promiseDone")(s,function(){return c.endSuccess()},function(e){c.endFailure("failed_to_remove_worker_reference",{string:{errorDescription:e.toString()}})}),u.resolve()},{once:!0}),o("SharedWorkerEventManager").emitWorkerShutdown(t,{reason:i})}catch(e){c.endFailure("terminate_worker_failure",{string:{workerTerminateFailReason:e.message}}),u.reject(e.message)}},function(e){r("FBLogger")("worker").catching(r("getErrorSafe")(e)).mustfix("Failed to terminate worker"),c.endFailure("connect_to_worker_failure",{string:{workerTerminateFailReason:e.message}}),u.reject(e.message),a()})},{workerQPLLogger:c}),r("setTimeout")(function(){return u.reject()},s),u.getPromise()}),P.apply(this,arguments)}function N(e){return new self.BroadcastChannel(u+"_"+e)}function M(e){return w.apply(this,arguments)}function w(){return w=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("SharedWorkerStorageManager").getSharedWorkerReference(e.name);return t!=null}),w.apply(this,arguments)}function A(e,t,n){return F.apply(this,arguments)}function F(){return F=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a;n==null||n.markEventStart("load_hrp");var i=yield o("WebWorkerV2DynamicData").readDynamicDataForWorker(e,t),l=i.data,s=i.time;n==null||n.markEventEnd("load_hrp");try{var u,c=r("justknobx")._("1979");n==null||n.markEventStart("prefetch_worker_scripts",{bool:{prefetchWorkerScripts:c},int:{resourcesCount:(u=l.hrp.allResources)==null?void 0:u.length}}),c&&o("BootloaderPreloader").preloadWorkerJSFromHRP(l.hrp)}catch(t){var d=r("getErrorSafe")(t);n==null||n.markPoint("prefetch_worker_scripts_fail",{string:{hrpInitErr:d.toString()}}),r("FBLogger")("worker").catching(d).warn("Failed to preload worker %s JS from HRP",e.name)}return n==null||n.markEventEnd("prefetch_worker_scripts"),{hrp:l,time:s,rev:(a=l.hrp.hsrp)==null||(a=a.hblp)==null||(a=a.consistency)==null?void 0:a.rev}}),F.apply(this,arguments)}function O(e,t,n,r){return o("SharedWorkerStorageManager").getOrUpdateWorkerReference(e.name,function(o){if(n.markPoint("worker_reference_retrieved"),o==null)return t;var a=r!=null&&r>0&&B();return!a&&k(e,o)?o:(C(e.name,o,n,!1),t)},n)}function B(){return r("qex")._("3999")===!0}function W(e,t){if(self.BroadcastChannel!=null){var n=N(e),o=function(n){var e=n.data;if(typeof e=="object"&&(e==null?void 0:e.type)==="terminate"){var o=typeof e.reason=="string"?e.reason:"unknown",a=typeof e.pageID=="string"?e.pageID:null;if(a!=null&&a===r("pageID")&&o==="requested-upgrade")return;t(o)}};return n.addEventListener("message",o),function(){return n.removeEventListener("message",o)}}return function(){}}function q(e,t,n,a){var i=new(r("Deferred"));return o("SharedWorkerStorageManager").getOrUpdateWorkerReference(e,function(e){return e==null||e.url!==t?(i.resolve("url-was-changed"),e):e.rev!==n||e.spin_time!==a?babelHelpers.extends({},e,{rev:n,spin_time:a}):e}).then(function(){i.resolve("success")}),i.getPromise()}function U(e,t,n,r,o){return V.apply(this,arguments)}function V(){return V=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i,l,s){if(t.version!==2)throw r("err")("Worker version must be 2");var u=t.name,d=yield A(t.getJSModuleBundleResource(),!1,l),_=d.rev;if(_==null)throw r("err")("HRP rev or spin time is null");var f={url:o("createSharedWorkerV2BundleUrl").createSharedWorkerV2BundleUrl(),rev:_,spin_time:d.time,version:t.version,rsrcBundleUrl:t.getJSModuleBundleResource().url,sandboxOnlyChecksum:t.sandboxOnlyChecksum},h=new(r("Deferred")),y=new(r("Deferred")),C=[];try{var b=function(t){y.reject(t),h.reject(t)};C.push(W(u,function(e){b(new c("broadcast-"+e))})),l==null||l.markEventStart("get_worker_reference");var v=yield O(t,f,l,s);l==null||l.markEventEnd("get_worker_reference");var S=m(v.url,u,l);C.push(o("SharedWorkerEventManager").registerConnectionAckListener(S,function(e,t,n){l==null||l.addAnnotations({string:{connectedFrom:e,workerID:t}}),h.resolve({hrpStatus:n!=null?n:"no-hrp",workerID:t})})),C.push(o("SharedWorkerEventManager").registerWorkerSelfTerminationListener(S,function(e,t,n,r){l==null||l.addAnnotations({string:{selfTerminationError:r}}),o("SharedWorkerLoggingUtils").logSelfTermination(u,e,t,n),b(new c(t))},{once:!0})),C.push(o("SharedWorkerEventManager").registerWorkerShutdownListener(S,function(e){var t=e.reason,n=e.workerID;o("SharedWorkerLoggingUtils").logShutdown(u,null,t,n),b(new c(t!=null?t:"sw-shutdown-unknown"))})),C.push.apply(C,p(S,u,l)),l.markEventStart("worker_connection"),S.port.start(),o("SharedWorkerEventManager").emitConnectionAckRequest(S);var R=yield h.getPromise(),L=R.hrpStatus,E=R.workerID;if(l.markEventEnd("worker_connection"),L==="no-hrp"){l==null||l.markPoint("read_dynamic_data");var k=f.rev>=v.rev,I=k?(e||(e=n("Promise"))).resolve(d):A(t.getJSModuleBundleResource(),!0,l);r("promiseDone")(I.then(function(e){l==null||l.markEventStart("hrp_init"),o("SharedWorkerEventManager").emitHrpInit(S,{hrp:e.hrp.hrp,js_env:e.hrp.js_env,isDev:!1},l)},function(e){var t=r("getErrorSafe")(e);l==null||l.markPoint("hrp_init_fail",{string:{hrpInitErr:t.toString()}}),b(t)}))}C.push(o("SharedWorkerEventManager").registerExecuteWorkerAckListener(S,l,function(e){var t=e.workerSpinTime,n=e.err,a=e.isFirstInit,i=e.workerRev,s=e.workerSpinMode;o("SharedWorkerLoggingUtils").logExecuteAck(l,t,n,a,i,s),n!=null||t==null||i==null?y.reject(r("err")(n!=null?n:"no worker rev or spin time")):y.resolve({workerRev:i,workerSpinTime:t})})),l==null||l.markEventStart("execute_worker"),o("SharedWorkerEventManager").emitExecuteWorker(S);var T=yield y.getPromise(),D=T.workerRev,x=T.workerSpinTime;l==null||l.markEventStart("update_worker_ref");var $=yield q(u,v.url,D,x);if(l==null||l.markEventEnd("update_worker_ref",{string:{updateWorkerRef:$}}),$==="url-was-changed")throw o("SharedWorkerEventManager").emitWorkerShutdown(S,{reason:"url-was-changed"}),new c("url-was-changed");return a(),g(S,i,u,E),S}finally{C.forEach(function(e){return e()})}}),V.apply(this,arguments)}l.SHARED_WORKER_BROADCAST_CHANNEL=u,l.SelfTerminationError=c,l.createPushSafeSharedWebWorkerAsync=D,l.createPushSafeSharedWebWorkerV2Async=x,l.terminateSharedWorker=$,l.doesSharedWorkerReferenceExist=M}),98);
__d("SharedWorkerV2ResourceExperimental",["Deferred","Promise","SharedWorkerBundleResource","SharedWorkerDevChangeManager","SharedWorkerEventManager","SharedWorkerLoggingUtils","SharedWorkerMigrationUtils","SharedWorkerUptimeTracker","SiteData","StaticSiteData","TrustedTypesWebWorkerScriptURLPolicy","asyncToGeneratorRuntime","buildSharedWorkerInitQPLLogger","buildSharedWorkerTerminateQPLLogger","createSharedWorkerV2BundleUrlExperimental","justknobx","pageID","promiseDone","setTimeout","supportsModuleWorker","supportsNativeWebLock"],(function(t,n,r,o,a,i,l){"use strict";var e,s=50,u=5e3,c=2e3;function d(e,t,n,a){return o("SharedWorkerDevChangeManager").shouldUpgradeWorkerForDevExperimental(e)&&!a?!0:t<r("SiteData").client_revision&&n<r("SiteData")[r("StaticSiteData").spin_time_key]}function m(e,t,n){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i){var l=t.name,u=r("buildSharedWorkerInitQPLLogger")(i==null?void 0:i.onQPLEvent);u.start({version:2,workerName:l,experimental_init:!0,callReason:i==null?void 0:i.reason,migrationEnabled:!0}),u.markEventStart("create_worker"),r("supportsNativeWebLock")()&&r("promiseDone")(o("SharedWorkerMigrationUtils").isStatusLockHeld(l).then(function(e){u.addAnnotations({bool:{workerAlreadyRunning:e}})})),(i==null?void 0:i.migratedWorker)===!0&&(yield o("SharedWorkerMigrationUtils").checkStorageAndTerminateLegacyWorker({name:l,logger:u}));var c=yield _(t,u),d=c.worker,m=c.needsUpgrade;return new(e||(e=n("Promise")))(function(e,n){var i=function(n){return e(g(n,l,u,a))};m?(o("SharedWorkerEventManager").registerWorkerShutdownListener(d,function(e){var n=e.workerID,o=e.isInitialized;u.markEventEnd("old_worker_shutdown",{string:{oldWorkerID:n},bool:{oldWorkerWasInitialized:o}}),r("setTimeout")(function(){return _(t,u).then(function(e){var t=e.worker;return i(t)})},s)},{once:!0}),u.markEventStart("old_worker_shutdown"),o("SharedWorkerEventManager").emitWorkerShutdown(d,{upgrade:!0})):i(d)})}),p.apply(this,arguments)}function _(e,t){var n=e.name,a=r("createSharedWorkerV2BundleUrlExperimental")(n),i=r("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(a),l=r("supportsModuleWorker")(!0)?"module":"classic",s=new SharedWorker(i,{name:n,type:l}),u=new Set;o("SharedWorkerEventManager").registerWorkerInitPointsListener(s,function(e){u.has(e)||(u.add(e),t==null||t.markPoint("worker_init_point_"+e))});var c=new(r("Deferred"));return o("SharedWorkerEventManager").registerGetWorkerRevListener(s,t,function(r){var o=r.rev,a=r.spinTime,i=r.workerChecksum,l=d(n,o,a,e.sandboxOnlyChecksum===i);c.resolve(l),l?t.addAnnotations({int:{oldWorkerRev:o,oldWorkerSpinTime:a}}):t.addAnnotations({int:{workerRev:o,workerSpinTime:a}})}),f(s,n,t),s.port.start(),o("SharedWorkerEventManager").emitConnectionAckRequest(s),c.getPromise().then(function(e){return{worker:s,needsUpgrade:e}})}function f(e,t,n,r){return e.addEventListener("error",function(e){o("SharedWorkerLoggingUtils").logSharedWorkerError(n,e,t)}),o("SharedWorkerEventManager").registerForwardListeners(e),o("SharedWorkerEventManager").registerWorkerSelfTerminationListener(e,function(e,t,r,o){n.endFailure("worker_init_failure",{string:{selfTerminationError:o,selfTerminationReason:t}})},{once:!0}),o("SharedWorkerEventManager").registerConnectionAckListener(e,function(e,t){n==null||n.addAnnotations({string:{connectedFrom:e,workerID:t}}),n==null||n.markPoint("worker_connection_established")},{once:!0}),e}function g(e,t,n,a){return o("SharedWorkerEventManager").registerWorkerShutdownListener(e,function(e){var n=e.reason,i=e.workerID;o("SharedWorkerLoggingUtils").logShutdown(t,null,n,i),n==="requested-upgrade"?r("setTimeout")(function(){return a==null?void 0:a(n,i)},1e3):n==="dynamic_string_worker_rollback"?a==null||a("maw_request_refresh",i):a==null||a(n,i),o("SharedWorkerUptimeTracker").stopUptimeTracking(t)}),n.markEventEnd("create_worker"),n.endSuccess(),o("SharedWorkerUptimeTracker").startUptimeTracking(e,t),o("SharedWorkerDevChangeManager").trackCreatedWorker(t),e}function h(t,a,i,l,s){s===void 0&&(s=0);var u=i.name,d=r("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(t),m=r("supportsModuleWorker")(!0)?"module":"classic",p=new SharedWorker(d,{name:u,type:m});l==null||l.markPoint("shared_worker_construct_done"),l==null||l.addAnnotations({string:{workerUrl:d.toString()}});var _=new(r("Deferred")),f=[];f.push(o("SharedWorkerEventManager").registerConnectionAckListener(p,function(e,t){l==null||l.addAnnotations({string:{connectedFrom:e,workerID:t}}),l==null||l.markPoint("worker_connection_established"),_.resolve()},{once:!0})),f.push(o("SharedWorkerEventManager").registerWorkerInitPointsListener(p,function(e){l==null||l.markPoint("worker_init_point_"+e)})),f.push(o("SharedWorkerEventManager").registerForwardListeners(p)),o("SharedWorkerEventManager").emitConnectionAckRequest(p),p.addEventListener("error",function(e){o("SharedWorkerLoggingUtils").logSharedWorkerError(l,e,a)});var g=new(r("Deferred"));return f.push(o("SharedWorkerEventManager").registerGetWorkerRevListener(p,l,function(e){var t=e.rev,n=e.spinTime;l==null||l.addAnnotations({int:{initialWorkerRev:t,initialSpinTime:n}}),g.resolve({worker:p,rev:t,spinTime:n})})),f.push(o("SharedWorkerEventManager").registerWorkerSelfTerminationListener(p,function(e,t,n,r){l==null||l.addAnnotations({string:{selfTerminationError:r}}),o("SharedWorkerLoggingUtils").logSelfTermination(a,e,t,n),g.reject(new(o("SharedWorkerBundleResource")).SelfTerminationError(t))},{once:!0})),f.push(o("SharedWorkerEventManager").registerWorkerShutdownListener(p,function(e){var t=e.reason,n=e.workerID;l==null||l.addAnnotations({string:{shutdownReason:t}}),o("SharedWorkerLoggingUtils").logShutdown(a,null,t,n),g.reject(new(o("SharedWorkerBundleResource")).SelfTerminationError(t!=null?t:"unknownShutdown"))},{once:!0})),p.port.start(),s===0&&r("justknobx")._("1707")&&(e||(e=n("Promise"))).race([_.getPromise().then(function(){return"success"}),new e(function(e){r("setTimeout")(function(){e("timeout")},c)})]).then(function(e){if(e==="timeout"){var n=p,r=h(t,a,i,l,s+1);r.then(function(e){return g.resolve(e)}),f.forEach(function(e){return e()}),n.port.close()}}),g.getPromise()}function y(e,t){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=e.name,a=new(r("Deferred")),i=yield o("SharedWorkerMigrationUtils").isStatusLockHeld(n),l=r("buildSharedWorkerTerminateQPLLogger")();if(!i){l.start({workerName:n}),l.markPoint("no_worker_running"),l.endSuccess();return}l.start({workerName:n}),l.addAnnotations({string:{reason:t,terminatingPageId:r("pageID")}});var s=r("createSharedWorkerV2BundleUrlExperimental")(n),c=r("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(s),d=r("supportsModuleWorker")(!0)?"module":"classic",m=new SharedWorker(c,{workerName:n,type:d});return l.markPoint("worker_created"),o("SharedWorkerEventManager").registerWorkerShutdownListener(m,function(e){var t=e.workerID;l.markPoint("worker_shut_down",{string:{workerID:t}}),l.endSuccess(),o("SharedWorkerUptimeTracker").stopUptimeTracking(n),a.resolve()},{once:!0}),m.port.start(),o("SharedWorkerEventManager").emitWorkerShutdown(m,{reason:t}),r("setTimeout")(function(){return a.reject()},u),a.getPromise()}),C.apply(this,arguments)}l.DELAY_FOR_WORKER_SHUTDOWN_MS=s,l.createPushSafeSharedWebWorkerV2Async=m,l.startV2Worker=h,l.terminateSharedWorker=y}),98);
__d("WebWorkerV2Resource",["TrustedTypesWebWorkerScriptURLPolicy","WebWorkerV2DynamicData","XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder","forEachObject","getAsyncParamsFromCurrentPageURI","getWorkerInitScriptSPINParams","nullthrows","promiseDone","supportsModuleWorker"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){var a=t!=null?t:e.name,i=r("supportsModuleWorker")(!1)&&n!==!0?"module":"classic",l=r("getWorkerInitScriptSPINParams")();r("forEachObject")(r("getAsyncParamsFromCurrentPageURI")(),function(e,t){l.set(t,e)});var s=r("nullthrows")(r("XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder").buildUri({worker_type:r("supportsModuleWorker")(!1)&&n!==!0?"MODULE":"CLASSIC"}).addQueryParams(l)).toString(),u=r("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(s),c=new Worker(u,{name:a,type:i});return r("promiseDone")(o("WebWorkerV2DynamicData").readDynamicDataForWorker(e).then(function(e){var t=e.data;c.postMessage({type:"ww-hrp-init",hrp:t.hrp,js_env:t.js_env,is_dev:!1,tiered:!0})})),{worker:c,url:u.toString()}}l.createDedicatedV2WebWorker=e}),98);
__d("MAWWebWorkerSingleton",["Deferred","MAWInit","MAWMIC","MAWStartupLoggingUtils","MAWWaitForBackendSetup","MAWWorkerWatchdogRecovery","Promise","SharedWorkerBundleResource","SharedWorkerMigrationUtils","SharedWorkerV2ResourceExperimental","WAResolvable","WebWorkerV2Resource","clearTimeout","cr:6600","err","gkx","promiseDone","setTimeout","shouldUseMAWSharedWorker"],(function(t,n,r,o,a,i,l){"use strict";var e,s=null,u=function(t){s=t},c=function(){return s},d=g,m=new(o("WAResolvable")).Resolvable,p=null;function _(){return o("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()?o("SharedWorkerMigrationUtils").isStatusLockHeld(n("cr:6600").name):(e||(e=n("Promise"))).resolve(p!==null)}function f(){var t={isSharedWorker:o("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker(),nativeLocksSupported:o("SharedWorkerMigrationUtils").supportsNativeWebLocks(),workerCreationPromiseExists:p!==null};if(t.isSharedWorker!==!0)return(e||(e=n("Promise"))).resolve(t.workerCreationPromiseExists===!0?{data:t,tag:"dedicated_exists"}:{data:t,tag:"dedicated_not_exists"});if(t.nativeLocksSupported!==!0)return(e||(e=n("Promise"))).resolve({data:t,tag:"shared_unknown_locks_not_supported"});var r=o("MAWWaitForBackendSetup").getCurrentWorkerID();return(e||(e=n("Promise"))).all([o("SharedWorkerMigrationUtils").isStatusLockHeld(n("cr:6600").name),r!=null?o("SharedWorkerMigrationUtils").isWorkerIdStatusLockHeld(n("cr:6600").name,r):(e||(e=n("Promise"))).resolve(!1)]).then(function(e){var n=e[0],r=e[1];return t.sharedLockHeld=n,t.workerIdLockHeld=r,n&&r?{data:t,tag:"shared_exists_and_connected"}:n?{data:t,tag:"shared_exists_not_connected"}:r?{data:t,tag:"shared_only_unique_lock_held"}:{data:t,tag:"shared_not_exists"}})}function g(){p=null}function h(e){return p?(o("MAWMIC").addPoint(e+"_wait_on_worker_creation"),o("MAWInit").MAWInit.logPoint(e+"_wait_on_worker_creation"),p):(o("MAWInit").MAWInit.logPoint(e+"_create_worker_start"),o("MAWMIC").addPoint(e+"_create_worker_start"),p=(o("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()?y(e):C().then(function(e){return{worker:e,workerID:"dedicated"}})).then(function(t){var n=t.worker,r=t.workerID;return o("MAWMIC").addPoint(e+"_create_worker_end"),o("MAWInit").MAWInit.logPoint(e+"_create_worker_end"),{worker:n,workerID:r}},function(e){throw p=null,e}),p)}function y(e){var t=function(t,n,o){r("promiseDone")(m.promise.then(function(){return d(t,n,o)}))};o("MAWWorkerWatchdogRecovery").setRecoveryForWatchdog(t);var a=new(r("Deferred")),i=r("gkx")("7313");o("MAWMIC").addBoolAnnotation("migrationEnabled",i);var l=i?o("SharedWorkerV2ResourceExperimental").createPushSafeSharedWebWorkerV2Async(n("cr:6600"),t,{migratedWorker:!0,onQPLEvent:o("MAWStartupLoggingUtils").logSharedWorkerQPLEvents,reason:e}):o("SharedWorkerBundleResource").createPushSafeSharedWebWorkerV2Async(n("cr:6600"),t,{onQPLEvent:o("MAWStartupLoggingUtils").logSharedWorkerQPLEvents,reason:e,useDynamicStringInit:r("gkx")("8737")});return l.then(function(e){u(e),o("MAWMIC").addPoint("shared_worker_bundle_created");var t=r("setTimeout")(function(){o("MAWMIC").addPoint("shared_worker_connection_ack_timeout"),a.reject(r("err")("Worker connection ack timeout"))},1e4),n=function(n){var e,i,l;if(typeof n.data=="object"&&((e=n.data)==null?void 0:e.type)==="connection-ack"&&typeof((i=n.data)==null?void 0:i.response)=="object"&&typeof((l=n.data)==null||(l=l.response)==null?void 0:l.from)=="string"){var s,u,c=typeof((s=n.data)==null||(s=s.response)==null?void 0:s.workerID)=="string"?(u=n.data)==null||(u=u.response)==null?void 0:u.workerID:void 0;c!=null?(o("MAWMIC").addPoint("shared_worker_workerID_received"),o("MAWMIC").addStringAnnotation("workerID",c),t!=null&&r("clearTimeout")(t),a.resolve(c)):(o("MAWMIC").addPoint("shared_worker_null_workerID_received"),o("MAWMIC").addStringAnnotation("workerID","unknown"))}};return e.port.addEventListener("message",n),e.port.postMessage({type:"ww-connection-ack"}),e.addEventListener("error",function(e){o("MAWStartupLoggingUtils").logWorkerError("Shared Worker",e,"")}),a.getPromise().then(function(t){return{worker:e.port,workerID:t}})})}function C(){return(e||(e=n("Promise"))).resolve(o("WebWorkerV2Resource").createDedicatedV2WebWorker(n("cr:6600"))).then(function(e){var t=e.url,n=e.worker;return n.onerror=function(e){return o("MAWStartupLoggingUtils").logWorkerError("Dedicated Worker",e,t)},o("MAWStartupLoggingUtils").setImportScriptsErrorListener(n),n})}function b(e){d=e,m.resolve()}l.getSharedWorkerInstance__TEST_ONLY=c,l.doesWorkerExist=_,l.getWorkerHealthStatus=f,l.resetWorkerCreation=g,l.createWorkerIfNone=h,l.setOnCloseForWorkerInstance=b}),98);
__d("MAWWaitForBackendSetup",["ErrorSerializer","MAWInit","MAWInitError","MAWMIC","MAWSetupWorkerAuxStateForLogging","MAWWebWorkerSingleton","Promise","err","promiseDone","waitForMAWMIC"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=new(e||(e=n("Promise")))(function(e,t){s=e,u=t}),d=!1,m=!1,p=!1,_=!1,f=null,g=s,h=u;function y(t){return new(e||(e=n("Promise")))(function(e,n){o("waitForMAWMIC").promise.then(function(){return c}).then(e).catch(function(e){var a=t+" rejected because backend setup failed: "+e.message+".",i=e instanceof o("MAWInitError").MAWInitError?e.error:null;i!=null&&(a=a.concat(" More error detail: "+r("ErrorSerializer").toReadableMessage(i))),n(r("err")(a))})})}function C(t){return new(e||(e=n("Promise")))(function(e,n){c.then(e).catch(function(e){var a=t+" rejected because backend setup failed: "+e.message+".",i=e instanceof o("MAWInitError").MAWInitError?e.error:null;i!=null&&(a=a.concat(" More error detail: "+r("ErrorSerializer").toReadableMessage(i))),n(r("err")(a))})})}function b(e,t){r("promiseDone")(C(t).then(function(){e()}))}function v(){_&&(c=new(e||(e=n("Promise")))(function(e,t){s=e,u=t}),_=!1,d=!1,g=s,h=u,m=!0,p=!1)}function S(e){d=!0,_=!0,p=!1,g==null||g(e)}function R(e){d=!1,_=!0,p=!1,h==null||h(e)}function L(){return d}function E(){return _}function k(){return m}function I(e){e!=null&&f!==e&&o("MAWSetupWorkerAuxStateForLogging").resetWorkerCreationTime(),f=e}function T(e){f==null||f!==e||D()}function D(){f=null,o("MAWWebWorkerSingleton").resetWorkerCreation(),v(),o("MAWInit").MAWInit.logPoint("reset_current_worker"),o("MAWMIC").addPoint("reset_current_worker")}function x(){return f}function $(){p=!0}function P(){return p}l.waitForMICSetup=y,l.waitForBackendSetup=C,l.runAfterBackendSetup=b,l.resetBackendSetup=v,l.resolveBackendSetup=S,l.rejectBackendSetup=R,l.isBackendSetupSuccessful=L,l.isBackendSetupSettled=E,l.wasBackendSetupReset=k,l.setCurrentWorker=I,l.resetCurrentWorkerWithId=T,l.resetCurrentWorkerSkipIdCheck=D,l.getCurrentWorkerID=x,l.markBackendSetupStarted=$,l.isBackendSetupInProgress=P}),98);
__d("MAWWorkerEvent",["FBLogger","MAWMIC","MAWReliabilityMonitor","MAWSetupWorkerAuxStateForLogging","MAWTrackPendingOccamadilloThreads","MAWWaitForBackendSetup","MultipleTabsLogger","QPLUserFlow","getErrorSafe","pageID","performanceNow","promiseDone","qpl","requireDeferred","shouldUseMAWSharedWorker"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("requireDeferred")("MAWBridgeObserver").__setRef("MAWWorkerEvent"),u=r("requireDeferred")("MAWWebWorkerSingleton").__setRef("MAWWorkerEvent"),c=new Set,d=new Set(["addEbUploadTrackingWorkerQPL","addMediaDownloadQpl","searchGetFTSRestoreSessionId","none"]),m=new Set(["bulkMaybeCreateOrUpdateThread","createOrUpdateThread"]),p=new Map,_=function(t){switch(t){case"sendAndReceive":return 1e4;case"fireAndForget":return 4e3;case"waitUntilCompleted":return 1e4;case"waitUntilPersisted":return 1e4;default:return 1e4}},f=function(n,o,a){var t=window.setTimeout(function(){E(n,"ack_timeout"),r("promiseDone")(s.load().then(function(t){t.notifyUnackedEvent({route:o,timestamp:(e||(e=r("performanceNow")))()})}))},_(a));return p.set(n,t),t},g=function(t){var e=p.get(t);e!=null&&(window.clearTimeout(e),r("promiseDone")(s.load().then(function(e){e.resetUnackedMessages()})),p.delete(t))};function h(e,t,n){c.has(n)||d.has(t)||(c.add(n),r("QPLUserFlow").start(r("qpl")._(1056842055,"807"),{annotations:{bool:{duringMIC:o("MAWMIC").duringMIC(),useSharedWorker:o("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker(),workerTerminatedPermanently:o("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.workerTerminatedPermanently},int:{key:n},string:{callType:e,event:t,pageID:r("pageID"),workerHeartbeatsOnStart:o("MAWSetupWorkerAuxStateForLogging").getHeartbeatHistoryAsString(),workerID:o("MAWWaitForBackendSetup").getCurrentWorkerID()},string_array:{worker_restart_msgs:o("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartMessageTypes,worker_restart_reasons:o("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartReasons}},instanceKey:n}),o("MultipleTabsLogger").hasMultipleTabs().then(function(e){r("QPLUserFlow").addAnnotations(r("qpl")._(1056842055,"807"),{bool:{isMultiTabs:e}},{instanceKey:n})}),u.load().then(function(e){return e.getWorkerHealthStatus().then(function(e){r("QPLUserFlow").addAnnotations(r("qpl")._(1056842055,"807"),{string:{workerHealthStatusOnStart:e.tag}})})}))}function y(e){c.has(e)&&(c.delete(e),r("QPLUserFlow").endSuccess(r("qpl")._(1056842055,"807"),{instanceKey:e}))}function C(e,t){c.has(e)&&(c.delete(e),r("QPLUserFlow").endFailure(r("qpl")._(1056842055,"807"),"fail",{annotations:{bool:{workerTerminatedPermanently:o("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.workerTerminatedPermanently},string:{error:t},string_array:{worker_restart_msgs:o("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartMessageTypes,worker_restart_reasons:o("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartReasons}},instanceKey:e}))}function b(e,t,n){c.has(e)&&(c.delete(e),r("QPLUserFlow").endFailure(r("qpl")._(1056842055,"807"),"timeout",{annotations:{bool:{workerTerminatedPermanently:o("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.workerTerminatedPermanently},string:{error:t,workerHealthStatus:n.tag},string_array:{worker_restart_msgs:o("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartMessageTypes,worker_restart_reasons:o("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartReasons}},instanceKey:e}))}function v(e,t){c.has(e)&&r("QPLUserFlow").addAnnotations(r("qpl")._(1056842055,"807"),t,{instanceKey:e})}function S(e,t){if(c.has(e))try{if(Array.isArray(t)){var n,a=t.every(function(e){return typeof e=="object"&&e!=null&&"state"in e&&e.state===o("MAWReliabilityMonitor").HealthReportState.OK.valueOf()}),i=t.reduce(function(e,t){return typeof t=="object"&&t!=null&&"state"in t&&"identifier"in t&&"reason"in t&&t.state!==o("MAWReliabilityMonitor").HealthReportState.OK.valueOf()&&typeof t.state=="string"&&typeof t.reason=="string"&&typeof t.identifier=="string"&&e.push([t.identifier,t.state,t.reason].join(":")),e},[]);v(e,{bool:{workerHealthStatus:a},string:{error:(n=i[0])!=null?n:void 0},string_array:{errors:i}})}}catch(e){return r("FBLogger")("messenger_web").catching(r("getErrorSafe")(e)).mustfix("Failed to log ack result annotations"),!1}}function R(e,t,n){if(typeof n=="object"&&typeof(n==null?void 0:n.timestamp)=="number"){var r=n.payload;g(e),E(e,"ack"),S(e,r),m.has(t)&&o("MAWTrackPendingOccamadilloThreads").markBridgeCallAcked()}}function L(e,t,n){d.has(t)||f(e,t,n),E(e,"send")}function E(e,t,n){c.has(e)&&r("QPLUserFlow").addPoint(r("qpl")._(1056842055,"807"),t,{instanceKey:e,timestamp:n})}l.getUnackedEventTimeout=_,l.logStart=h,l.logSuccess=y,l.logFailure=C,l.logTimeoutFailure=b,l.logAnnotations=v,l.logAck=R,l.logSend=L}),98);
__d("MAWBridgeLoggingUtils",["MAWWorkerEvent","ODS","Random","WAHashStringToNumber"],(function(t,n,r,o,a,i,l){"use strict";var e,s=3185,u="armadillo_worker_runtime",c="getWorkerHeartbeat",d=10,m=new Array(d);function p(t,n,r){(e||(e=o("ODS"))).bumpEntityKey(s,u,t+"_"+n+"_"+r)}function _(e){return o("WAHashStringToNumber").hashStringToNumber(e+Math.round(o("Random").random()*1e4)+1e4)}function f(t,n,r,a){p(n,r,"start"),r!==c&&((e||(e=o("ODS"))).bumpEntityKey(s,u,"route_start"),o("MAWWorkerEvent").logStart(t,r,a),m.length===d&&m.shift(),m.push(n+"_"+r))}function g(t){m.filter(Boolean).forEach(function(n){(e||(e=o("ODS"))).bumpEntityKey(s,u,n+t)})}function h(t,n,r){p(t,n,"success"),n!==c&&((e||(e=o("ODS"))).bumpEntityKey(s,u,"route_success"),o("MAWWorkerEvent").logSuccess(r))}function y(t,n,r,a){p(t,n,"fail"),n!==c&&((e||(e=o("ODS"))).bumpEntityKey(s,u,"route_fail"),o("MAWWorkerEvent").logFailure(a,r))}function C(t,n,r,a){p(t,n,"timeout"),n!==c&&((e||(e=o("ODS"))).bumpEntityKey(s,u,"route_timeout"),o("MAWWorkerEvent").logTimeoutFailure(r,"Route timeout",a))}function b(){g("_before_unresponsive"),m.fill(null)}l.CAT_ID=s,l.ENT=u,l.HEARTBEAT_ROUTE=c,l.RECENT_ROUTES_NUM=d,l.getBridgeEventInstanceKey=_,l.routeStart=f,l.logRecentRoutes=g,l.routeSuccess=h,l.routeFail=y,l.routeTimeoutFail=C,l.logRecentBridgeEvents=b}),98);
__d("MAWBridgeODSLogger",["ExecutionEnvironment","MAWODSProxy","WAOdsEnums"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n,a,i){if(o("MAWODSProxy").odsBumpEntityKey({entity:o("WAOdsEnums").Entity.MAW_BRIDGE,key:(a?"sendAndReceive":"fireAndForget")+"."+t+"."+n+"."+((e||(e=r("ExecutionEnvironment"))).isInWorker?"worker":"ui")}),i!=null&&typeof i=="object"){var l=i.event;if(l!=null&&typeof l=="object"){var s=l==null?void 0:l.i;s!=null&&o("MAWODSProxy").odsBumpEntityKey({entity:o("WAOdsEnums").Entity.MAW_BRIDGE,key:"qpl."+t+"."+n+"."+s+"."+((e||(e=r("ExecutionEnvironment"))).isInWorker?"worker":"ui")})}}}l.logCrossWorkerPortalODS=s}),98);
__d("MAWMaybeWithTimeout",["MAWODSProxy","WAOdsEnums","WAPromiseDelays"],(function(t,n,r,o,a,i,l){"use strict";function e(){return!0}function s(t,n,r,a){return e()?o("WAPromiseDelays").withTimeout(t.then(function(e){return o("MAWODSProxy").odsBumpEntityKey({entity:o("WAOdsEnums").Entity.MAW_NON_TIMEOUT,key:a!=null?a:"unknown"}),e}),n,function(){return o("MAWODSProxy").odsBumpEntityKey({entity:o("WAOdsEnums").Entity.MAW_TIMEOUT,key:a!=null?a:"unknown"}),r()}):t}l.maybeWithTimeout=s}),98);
__d("MAWTimedBridge",["MAWBridgeLoggingUtils","MAWMaybeWithTimeout","MAWWaitForBackendSetup","MAWWebWorkerSingleton","WALogger","qex"],(function(t,n,r,o,a,i,l){"use strict";var e,s=17e4;function u(t,n,r,a,i){i===void 0&&(i=s);var l=c(n,r)?o("MAWWaitForBackendSetup").waitForMICSetup(r):o("MAWWaitForBackendSetup").waitForBackendSetup(r);return l.then(function(){return o("MAWMaybeWithTimeout").maybeWithTimeout(t(),i,function(){return o("MAWWebWorkerSingleton").getWorkerHealthStatus().then(function(t){throw o("MAWBridgeLoggingUtils").routeTimeoutFail(n,r,a,t),o("WALogger").COUNT(e||(e=babelHelpers.taggedTemplateLiteralLoose(["route.",""])),r).tags("bridge_timeout"),new d("Bridge route "+r+" timed out, WorkerHealthStatus: "+t.tag)})},r)})}function c(e,t){return e!=="mps"||t!=="mpsLoadMessages"&&t!=="mpsLoadMessage"?!1:r("qex")._("603")===!0}var d=(function(e){function t(t){var n;return n=e.call(this,t)||this,n.name="BridgeTimeoutError",n.message=t,n}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));l.DEFAULT_MAW_BRIDGE_TIMEOUT_MS=s,l.bridgeTimeout=u,l.MAWBridgeTimeoutError=d}),98);
__d("MAWBridgeSendAndReceive",["MAWBridge","MAWBridgeLoggingUtils","MAWTimedBridge","MAWWorkerEvent"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n,r){var a=o("MAWBridgeLoggingUtils").getBridgeEventInstanceKey(t),i=(r==null?void 0:r.isLoggingDisabled)!==!0,l=o("MAWTimedBridge").bridgeTimeout(function(){return i&&o("MAWBridgeLoggingUtils").routeStart("sendAndReceive",e,t,a),o("MAWBridge").getBridge().sendAndReceive(e,t,n,r==null?void 0:r.isLoggingDisabled,{onAck:function(n){i&&o("MAWWorkerEvent").logAck(a,t,n)},onSend:function(n){var e=n.queueMsgs,r=n.queueSize;i&&(o("MAWWorkerEvent").logSend(a,t,"sendAndReceive"),o("MAWWorkerEvent").logAnnotations(a,{int:{bridgeSize:r},string_array:{bridgeMsgs:e}}))}},{bridgeQPLInstanceKey:a}).then(function(n){return i&&o("MAWBridgeLoggingUtils").routeSuccess(e,t,a),n}).catch(function(n){throw i&&o("MAWBridgeLoggingUtils").routeFail(e,t,n.message,a),n})},e,t,a,r==null?void 0:r.timeoutMs);return l}l.sendAndReceive=e}),98);
__d("MAWChatJid",["FBLogger","I64","MAWJids","MAWMiActMappingTableAPI","Promise","ReQL","asyncToGeneratorRuntime","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(e,t){try{return o("MAWMiActMappingTableAPI").getMappingRowForIntJid(e,o("MAWJids").convertChatJidToIntJid(t)).then(function(e){return e==null?void 0:e.serverThreadKey})}catch(e){var a=r("getErrorSafe")(e);return r("FBLogger")("messenger_web").catching(a).warn("Invalid chatJid: "+t),(s||(s=n("Promise"))).reject(a)}}function c(e,t,n){return u(e,t).then(function(e){if(e!=null)return e;throw r("FBLogger")("messenger_web").mustfixThrow("[toThreadKey] No mapping record for chatJid, source: %s",n)})}function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield u(e,t);if(n!=null)return o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.threads).getKeyRange(n))}),m.apply(this,arguments)}function p(t,a){try{return o("MAWMiActMappingTableAPI").getMappingRowForIntJid(t,a).then(function(e){return e==null?void 0:e.serverThreadKey})}catch(t){var i=r("getErrorSafe")(t);return r("FBLogger")("messenger_web").catching(i).warn("Invalid integer jid: "+(e||(e=o("I64"))).to_string(a)),(s||(s=n("Promise"))).reject(i)}}l.toThreadKeyMaybe=u,l.toThreadKey=c,l.toThreadMaybe=d,l.toThreadKeyMaybeForChatJidInteger=p}),98);
__d("MAWConsoleLogger",["gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=r("gkx")("2656");function s(t,n,r){if(e){var o=r.map(function(e){return"["+e+"]"}).join("");if(t==="count"){console.count(o+" "+String(n));return}for(var a=arguments.length,i=new Array(a>3?a-3:0),l=3;l<a;l++)i[l-3]=arguments[l];if(o){var s;(s=console)[t].apply(s,[o,n].concat(i))}else{var u;(u=console)[t].apply(u,[n].concat(i))}}}l.logToConsole=s}),98);
__d("WABridgeBatcher",["WAShiftTimer"],(function(t,n,r,o,a,i,l){"use strict";var e=20,s=1e3,u=(function(){function t(t,n,r){var a=this;this.$1=null,this.$6=Date.now(),this.$7=new(o("WAShiftTimer")).ShiftTimer(function(){var e=a.$1;e!=null&&(a.$1=null,a.$2(e))}),this.$2=n,this.$3=t,this.$5=r!=null?r:e,this.$4=this.$5}var n=t.prototype;return n.addEvent=function(t){var e=this.$1;if(this.$1=e?this.$3(e,t):[t],!this.$7.isScheduled()){var n=this.$4;if(n<1){var r=Date.now(),o=Math.max(r-this.$6,0)/s;n=Math.min(n+o,this.$5),this.$4=n,this.$6=r}var a;n>=1?(a=0,this.$4=n-1):(a=Math.ceil(s*(1-n)),this.$4=0),this.$7.onOrBefore(a)}},n.cancel=function(){this.$1=null,this.$7.cancel()},t})();l.BridgeBatcher=u}),98);
__d("WALruCache",["WALogger","WAShiftTimer","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(t,n){this.key=t,this.value=n,this.prev=null,this.next=null},u=(function(){function t(e){var t=this,n;this.$2=new Map,this.purgeNow=function(){for(var e=t.$6.prev;t.$4>t.$3&&e!==t.$5;e=e?e.prev:null){if(e==null)throw r("err")("The linked list is not constructed properly.");var n=e,o=n.key,a=n.value;t.$9(o,a)&&(t.delete(o),t.$10&&t.$10(o,a))}t.$8&&t.$8(t.$2)},this.$3=e.sizeLimit,this.$7=e.getSize,this.$8=e.onPurge,this.$9=(n=e.shouldEvict)!=null?n:function(){return!0},this.$10=e.onEvict,this.$11=e.onAdd,this.$12=e.onDelete,this.$4=0,this.$5=new s("placeholder-head",null),this.$6=new s("placeholder-tail",null),this.$5.next=this.$6,this.$6.prev=this.$5,this.$1=new(o("WAShiftTimer")).ShiftTimer(function(){return t.purgeNow()})}var n=t.prototype;return n.get=function(t){if(!this.$2.has(t))return null;var e=this.$2.get(t);if(e==null)return null;var n=e.prev,o=e.next;n&&(n.next=o),o&&(o.prev=n);var a=this.$5.next;if(a==null)throw r("err")("The linked list is not constructed properly.");return this.$5.next=e,a.prev=e,e.prev=this.$5,e.next=a,e.value},n.has=function(t){return this.$2.has(t)},n.touch=function(t){this.get(t)},n.put=function(n,r){if(this.$3!==0){if(this.$7(r)>this.$3){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Blob size is larger than the limit of the whole store."])));return}this.delete(n),this.$14(n,r),this.schedulePurge()}},n.$14=function(t,n){var e=new s(t,n);this.$2.set(t,e);var o=this.$5.next;if(o==null)throw r("err")("The linked list is not constructed properly.");this.$5.next=e,o.prev=e,e.prev=this.$5,e.next=o,this.$4+=this.$7(n),this.$11&&this.$11(t,n)},n.delete=function(t){if(this.$2.has(t)){var e=this.$2.get(t);if(e!=null){this.$4-=this.$7(e.value);var n=e.prev,r=e.next;n&&(n.next=r),r&&(r.prev=n),this.$2.delete(t),this.$12&&this.$12(t,e.value)}}},n.clear=function(){this.$2.clear(),this.$4=0,this.$5.next=this.$6,this.$6.prev=this.$5,this.$13&&this.$13()},n.schedulePurge=function(){this.$1.onOrBefore(1e3)},n.getCurrentSize=function(){return this.$4},n.getPlaceholderHead=function(){return this.$5},n.forEach=function(t){if(this.$4!==0){var e=this.$6.prev;if(e==null)throw r("err")("The linked list is not constructed properly.");for(;e!=null&&e!==this.$5;)t(e.value),e=e.prev}},t})();l.LruCache=u}),98);
__d("WACrossWorkerPortal",["FBLogger","Promise","WABridgeBatcher","WALogger","WALruCache","WAPromiseManagement","err","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C,b=(function(){function t(e,t,n,r,a){var i=this,l;if(this.port=null,this.$2=1,this.openRequests=new Map,this.listeners=new Set,(a==null?void 0:a.useLRUCache)===!0){var s,u=new(o("WALruCache")).LruCache({sizeLimit:(s=a.portalCacheSize)!=null?s:100,getSize:function(){return 1}});this.processedRequests={has:function(t){return u.has(t)},add:function(t){u.put(t,!0)}}}else{var c=new Set;this.processedRequests={has:function(t){return c.has(t)},add:function(t){c.add(t)}}}this.$1=e,this.clientId=r,this.config=a,this.sendStream=new(o("WABridgeBatcher")).BridgeBatcher(t,function(e){i.$3(e)},(l=this.config)==null?void 0:l.bridgeBatcherMaxTokens),n.forEach(function(t){e.setNamespaceHandler(t,i.$4(t))})}var a=t.prototype;return a.$5=function(){var e=this.clientId!=null?this.clientId+"_":"";return""+e+this.$2++},a.$6=function(t){var e=t.split("_");return e.length!==2?null:e[0]},a.addListener=function(t){var e=this;return this.listeners.add(t),function(){return e.listeners.delete(t)}},a.setPort=function(n){var t=this;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Bridge updating port"]))),this.port=n,this.sendStream.cancel(),n.onmessage=function(e){if(t.port!==n){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Bridge received msg on old port"]))).devConsole(e.data);return}var r=e.data;!r||!Array.isArray(r)||r.forEach(function(e){t.$7(e,"incoming"),t.$8(n,e)})},this.openRequests.forEach(function(e){var n=e.request;o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Bridge sending "," across (delayed)"])),n.name),t.sendStream.addEvent({type:"request",content:n})})},a.getBridge=function(){return this.$1},a.$4=function(t){var e=this;return function(n,r,o,a,i,l){e.$9(t,n,r,o,a,i,l)}},a.$9=function(t,n,o,a,i,l,s){var e,u,d=this.$5(),m=babelHelpers.extends({fromClientId:(e=this.clientId)!=null?e:void 0},s),p={requestId:d,expectsResponse:!!a,namespace:t,name:n,arg:o,silentLog:i,opts:m};if(((u=this.config)==null?void 0:u.onSendAcross)!=null)try{this.config.onSendAcross(t,n,p.expectsResponse,o)}catch(e){var _=r("getErrorSafe")(e);r("FBLogger")("wmi").catching(_).MUSTFIX(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Failed to execute onSendAcross"])))}this.openRequests.set(d,{request:p,resolver:a,eventCallbacks:l}),this.sendStream.addEvent({type:"request",content:p})},a.$10=function(t,n){t===this.port&&this.sendStream.addEvent({type:"result",content:n})},a.$3=function(t){var e=this,n=this.port;if(!n){o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Bridge queuing "," msgs"])),t.length);return}n.postMessage(t);var r=t.map(function(e){var t,n,r,o=(t=(n=e.content.arg)==null?void 0:n.type)!=null?t:"";return""+((r=e.content.name)!=null?r:"")+(o?":"+o:"")}).filter(Boolean);t.forEach(function(n){var o;e.$7(n,"outgoing");var a=e.openRequests.get(n.content.requestId);(a==null||(o=a.eventCallbacks)==null?void 0:o.onSend)!=null&&a.eventCallbacks.onSend({queueSize:t.length,queueMsgs:r})})},a.$7=function(t,n){this.listeners.forEach(function(e){return e(t,n)})},a.$8=function(t,a){var e=this;if(a.type==="request"){var i=a.content,l=i.namespace,s=i.name,u=i.requestId,c=i.arg,d=i.expectsResponse,y=i.silentLog,b=i.opts;if(y||o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Bridge "," request for ",""])),u,s),(b==null?void 0:b.toClientId)!=null&&b.toClientId!==this.clientId){y||o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Bridge "," not intended for client ",""])),u,this.clientId);return}var v=this.$1,S={type:"result",content:{requestId:u,type:"handled",result:{payload:v.getAckPayoad(),timestamp:Date.now()},silentLog:y,opts:b}};if(this.$7(S,"outgoing"),t.postMessage([S]),d){var R=v.sendAndReceive(l,s,c,y,void 0,b).then(function(n){e.$10(t,{requestId:u,type:"success",result:n,silentLog:y,opts:b})},function(n){e.$10(t,{requestId:u,type:"error",result:String(n),silentLog:y,opts:b})});o("WAPromiseManagement").preventGarbageCollection(R)}else v.fireAndForget(l,s,c,y,void 0,b)}else{a.type;var L=a.content,E=L.requestId,k=L.type,I=L.result,T=L.silentLog;T||o("WALogger").DEV(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Bridge "," response of ",""])),E,k);var D=this.$6(E);if(D!==this.clientId||this.processedRequests.has(E))return;var x=this.openRequests.get(E);if(!x){o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["Bridge unrecognized result ",""])),E);return}switch(k){case"success":case"error":{this.openRequests.delete(E),this.processedRequests.add(E);var $=x.resolver;$?$(k==="success"?I:(C||(C=n("Promise"))).reject(r("err")(I!=null?I:""))):o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["Bridge unexpected result to cast: ",""])),I);break}case"handled":try{var P;(P=x.eventCallbacks)==null||P.onAck==null||P.onAck(I)}catch(e){var N=r("getErrorSafe")(e);o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to execute onAck: ",""])),N.message)}x.resolver||(this.openRequests.delete(E),this.processedRequests.add(E));break}}},t})();function v(e,t,n,r,o){return new b(e,n,t,r,o)}function S(e){var t;(t=e.port)==null||t.close(),e.port=null,e.sendStream.cancel();var n=e.openRequests;e.openRequests=new Map;var r=e.getBridge();n.forEach(function(e){var t=e.request,n=e.resolver,a=t.namespace,i=t.name,l=t.arg,s=t.silentLog;o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["absorbPortal: transferring request #",""])),t.requestId),n?n(r.sendAndReceive(a,i,l,s)):r.fireAndForget(a,i,l,s)})}l.CrossWorkerPortal=b,l.attachPortal=v,l.killPortalAndSendPendingToBridge=S}),98);
__d("MAWCrossWorkerPortal",["FBLogger","MAWBridgeODSLogger","WACrossWorkerPortal","justknobx","pageID"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n,a,i){if(e!=null)return e;var l=babelHelpers.extends({},i);return r("justknobx")._("5256")&&(l=babelHelpers.extends({},i,{onSendAcross:o("MAWBridgeODSLogger").logCrossWorkerPortalODS})),e=o("WACrossWorkerPortal").attachPortal(t,n,a,r("pageID"),l),e}function u(){if(e==null){r("FBLogger")("messenger_web").warn("Trying to kill portal before its setup");return}o("WACrossWorkerPortal").killPortalAndSendPendingToBridge(e)}l.getOrCreateCrossWorkerPortal=s,l.killPortalWhenWorkerTerminating=u}),98);
__d("MAWCryptoConsts",[],(function(t,n,r,o,a,i){"use strict";var e=3600,l=24*e,s=32,u=new Uint8Array(0).buffer,c=128,d=256,m=12,p=1,_=2,f=2,g=4,h=l*30*6,y=3,C="AES-GCM",b="HKDF",v="SHA-256";i.HKDF_SEED_LENGTH_IN_BYTES=s,i.HKDF_INFO=u,i.AES_GCM_TAG_LENGTH=c,i.AES_GCM_KEY_LENGTH=d,i.AES_GCM_IV_LENGTH_IN_BYTES=m,i.VERSION=p,i.CIPHER_ID=_,i.ADDITIONAL_DATA_LENGTH_IN_BYTES=f,i.EXTRA_ADDITIONAL_DATA_LENGTH_IN_BYTES=g,i.ENC_KEY_TTL=h,i.MAX_KEYCHAIN_SETUP_RETRIES=y,i.AES_GCM=C,i.HKDF=b,i.SHA256=v}),66);
__d("MAWDbChatId__UNSAFE_DO_NOT_USE",["I64"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){return(e||(e=o("I64"))).of_float(t)}function u(e,t){return e+"_"+t}l.convertToChatId64__DEPRECATED=s,l.craftAltIndex__DEPRECATED=u}),98);
__d("WAMsgType",[],(function(t,n,r,o,a,i){"use strict";var e="Text",l="Futureproof",s="Ciphertext",u="Unavailable",c="Image",d="Video",m="Ptt",p="Admin",_="Revoked",f="Gif",g="Sticker",h="DocumentFile",y="ExpiredEphemeral",C="EphemeralSettingAdmin",b="EphemeralSyncResponse",v="DeleteForMe",S="EphemeralSettingChangeFromCurrentDevice",R="AlertICDC",L="GroupInvite",E="NoteReply",k="Reaction",I="SenderKeyDistribution",T="EditAction",D="ReceiverFetch",x="Raven",$="GroupPollCreate",P="GroupPollUpdate",N={ADMIN:p,CIPHERTEXT:s,DELETE_FOR_ME:v,DOCUMENT_FILE:h,EDIT_ACTION:T,EPHEMERAL_SETTING_ADMIN:C,EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:S,EPHEMERAL_SYNC_RESPONSE:b,EXPIRED_EPHEMERAL:y,FUTUREPROOF:l,GIF:f,GROUP_INVITE:L,ICDC_ALERT:R,IMAGE:c,PTT:m,REACTION:k,REVOKED:_,SK_DISTRIBUTION:I,STICKER:g,TEXT:e,UNAVAILABLE:u,VIDEO:d,RECEIVER_FETCH:D,RAVEN:x,GROUP_POLL_CREATE:$,GROUP_POLL_UPDATE:P,NOTE_REPLY:E};i.TEXT=e,i.FUTUREPROOF=l,i.CIPHERTEXT=s,i.UNAVAILABLE=u,i.IMAGE=c,i.VIDEO=d,i.PTT=m,i.ADMIN=p,i.REVOKED=_,i.GIF=f,i.STICKER=g,i.DOCUMENT_FILE=h,i.EXPIRED_EPHEMERAL=y,i.EPHEMERAL_SETTING_ADMIN=C,i.EPHEMERAL_SYNC_RESPONSE=b,i.DELETE_FOR_ME=v,i.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE=S,i.ICDC_ALERT=R,i.GROUP_INVITE=L,i.NOTE_REPLY=E,i.REACTION=k,i.SK_DISTRIBUTION=I,i.EDIT_ACTION=T,i.RECEIVER_FETCH=D,i.RAVEN=x,i.GROUP_POLL_CREATE=$,i.GROUP_POLL_UPDATE=P,i.MSG_TYPE=N}),66);
__d("MAWMsgType",["WAMsgType"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t){return g.has(t)},s=function(t){return h.has(t)||g.has(t)},u=function(t){return s(t)||y.has(t)},c="EphemeralScreenshotAction",d="Raven",m="RavenAction",p="XMA",_="BumpExistingMessage",f=babelHelpers.extends({},o("WAMsgType").MSG_TYPE,{BUMP_EXISTING_MESSAGE:_,EPHEMERAL_SCREENSHOT_ACTION:c,RAVEN:d,RAVEN_ACTION:m,XMA:p}),g=new Set([f.IMAGE,f.VIDEO,f.PTT,f.GIF,f.STICKER,f.XMA,f.RAVEN,f.DOCUMENT_FILE,f.RECEIVER_FETCH]),h=new Set([f.TEXT,f.REVOKED,f.XMA,f.BUMP_EXISTING_MESSAGE,f.GROUP_POLL_CREATE]),y=new Set([f.FUTUREPROOF]),C=new Set([f.TEXT,f.IMAGE,f.VIDEO,f.PTT,f.GIF,f.STICKER,f.DOCUMENT_FILE,f.UNAVAILABLE,f.EXPIRED_EPHEMERAL,f.REVOKED,f.XMA,f.RAVEN,f.RECEIVER_FETCH]),b=function(t){return C.has(t)};l.isMAWSupportedMediaType=e,l.isEBSupportedMsgType=s,l.isProtobufUploadSupportedMsgType=u,l.EPHEMERAL_SCREENSHOT_ACTION=c,l.MSG_TYPE=f,l.mawSupportedMediaTypes=g,l.isQuotedMsgType=b}),98);
__d("WADirectPath",["WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";var e="0_0_0_.enc";function s(e){return e}function u(t){return t==null?o("WAResultOrError").makeError("direct-path-undefined"):t===""?o("WAResultOrError").makeError("direct-path-empty"):t.includes(e)?o("WAResultOrError").makeError("direct-path-corrupted"):o("WAResultOrError").makeResult(t)}l.unsafeCastToDirectPath=s,l.validateDirectPath=u}),98);
__d("WAProtoConst",[],(function(t,n,r,o,a,i){"use strict";var e={REPEATED:64,PACKED:128,REQUIRED:256},l=31,s={INT32:1,INT64:2,UINT32:3,UINT64:4,SINT32:5,SINT64:6,BOOL:7,ENUM:8,FIXED64:9,SFIXED64:10,DOUBLE:11,STRING:12,BYTES:13,MESSAGE:14,FIXED32:15,SFIXED32:16,FLOAT:17,MAP:18},u={VARINT:0,BIT64:1,BINARY:2,BIT32:5},c={ONEOF:"__oneofs__",RESERVED:"__reserved__",RESERVED_TAGS:"tags",RESERVED_FIELDS:"fields"};i.FLAGS=e,i.TYPE_MASK=l,i.TYPES=s,i.ENC=u,i.KEYS=c}),66);
__d("WAMediaEntryData.pb",["WAProtoConst"],(function(t,n,r,o,a,i,l){var e,s={},u={},c={};s.internalSpec={fileSha256:[1,(e=o("WAProtoConst")).TYPES.BYTES],mediaKey:[2,e.TYPES.BYTES],fileEncSha256:[3,e.TYPES.BYTES],directPath:[4,e.TYPES.STRING],mediaKeyTimestamp:[5,e.TYPES.INT64],serverMediaType:[6,e.TYPES.STRING],uploadToken:[7,e.TYPES.BYTES],validatedTimestamp:[8,e.TYPES.BYTES],sidecar:[9,e.TYPES.BYTES],objectId:[10,e.TYPES.STRING],fbid:[11,e.TYPES.STRING],downloadableThumbnail:[12,e.TYPES.MESSAGE,c],handle:[13,e.TYPES.STRING],filename:[14,e.TYPES.STRING],progressiveJpegDetails:[15,e.TYPES.MESSAGE,u],size:[16,e.TYPES.INT64],lastDownloadAttemptTimestamp:[17,e.TYPES.INT64]},u.internalSpec={scanLengths:[1,e.FLAGS.REPEATED|e.TYPES.UINT32],sidecar:[2,e.TYPES.BYTES]},c.internalSpec={fileSha256:[1,e.TYPES.BYTES],fileEncSha256:[2,e.TYPES.BYTES],directPath:[3,e.TYPES.STRING],mediaKey:[4,e.TYPES.BYTES],mediaKeyTimestamp:[5,e.TYPES.INT64],objectId:[6,e.TYPES.STRING]},l.MediaEntrySpec=s,l.MediaEntry$ProgressiveJpegDetailsSpec=u,l.MediaEntry$DownloadableThumbnailSpec=c}),98);
__d("WAProgressiveJpegMarkers",[],(function(t,n,r,o,a,i){"use strict";var e=255,l=0,s={SOF0:192,SOF1:193,SOF2:194,SOF3:195,DHT:196,SOF5:197,SOF6:198,SOF7:199,JPG:200,SOF9:201,SOF10:202,SOF11:203,SOF13:205,SOF14:206,SOF15:207,RST0:208,RST1:209,RST2:210,RST3:211,RST4:212,RST5:213,RST6:214,RST7:215,SOI:216,EOI:217,SOS:218,DQT:219,DRI:221,APP0:224,APP1:225,APP2:226,APP3:227,APP4:228,APP5:229,APP6:230,APP7:231,APP8:232,APP9:233,APP10:234,APP11:235,APP12:236,APP13:237,APP14:238,APP15:239,COM:254,TEM:1},u=[l,s.RST0,s.RST1,s.RST2,s.RST3,s.RST4,s.RST5,s.RST6,s.RST7];i.MARKER_PREFIX=e,i.MARKER_ESCAPE_BYTE=l,i.MARKERS=s,i.SOS_STREAM=u}),66);
__d("WAProgressiveJpegGetScanOffsets",["WAProgressiveJpegMarkers","WATagsLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m=o("WATagsLogger").TAGS(["media","progressiveJpegUtils"]);function p(t){if(m.DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["starting"]))),!_(t))return m.DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Not a JPEG image"]))),[];var n=[],r=2,a="READ_MARKER_FIRST_BYTE_OR_ENTROPY_DATA",i=null,l=0,p=!1,y=!1,C=!1;function b(){C=!1,m.DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Scan found at offset ",""])),r-1),n.push(r-1)}for(;r<t.byteLength;){if(i=t[r],p)return m.ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Ending marker found before end of image"]))),[];switch(a){case"READ_MARKER_FIRST_BYTE_OR_ENTROPY_DATA":i===o("WAProgressiveJpegMarkers").MARKER_PREFIX&&(a="READ_MARKER_SECOND_BYTE");break;case"READ_MARKER_SECOND_BYTE":if(i===o("WAProgressiveJpegMarkers").MARKER_PREFIX)a="READ_MARKER_SECOND_BYTE";else if(i===o("WAProgressiveJpegMarkers").MARKER_ESCAPE_BYTE)a="READ_MARKER_FIRST_BYTE_OR_ENTROPY_DATA";else if(i===o("WAProgressiveJpegMarkers").MARKERS.EOI)p=!0,C&&b();else{if(!y&&g(i))return m.LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Non-progressive JPEG marker found"]))),[];f(i)?(y=!0,a="READ_MARKER_FIRST_BYTE_OR_ENTROPY_DATA"):(C&&b(),i===o("WAProgressiveJpegMarkers").MARKERS.SOS&&(C=!0),h(i)?a="READ_SIZE_FIRST_BYTE":a="READ_MARKER_FIRST_BYTE_OR_ENTROPY_DATA")}break;case"READ_SIZE_FIRST_BYTE":a="READ_SIZE_SECOND_BYTE";break;case"READ_SIZE_SECOND_BYTE":r+=l*256,r+=i,r-=2,a="READ_MARKER_FIRST_BYTE_OR_ENTROPY_DATA";break}r+=1,l=i}return n}function _(e){return!(e.byteLength<=2||e[0]!==o("WAProgressiveJpegMarkers").MARKER_PREFIX||e[1]!==o("WAProgressiveJpegMarkers").MARKERS.SOF2&&e[1]!==o("WAProgressiveJpegMarkers").MARKERS.SOI)}function f(e){return e===o("WAProgressiveJpegMarkers").MARKERS.SOF2||e===o("WAProgressiveJpegMarkers").MARKERS.SOF6||e===o("WAProgressiveJpegMarkers").MARKERS.SOF10||e===o("WAProgressiveJpegMarkers").MARKERS.SOF14}function g(e){return e===o("WAProgressiveJpegMarkers").MARKERS.SOF0||e===o("WAProgressiveJpegMarkers").MARKERS.SOF1||e===o("WAProgressiveJpegMarkers").MARKERS.SOF3||e===o("WAProgressiveJpegMarkers").MARKERS.SOF5||e===o("WAProgressiveJpegMarkers").MARKERS.SOF7||e===o("WAProgressiveJpegMarkers").MARKERS.JPG||e===o("WAProgressiveJpegMarkers").MARKERS.SOF9||e===o("WAProgressiveJpegMarkers").MARKERS.SOF11||e===o("WAProgressiveJpegMarkers").MARKERS.SOF13||e===o("WAProgressiveJpegMarkers").MARKERS.SOF15}function h(e){return e===o("WAProgressiveJpegMarkers").MARKERS.TEM||e>=o("WAProgressiveJpegMarkers").MARKERS.RST0&&e<=o("WAProgressiveJpegMarkers").MARKERS.RST7?!1:e!==o("WAProgressiveJpegMarkers").MARKERS.EOI&&e!==o("WAProgressiveJpegMarkers").MARKERS.SOI}l.getProgressiveJpegScanOffsets=p}),98);
__d("WAProgressiveJpegGetScanLengths",["WAProgressiveJpegGetScanOffsets"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=o("WAProgressiveJpegGetScanOffsets").getProgressiveJpegScanOffsets(e);return u(t)}function s(e){return e}function u(e){var t=[],n=0;for(var r of e)t.push(r-n),n=r;return t}l.getProgressiveJpegScanLengths=e,l.asProgressiveJpegScanLength=s}),98);
__d("WAServerMediaType",[],(function(t,n,r,o,a,i){"use strict";var e=["image","sticker","ptt","audio","document","video","gif","ppic","md-app-state","md-msg-hist","kyc-id","template","thumbnail-image","thumbnail-video","thumbnail-gif","thumbnail-document","thumbnail-link","payment-bg-image","novi-video","novi-image","xma-image","biz-cover-photo","preview","newsletter-music-artwork","newsletter-audio","newsletter-document","newsletter-image","newsletter-gif","newsletter-ptt","newsletter-sticker","newsletter-thumbnail-link","newsletter-video","sticker-pack","thumbnail-sticker-pack","music-artwork","group-history"];function l(e){switch(e){case"image":case"sticker":case"ptt":case"audio":case"document":case"video":case"gif":case"ppic":case"md-app-state":case"md-msg-hist":case"kyc-id":case"thumbnail-image":case"thumbnail-video":case"thumbnail-gif":case"thumbnail-document":case"thumbnail-link":case"payment-bg-image":case"novi-video":case"novi-image":case"template":case"xma-image":case"biz-cover-photo":case"preview":case"newsletter-music-artwork":case"newsletter-audio":case"newsletter-document":case"newsletter-image":case"newsletter-gif":case"newsletter-ptt":case"newsletter-sticker":case"newsletter-thumbnail-link":case"newsletter-video":case"sticker-pack":case"thumbnail-sticker-pack":case"music-artwork":case"group-history":return e;default:return null}}function s(e){return e==="Image"?"image":e==="Video"?"video":e==="Ptt"?"ptt":e==="Gif"?"gif":e==="Sticker"?"sticker":e==="DocumentFile"?"document":e==="Text"||e==="Futureproof"||e==="Ciphertext"||e==="Unavailable"||e==="ExpiredEphemeral"||e==="Admin"||e==="Revoked"||e==="DeleteForMe"||e==="EphemeralSettingAdmin"||e==="EphemeralSyncResponse"||e==="EphemeralSettingChangeFromCurrentDevice"||e==="AlertICDC"||e==="GroupInvite"||e==="SenderKeyDistribution"||e==="Reaction"||e==="EditAction"||e==="ReceiverFetch"||e==="Raven"||e==="GroupPollCreate"||e==="GroupPollUpdate"?null:(function(){throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+e)})()}i.SERVER_MEDIA=e,i.castToServerMediaType=l,i.getMediaType=s}),66);
__d("WABaseProto",[],(function(t,n,r,o,a,i){"use strict";var e="__tu";i.TAGGED_UNION_TAG=e}),66);
__d("WAHasProperty",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){return Object.prototype.hasOwnProperty.call(e,t)}i.default=e}),66);
__d("WAProtoCompile",["WAProtoConst"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t,n,r,o,a,i,l,s,u){this.names=t,this.fields=n,this.types=r,this.defaults=o,this.meta=a,this.oneofToFields=i,this.fieldToOneof=l,this.reservedTags=s?s.reduce(function(e,t){return e[t]=!0,e},{}):{},this.reservedFields=u?u.reduce(function(e,t){return e[t]=!0,e},{}):{}};function s(t){if(t.internalCompiledSpec)return t.internalCompiledSpec;var n=t.internalSpec;if(!n)throw new Error("Message Class "+String(t)+" does not have internalSpec");var r=t.internalDefaults||{},a=Object.keys(n).filter(function(e){return e!==o("WAProtoConst").KEYS.ONEOF}),i=new Array(a.length),l=[],s=[],c=new Array(a.length),d=n[o("WAProtoConst").KEYS.ONEOF]||{};a.sort(function(e,t){var r=u(n,e),o=u(n,t);return r[0]-o[0]});for(var m=0;m<a.length;m++){var p=a[m],_=u(n,p);c[m]=r[p];var f=_[1],g=_[0];if(l.push(g),s.push(f),(f&o("WAProtoConst").TYPE_MASK)===o("WAProtoConst").TYPES.MESSAGE)i[m]=_[2];else if((f&o("WAProtoConst").TYPE_MASK)===o("WAProtoConst").TYPES.ENUM){var h=_[2];if(typeof h.cast=="function")i[m]=h;else{var y=!0,C=0;for(var b in h)y&&b!==C++&&(y=!1);var v=void 0;if(y){v=[];for(var S=0;S<C;S++)v.push(!0)}else{v={};for(var R in h)v[h[R]]=!0}i[m]=v}}else if((f&o("WAProtoConst").TYPE_MASK)===o("WAProtoConst").TYPES.MAP){if(_.length!==3)throw new Error("Map field "+p+" should have exactly three elements in its internalSpec");i[m]=_[2]}else i[m]=null}var L={},E=function(t){d[t].forEach(function(e){L[e]||(L[e]=[]),L[e].push(t)})};for(var k in d)E(k);var I=n[o("WAProtoConst").KEYS.RESERVED]&&n[o("WAProtoConst").KEYS.RESERVED][o("WAProtoConst").KEYS.RESERVED_TAGS],T=n[o("WAProtoConst").KEYS.RESERVED]&&n[o("WAProtoConst").KEYS.RESERVED][o("WAProtoConst").KEYS.RESERVED_FIELDS],D=new e(a,l,s,c,i,d,L,I,T);return t.internalCompiledSpec=D,D}function u(e,t){var n=e[t];if(n==null)throw new Error("fieldData of "+t+" is missing");return n}l.Spec=e,l.compileSpec=s}),98);
__d("WAProtoUtils",["WAProtoConst"],(function(t,n,r,o,a,i,l){"use strict";function e(e){if(e&o("WAProtoConst").FLAGS.PACKED)return o("WAProtoConst").ENC.BINARY;var t=e&o("WAProtoConst").TYPE_MASK;return t<=o("WAProtoConst").TYPES.ENUM?o("WAProtoConst").ENC.VARINT:t<=o("WAProtoConst").TYPES.DOUBLE?o("WAProtoConst").ENC.BIT64:t<=o("WAProtoConst").TYPES.MESSAGE||t===o("WAProtoConst").TYPES.MAP?o("WAProtoConst").ENC.BINARY:o("WAProtoConst").ENC.BIT32}l.typeToEncType=e}),98);
__d("WAProtoValidate",["WAHasProperty","WALogger","WAProtoCompile","WAProtoConst"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m=Number.MAX_SAFE_INTEGER;function p(e,t){var n=f(e,t);if(n)throw n.reverse(),new TypeError("Message missing required value "+n.join("."))}function _(e,t){p(e,t);var n=v(t,e);if(n)throw n.path.reverse(),new TypeError("Invalid value at "+n.path.join(".")+": "+n.error)}function f(e,t){for(var n=o("WAProtoCompile").compileSpec(e),a=n.names,i=n.types,l=n.meta,s=void 0,u=0;u<i.length&&!s;u++){var c=i[u],d=a[u],m=r("WAHasProperty")(t,d)?t[d]:void 0;if(c&o("WAProtoConst").FLAGS.REQUIRED&&m==null)s=[d];else if((c&o("WAProtoConst").TYPE_MASK)===o("WAProtoConst").TYPES.MESSAGE&&c&o("WAProtoConst").FLAGS.REPEATED&&m!=null){var p=l[u],_=void 0;for(_=0;_<m.length&&!s;_++)s=f(p,m[_]);s&&s.push(d+"["+_+"]")}else(c&o("WAProtoConst").TYPE_MASK)===o("WAProtoConst").TYPES.MESSAGE&&m!=null&&(s=f(l[u],m),s&&s.push(d))}return s}function g(t,n,r){return typeof t=="string"?/^-?0x[0-9a-f]{16}$/i.test(t)?!1:(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(['"','" is not a valid long'])),C(t)).color("red"),{path:[],error:"value must be a hex string of the form '0x123...' or '-0x123...' where the tail is always 16 characters long"}):h(t,n,r)}function h(e,t,n){return typeof e!="number"||e!==e||Math.floor(e)!==e?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(['"','" is not a valid int'])),C(e)).color("red"),{path:[],error:"value must be an int"}):e<t||e>=n?(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(['"','" is out of range'])),C(e)).color("red"),{path:[],error:"value is out of range"}):!1}function y(e,t,n){if(!e)return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(['"','" is not ',""])),C(n),t).color("red"),{path:[],error:"value is invalid"}}function C(e){return typeof e=="string"?'"'+e+'"':Array.isArray(e)?"["+e.join(", ")+"]":""+e}var b=[void 0,function(e){return h(e,-2147483648,2147483648)},function(e){return g(e,-m,m+1)},function(e){return h(e,0,4294967296)},function(e){return g(e,0,m+1)},function(e){return h(e,-2147483648,2147483648)},function(e){return g(e,-m,m+1)},function(e){return y(typeof e=="boolean","boolean",e)},function(e,t){return y(typeof e=="number"&&(t[e]||t.cast(e)!==void 0),"in enum",e)},function(e){return g(e,0,m+1)},function(e){return g(e,-m,m+1)},function(e){return y(typeof e=="number","number",e)},function(e){return y(typeof e=="string","string",e)},function(e){return y(e instanceof ArrayBuffer||e instanceof Uint8Array,"ArrayBuffer or Uint8Array",e)},v,function(e){return h(e,0,4294967296)},function(e){return h(e,-2147483648,2147483648)},function(e){return y(typeof e=="number","number",e)}];function v(e,t){for(var n=o("WAProtoCompile").compileSpec(t),r=n.names,a=n.fields,i=n.types,l=n.meta,s=n.oneofToFields,u=n.fieldToOneof,c=n.reservedTags,m=n.reservedFields,p=void 0,_=function(){var t=r[g],n=i[g],_=e[t],f=n&o("WAProtoConst").TYPE_MASK,h=b[f],y=(n&o("WAProtoConst").TYPE_MASK)===o("WAProtoConst").TYPES.MAP;if(h===void 0&&!y)throw new Error("Can not find the validator for type "+f);if(n&(o("WAProtoConst").FLAGS.PACKED|o("WAProtoConst").FLAGS.REPEATED)&&_!=null)if(!Array.isArray(_))o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(['"','" is not an array'])),C(_)).color("red"),p={path:[t],error:"repeated field must be array"};else for(var v=l[g],S=0;S<_.length&&!p;S++)p=h(_[S],v),p&&p.path.push(t+"["+S+"]");else if(y&&_!=null){var R=l[g],L=R[0],E=R[1],k=typeof E=="object"?o("WAProtoConst").TYPES.MESSAGE:E,I=b[L],T=b[k];if(I===void 0||T===void 0)throw new Error("Can not find the validator for Map with key type "+L+", value type "+k);for(var D of _){var x=D[0],$=D[1];if(p=I(x,L),p)return p.path.push(t+"'s key ["+x+"]"),{v:p};if(p=T($,E),p)return p.path.push(t+"["+x+"]'s value"),{v:p}}}else if(_!=null){p=h(_,l[g]),p&&p.path.push(t);var P=u[t];P&&P.forEach(function(n){var r=s[n].filter(function(e){return e!==t});r.forEach(function(r){typeof e[r]!="undefined"&&(p={path:[n],error:"oneof '"+n+"' has fields '"+t+"' and '"+r+"' set"})})}),c[a[g]]&&(p={path:[t],error:"tag "+a[g]+" is reserved"}),m[t]&&(p={path:[t],error:"field "+t+" is reserved"})}},f,g=0;g<r.length&&!p;g++)if(f=_(),f)return f.v;return p}l.checkRequirements=p,l.checkValid=_}),98);
__d("decodeProtobuf",["WABaseProto","WABinary","WAHasProperty","WAHex","WAProtoCompile","WAProtoConst","WAProtoUtils","WAProtoValidate"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n=new(o("WABinary")).Binary(t),r=h(e,n,void 0,!1,!1);return o("WAProtoValidate").checkRequirements(e,r),r}function s(e,t){var n=new(o("WABinary")).Binary(t),r=h(e,n,void 0,!1,!0);return o("WAProtoValidate").checkRequirements(e,r),r}function u(e,t){var n=new(o("WABinary")).Binary(t),r=h(e,n,void 0,!0,!1);return o("WAProtoValidate").checkRequirements(e,r),r}function c(e){return r("WAHasProperty")(e,"$$unsafeUnknownFields")?e.$$unsafeUnknownFields:null}function d(e,t,n){if(e!==o("WAProtoUtils").typeToEncType(t))throw new Error("FormatError: "+n+" encoded with wire type "+e)}function m(e,t,n){switch(t){case o("WAProtoConst").TYPES.INT32:return p(n,-2147483648,2147483648,e,o("WABinary").parseInt64OrThrow);case o("WAProtoConst").TYPES.INT64:return n.readVarInt(_);case o("WAProtoConst").TYPES.UINT32:return p(n,0,4294967296,e,o("WABinary").parseUint64OrThrow);case o("WAProtoConst").TYPES.UINT64:return n.readVarInt(f);case o("WAProtoConst").TYPES.SINT32:{var r=p(n,0,4294967296,e,o("WABinary").parseInt64OrThrow);return r&1?~(r>>>1):r>>>1}case o("WAProtoConst").TYPES.SINT64:return n.readVarInt(g);case o("WAProtoConst").TYPES.BOOL:return!!p(n,0,2,e,o("WABinary").parseUint64OrThrow);case o("WAProtoConst").TYPES.ENUM:return n.readVarInt(o("WABinary").parseInt64OrThrow);case o("WAProtoConst").TYPES.FIXED64:return n.readLong(f,!0);case o("WAProtoConst").TYPES.SFIXED64:return n.readLong(_,!0);case o("WAProtoConst").TYPES.DOUBLE:return n.readFloat64(!0);case o("WAProtoConst").TYPES.STRING:return n.readString(n.readVarInt(o("WABinary").parseUint64OrThrow));case o("WAProtoConst").TYPES.BYTES:return n.readBuffer(n.readVarInt(o("WABinary").parseUint64OrThrow));case o("WAProtoConst").TYPES.FIXED32:return n.readUint32(!0);case o("WAProtoConst").TYPES.SFIXED32:return n.readInt32(!0);case o("WAProtoConst").TYPES.FLOAT:return n.readFloat32(!0)}}function p(e,t,n,r,o){var a=e.readVarInt(o);if(a<t||a>=n)throw new Error("FormatError: "+r+" encoded with out-of-range value "+a);return a}function _(e,t){var n=o("WABinary").longFitsInDouble(!0,e,t);if(n){var r=y(t);return e*4294967296+r}else{var a=e<0,i;a?i=t===0?-e:~e:i=e;var l=a?-t:t;return o("WAHex").createHexLongFrom32Bits(i,l,a)}}function f(e,t){var n=o("WABinary").longFitsInDouble(!1,e,t);if(n){var r=y(e),a=y(t);return r*4294967296+a}else return o("WAHex").createHexLongFrom32Bits(e,t)}function g(e,t){var n=e>>>1,r=e<<31|t>>>1;return t&1&&(n=~n,r=~r),_(n,r)}function h(e,t,n,r,a){var i,l=o("WAProtoCompile").compileSpec(e),s=l.names,u=l.fields,c=l.types,_=l.meta,f=l.oneofToFields,g=l.fieldToOneof,y=l.reservedTags,C=l.reservedFields,b=e.internalDefaults,v=n||babelHelpers.extends({},b)||{};v.$$unknownFieldCount=(i=n==null?void 0:n.$$unknownFieldCount)!=null?i:0;for(var S=0;S<s.length;S++)c[S]&o("WAProtoConst").FLAGS.REPEATED?v[s[S]]=[]:c[S]===(o("WAProtoConst").TYPES.MAP&o("WAProtoConst").TYPE_MASK)&&(v[s[S]]=new Map);for(var R=0,L=u.length>0,E=u[0],k=function(){var e=p(t,0,4294967296,"field and enc type",o("WABinary").parseInt64OrThrow),n=e&7,i=e>>>3;if(L&&i!==E){var l=R;do++R===u.length&&(R=0),E=u[R];while(i!==E&&R!==l)}if(L&&i===E){var b=s[R],S=c[R];d(n,S,b);var k=S&o("WAProtoConst").TYPE_MASK,I=_[R];if(S&o("WAProtoConst").FLAGS.PACKED)for(var T=t.readVarInt(o("WABinary").parseUint64OrThrow),D=t.readBinary(T);D.size();){var x=m(b,k,D);(k!==o("WAProtoConst").TYPES.ENUM||I[x]||(I.cast==null?void 0:I.cast(x))!==void 0)&&v[b].push(x)}else if(k===o("WAProtoConst").TYPES.MESSAGE){var $=t.readVarInt(o("WABinary").parseUint64OrThrow),P=t.readBinary($);if(S&o("WAProtoConst").FLAGS.REPEATED)v[b].push(h(I,P,void 0,r,a));else{var N=v[b];v[b]=h(I,P,N,r,a)}}else if(k===o("WAProtoConst").TYPES.MAP){for(var M=t.readVarInt(o("WABinary").parseUint64OrThrow),w=t.readBinary(M),A,F,O=0;O<_[R].length;O++){var B=p(w,0,4294967296,"map field and enc type",o("WABinary").parseInt64OrThrow),W=B&7,q=B>>>3,U=void 0;switch(W){case o("WAProtoConst").ENC.VARINT:U=w.readVarInt(o("WABinary").parseInt64OrThrow);break;case o("WAProtoConst").ENC.BIT64:U=w.readBinary(8);break;case o("WAProtoConst").ENC.BINARY:{var V=I[O];if(V===o("WAProtoConst").TYPES.BYTES||V===o("WAProtoConst").TYPES.STRING)U=m(b,V,w);else{var H=w.readVarInt(o("WABinary").parseUint64OrThrow),G=w.readBinary(H);U=h(V,G,void 0,r,a)}break}case o("WAProtoConst").ENC.BIT32:U=w.readBinary(4);break}q===1?A=U:F=U}v[b].set(A,F)}else{var z=m(b,k,t);(k!==o("WAProtoConst").TYPES.ENUM||I[z]||(I.cast==null?void 0:I.cast(z))!==void 0)&&(S&o("WAProtoConst").FLAGS.REPEATED?v[b].push(z):v[b]=z)}var j=g[b];j&&typeof v[b]!="undefined"&&j.forEach(function(e){var t=f[e].filter(function(e){return e!==b});if(t.forEach(function(e){delete v[e]}),a){var n;v[e]=(n={type:b,value:v[b]},n[o("WABaseProto").TAGGED_UNION_TAG]=!0,n),delete v[b]}}),(y[i]||C[b])&&delete v[b]}else if(v.$$unknownFieldCount++,r){v.$$unsafeUnknownFields||(v.$$unsafeUnknownFields={});var K;switch(n){case o("WAProtoConst").ENC.VARINT:K=t.readVarInt(o("WABinary").parseInt64OrThrow);break;case o("WAProtoConst").ENC.BIT64:K=t.readBinary(8);break;case o("WAProtoConst").ENC.BINARY:K=t.readBinary(t.readVarInt(o("WABinary").parseUint64OrThrow));break;case o("WAProtoConst").ENC.BIT32:K=t.readBinary(4);break}v.$$unsafeUnknownFields[i]=K}else n===o("WAProtoConst").ENC.VARINT?t.readVarInt(o("WABinary").parseInt64OrThrow):n===o("WAProtoConst").ENC.BIT64?t.advance(8):n===o("WAProtoConst").ENC.BINARY?t.advance(t.readVarInt(o("WABinary").parseUint64OrThrow)):n===o("WAProtoConst").ENC.BIT32&&t.advance(4)};t.size();)k();return v}function y(e){return e>=0?e:4294967296+e}l.decodeProtobuf=e,l.decodeProtobufWithTaggedUnions=s,l.decodeProtobufWithUnknowns=u,l.getUnknownFields=c,l.assertEncType=d,l.readValue=m,l.readBoundVarInt=p}),98);
__d("encodeProtobuf",["WABinary","WAHex","WAProtoCompile","WAProtoConst","WAProtoUtils","WAProtoValidate"],(function(t,n,r,o,a,i,l){"use strict";var e=void 0,s=128;function u(t,n,r){return r===void 0&&(r=new(o("WABinary")).Binary),o("WAProtoValidate").checkValid(t,n),b(r,n,t),e=void 0,r}function c(){return e!==void 0?"Last encoded value for "+e:"No information known"}function d(e,t){e.writeVarInt(t)}function m(e,t){if(typeof t=="number"&&t<4503599627370496&&t>=-4503599627370496)e.writeVarInt(t>=0?2*t:2*-t-1);else{var n=new(o("WABinary")).Binary,r;typeof t=="number"?(r=t<0,n.writeVarInt(r?-t:t)):(r=o("WAHex").hexLongIsNegative(t),n.writeVarIntFromHexLong(r?o("WAHex").negateHexLong(t):t));var a=n.peek(function(){return n.readByteArrayView()}),i=a.byteLength;if(r){var l=0,u;do u=a[l],a[l]=u&s|(u&127)-1&127,l++;while(a[l-1]===255)}for(var c=r?1:0,d=0;d<i;d++){var m=a[d],p=m&s|(m&63)<<1|c;c=(m&64)>>6,a[d]=p}c===1&&(a[i-1]|=s,n.writeInt8(1)),e.writeBinary(n)}}function p(e,t){typeof t=="number"?e.writeVarInt(t):e.writeVarIntFromHexLong(t)}function _(e,t){e.writeVarInt(o("WABinary").numUtf8Bytes(t)),e.writeString(t)}function f(e,t){e.writeVarInt(t.byteLength),e.writeBuffer(t)}function g(e,t,n){e.writeWithVarIntLength(function(e,t){return b(e,t,n)},t)}var h=[void 0,d,p,d,p,m,m,function(e,t){e.writeVarInt(t?1:0)},d,function(e,t){typeof t=="number"?e.writeUint64(t,!0):e.writeHexLong(t,!0)},function(e,t){typeof t=="number"?e.writeInt64(t,!0):e.writeHexLong(t,!0)},function(e,t){e.writeFloat64(t,!0)},_,f,g,function(e,t){e.writeUint32(t,!0)},function(e,t){e.writeInt32(t,!0)},function(e,t){e.writeFloat32(t,!0)}],y=function(t){if(t==null)return;var e=t;function n(t,n){for(var r=0;r<n.length;r++)e(t,n[r])}return function(e,t){e.writeWithVarIntLength(n,t)}},C=h.map(y);function b(t,n,r){for(var a=o("WAProtoCompile").compileSpec(r),i=a.names,l=a.fields,s=a.types,u=a.meta,c=r.internalDefaults,d=0;d<i.length;d++){var m=i[d],p=n[m];if(p==null&&c&&(p=c[m]),p!=null){e=m;var _=l[d],f=s[d],g=f&o("WAProtoConst").TYPE_MASK,y=u[d],b=_*8|o("WAProtoUtils").typeToEncType(f);if(f&o("WAProtoConst").FLAGS.PACKED){if(p.length>0){t.writeVarInt(b);var v=C[g];v(t,p,y)}}else if(f&o("WAProtoConst").FLAGS.REPEATED)for(var S=0;S<p.length;S++){t.writeVarInt(b);var R=h[g];R(t,p[S],y)}else if(g===o("WAProtoConst").TYPES.MAP)for(var L of p){var E=L[0],k=L[1];t.writeVarInt(b);var I=y[0],T=y[1],D=typeof T=="object"?o("WAProtoConst").TYPES.MESSAGE:T,x=h[I],$=h[D];if(x==null||$==null)throw new Error("Invalid encoder for map key/value");var P=new(o("WABinary")).Binary,N=8|o("WAProtoUtils").typeToEncType(I);P.writeVarInt(N),x(P,E,I);var M=16|o("WAProtoUtils").typeToEncType(D);P.writeVarInt(M),$(P,k,T),t.writeVarInt(P.size()),t.writeBinary(P)}else{t.writeVarInt(b);var w=h[g];w(t,p,y)}}}}l.encodeProtobuf=u,l.encodeErrorInfo=c}),98);
__d("WAMediaUtils",["WACryptoDependencies","WADirectPath","WALongInt","WAMediaEntryData.pb","WAProgressiveJpegGetScanLengths","WAResultOrError","WAServerMediaType","WATimeUtils","decodeProtobuf","encodeProtobuf","err"],(function(t,n,r,o,a,i,l){"use strict";var e=["$$unknownFieldCount","directPath","objectId"],s=["serverMediaType","mediaKey","mediaKeyTimestamp","uploadToken","downloadableThumbnail","progressiveJpegDetails","size","lastDownloadAttemptTimestamp","sidecar","directPath","objectId"];function u(){var e=new Uint8Array(32);return o("WACryptoDependencies").getCrypto().getRandomValues(e),e.buffer}function c(e){return e}function d(){return u()}function m(e){return e}function p(e){return e}function _(e){return e}function f(e){return e}function g(e,t){var n=o("decodeProtobuf").decodeProtobuf(o("WAMediaEntryData.pb").MediaEntrySpec,t),r=n.fileSha256,a=n.mediaKey,i=n.fileEncSha256,l=n.directPath,s=n.mediaKeyTimestamp,u=n.sidecar,c=n.objectId,d=n.fbid,m=n.serverMediaType,_=n.downloadableThumbnail,f=n.filename,g=n.progressiveJpegDetails,h=n.size,y=o("WADirectPath").validateDirectPath(l);return{fileSha256:r,mediaKey:a,fileEncSha256:i,directPath:y.success?y.value:null,mediaKeyTimestamp:o("WALongInt").maybeNumberOrThrowIfTooLarge(s),sidecar:u&&u,objectId:c,fbid:d,downloadableThumbnail:_==null?void 0:{directPath:_.directPath,fileEncSha256:_.fileEncSha256,fileSha256:_.fileSha256,mediaKey:_.mediaKey,mediaKeyTimestamp:o("WALongInt").maybeNumberOrThrowIfTooLarge(_.mediaKeyTimestamp),objectId:_.objectId},serverMediaType:m,filename:f,progressiveJpegDetails:g&&L(g),size:h==null?void 0:o("WALongInt").numberOrThrowIfTooLarge(h)}}function h(e){var t=e.fileSha256,n=e.fileEncSha256,r=e.mediaKey,a=e.directPath,i=e.mediaKeyTimestamp,l=e.serverMediaType,s=e.objectId,u=e.fbid,c=e.downloadableThumbnail,d=e.filename,m=e.progressiveJpegDetails,p=e.size,_=o("encodeProtobuf").encodeProtobuf(o("WAMediaEntryData.pb").MediaEntrySpec,{fileSha256:t,fileEncSha256:n,mediaKey:r,directPath:a,mediaKeyTimestamp:i,serverMediaType:l,objectId:s,fbid:u,downloadableThumbnail:c,filename:d,progressiveJpegDetails:m,size:p});return _.readByteArrayView()}function y(e){return o("encodeProtobuf").encodeProtobuf(o("WAMediaEntryData.pb").MediaEntrySpec,e).readByteArrayView()}function C(e,t){return o("encodeProtobuf").encodeProtobuf(o("WAMediaEntryData.pb").MediaEntrySpec,babelHelpers.extends({},e,{directPath:t})).readByteArrayView()}function b(e,t){return o("encodeProtobuf").encodeProtobuf(o("WAMediaEntryData.pb").MediaEntrySpec,babelHelpers.extends({},e,{downloadableThumbnail:babelHelpers.extends({},e.downloadableThumbnail,{directPath:t})})).readByteArrayView()}function v(e,t){var n=babelHelpers.extends({},e,{fbid:t});return o("encodeProtobuf").encodeProtobuf(o("WAMediaEntryData.pb").MediaEntrySpec,n).readByteArrayView()}function S(e,t){var n=babelHelpers.extends({},e,{objectId:t});return o("encodeProtobuf").encodeProtobuf(o("WAMediaEntryData.pb").MediaEntrySpec,n).readByteArrayView()}function R(t){if(t==null)return null;var n=t.$$unknownFieldCount,r=t.directPath,a=t.objectId,i=babelHelpers.objectWithoutPropertiesLoose(t,e),l=o("WADirectPath").validateDirectPath(r);return babelHelpers.extends({},i,{directPath:l.success?l.value:null,objectId:a,mediaKey:t.mediaKey&&t.mediaKey,mediaKeyTimestamp:t.mediaKeyTimestamp==null?null:o("WATimeUtils").castToUnixTime(o("WALongInt").numberOrThrowIfTooLarge(t.mediaKeyTimestamp))})}function L(e){return e==null||e.scanLengths==null||e.sidecar==null?null:{sidecar:e.sidecar,scanLengths:e.scanLengths.map(function(e){return o("WAProgressiveJpegGetScanLengths").asProgressiveJpegScanLength(o("WALongInt").numberOrThrowIfTooLarge(e))})}}function E(e){var t=o("decodeProtobuf").decodeProtobuf(o("WAMediaEntryData.pb").MediaEntrySpec,e),n=t.serverMediaType,r=t.mediaKey,a=t.mediaKeyTimestamp,i=t.uploadToken,l=t.downloadableThumbnail,u=t.progressiveJpegDetails,d=t.size,p=t.lastDownloadAttemptTimestamp,_=t.sidecar,f=t.directPath,g=t.objectId,h=babelHelpers.objectWithoutPropertiesLoose(t,s),y=null;u!=null&&u.scanLengths!=null&&u.sidecar!=null&&(y={sidecar:u.sidecar,scanLengths:u.scanLengths.map(function(e){return o("WAProgressiveJpegGetScanLengths").asProgressiveJpegScanLength(o("WALongInt").numberOrThrowIfTooLarge(e))})});var C=o("WADirectPath").validateDirectPath(f);return babelHelpers.extends({},h,{objectId:g,directPath:C.success?C.value:void 0,sidecar:_,serverMediaType:n==null?null:o("WAServerMediaType").castToServerMediaType(n),mediaKey:r&&r,mediaKeyTimestamp:a==null?null:o("WATimeUtils").castToUnixTime(o("WALongInt").numberOrThrowIfTooLarge(a)),uploadToken:i&&i,progressiveJpegDetails:y,downloadableThumbnail:l&&R(l),size:o("WALongInt").maybeNumberOrThrowIfTooLarge(d),lastDownloadAttemptTimestamp:p==null?null:o("WATimeUtils").castToUnixTime(o("WALongInt").numberOrThrowIfTooLarge(p))})}function k(e){var t=e.directPath,n=e.fileEncSha256,r=e.fileSha256,a=e.mediaKey,i=e.serverMediaType;return a==null?o("WAResultOrError").makeError("media-entry-invalid-media-key"):t==null?o("WAResultOrError").makeError("media-entry-invalid-direct-path"):n==null?o("WAResultOrError").makeError("media-entry-invalid-file-enc-sha256"):r==null?o("WAResultOrError").makeError("media-entry-invalid-file-sha256"):i==null?o("WAResultOrError").makeError("media-entry-invalid-server-media-type"):o("WAResultOrError").makeResult(babelHelpers.extends({},e,{directPath:t,fileEncSha256:n,fileSha256:r,mediaKey:a,serverMediaType:i}))}function I(e){var t=e.directPath,n=e.fileEncSha256,r=e.fileSha256,a=e.mediaKey,i=[];return a==null?i.push("media-entry-invalid-media-key"):t==null?i.push("media-entry-invalid-direct-path"):n==null?i.push("media-entry-invalid-file-enc-sha256"):r==null&&i.push("media-entry-invalid-file-sha256"),a!=null&&t!=null&&n!=null&&r!=null?o("WAResultOrError").makeResult(babelHelpers.extends({},e,{directPath:t,fileEncSha256:n,fileSha256:r,mediaKey:a})):o("WAResultOrError").makeError(i)}function T(e){var t="image/jpeg";switch(e){case"image":t="image/jpeg";break;case"ptt":t="audio/wav";break;case"video":t="video/mp4";break;case"gif":t="image/gif";break;case"sticker":t="image/webp";break;case"preview":t="image/jpeg";break;case"document":t="application/octet-stream";break;case"xma-image":t="image/jpeg";break;default:throw r("err")("Unsupported server media type: "+e)}return t}var D=function(){return"TransformStream"in self};l.createMediaKey=u,l.castToMediaKey=c,l.createUploadToken=d,l.castToUploadToken=m,l.castToStreamingSidecar=p,l.stringToDeliveryObjectId=_,l.stringToBackupEntFbid=f,l.mediaEntryDataToRawData=g,l.rawDataToMediaEntry=h,l.encodeMediaEntryForUpload=y,l.encodeMediaEntryWithUpdatedPath=C,l.encodeMediaEntryDownloadableThumbnailWithUpdatedPath=b,l.encodeMediaEntryWithUpdatedFbid=v,l.encodeMediaEntryWithUpdatedObjectId=S,l.convertMediaDownloadableThumbnailToDownloadableThumbnail=R,l.decodeMediaEntryData=E,l.validateDecodedMediaEntryForDownload=k,l.validateDownloadableThumbnailForDownload=I,l.getMimeTypeFromServerMediaType=T,l.isTransformStreamSupported=D}),98);
__d("MAWDbMedia",["I64","MAWMsgType","WAMediaUtils","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u={DOCUMENT_FILE:(s=o("MAWMsgType")).MSG_TYPE.DOCUMENT_FILE,GIF:s.MSG_TYPE.GIF,IMAGE:s.MSG_TYPE.IMAGE,PTT:s.MSG_TYPE.PTT,STICKER:s.MSG_TYPE.STICKER,VIDEO:s.MSG_TYPE.VIDEO};function c(e){return e}function d(e){return e}function m(t){return(e||(e=o("I64"))).of_float(t)}function p(t){return(e||(e=o("I64"))).to_float(t)}function _(e,t){var n=e.mediaEntries.get(t);if(n==null)return o("WAResultOrError").makeError("missing-media-entry");var r=o("WAMediaUtils").decodeMediaEntryData(n),a=r.serverMediaType;return a==null?o("WAResultOrError").makeError("missing-server-media-type"):o("WAResultOrError").makeResult(a)}l.MEDIA_TYPE=u,l.convertNumberToMediaId=c,l.convertToMediaId64=d,l.convertMediaIdToMediaId64=m,l.convertMediaId64ToMediaId=p,l.getServerMediaType=_}),98);
__d("MAWHexUtils",["FBLogger"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.toString(16);return(t.length-1).toString(16)+t}function s(e){for(var t=1;t<e.length;t++){var n=e.substring(0,t),o=e.substring(t);if(o.length-1===parseInt(n,16))return parseInt(o,16)}throw r("FBLogger")("messenger_web").mustfixThrow("Cannot convert the order-preserving-hex back to number")}l.orderPreservingHex=e,l.reverseOrderPreservingHex=s}),98);
__d("WAMsg",["WAAssertUnreachable","WAJids","WAMsgType","err"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.author,n=e.chat,r=e.externalId;return n+"_"+r+"_"+t}function s(e){switch(e.type){case o("WAMsgType").MSG_TYPE.TEXT:case o("WAMsgType").MSG_TYPE.IMAGE:case o("WAMsgType").MSG_TYPE.VIDEO:case o("WAMsgType").MSG_TYPE.PTT:case o("WAMsgType").MSG_TYPE.GIF:case o("WAMsgType").MSG_TYPE.STICKER:case o("WAMsgType").MSG_TYPE.RECEIVER_FETCH:return{author:e.id.author,deleteTs:e.deleteTs,ephemeralSetting:e.ephemeralSetting,expirationTs:e.expirationTs,externalId:e.id.externalId,sentTs:e.sentTs,serverTs:e.serverTs,ts:e.ts};case o("WAMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case o("WAMsgType").MSG_TYPE.UNAVAILABLE:return{author:e.id.author,externalId:e.id.externalId,sentTs:e.sentTs,ts:e.ts};default:return e.type,null}}function u(e){var t=s(e);if(t==null)return null;switch(e.type){case o("WAMsgType").MSG_TYPE.TEXT:return babelHelpers.extends({},t,{msgContent:e.msgContent,type:o("WAMsgType").MSG_TYPE.TEXT});case o("WAMsgType").MSG_TYPE.IMAGE:return babelHelpers.extends({},t,{mediaId:e.mediaId,type:o("WAMsgType").MSG_TYPE.IMAGE});case o("WAMsgType").MSG_TYPE.VIDEO:return babelHelpers.extends({},t,{mediaId:e.mediaId,type:o("WAMsgType").MSG_TYPE.VIDEO});case o("WAMsgType").MSG_TYPE.PTT:return babelHelpers.extends({},t,{mediaId:e.mediaId,type:o("WAMsgType").MSG_TYPE.PTT});case o("WAMsgType").MSG_TYPE.STICKER:return babelHelpers.extends({},t,{mediaId:e.mediaId,type:o("WAMsgType").MSG_TYPE.STICKER});case o("WAMsgType").MSG_TYPE.RECEIVER_FETCH:return babelHelpers.extends({},t,{type:o("WAMsgType").MSG_TYPE.RECEIVER_FETCH});case o("WAMsgType").MSG_TYPE.GIF:return babelHelpers.extends({},t,{mediaId:e.mediaId,type:o("WAMsgType").MSG_TYPE.PTT});case o("WAMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:return babelHelpers.extends({},t,{type:o("WAMsgType").MSG_TYPE.EXPIRED_EPHEMERAL});case o("WAMsgType").MSG_TYPE.UNAVAILABLE:return babelHelpers.extends({},t,{type:o("WAMsgType").MSG_TYPE.UNAVAILABLE});case o("WAMsgType").MSG_TYPE.REVOKED:case o("WAMsgType").MSG_TYPE.REACTION:case o("WAMsgType").MSG_TYPE.ICDC_ALERT:case o("WAMsgType").MSG_TYPE.ADMIN:case o("WAMsgType").MSG_TYPE.FUTUREPROOF:case o("WAMsgType").MSG_TYPE.CIPHERTEXT:case o("WAMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case o("WAMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case o("WAMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:case o("WAMsgType").MSG_TYPE.GROUP_INVITE:case o("WAMsgType").MSG_TYPE.DELETE_FOR_ME:case o("WAMsgType").MSG_TYPE.DOCUMENT_FILE:case o("WAMsgType").MSG_TYPE.EDIT_ACTION:return null;default:return r("WAAssertUnreachable")(e.type)}}function c(e){if(o("WAJids").isAuthorSystem(e.author))throw r("err")("Cannot send @system messages");return{author:e.author,chat:e.chat,externalId:e.externalId}}l.craftWAMsgIdString=e,l.asQuotedMsg=u,l.asProtocolMsgId=c}),98);
__d("MAWDbMsg",["FBLogger","I64","MAWDbChatId__UNSAFE_DO_NOT_USE","MAWHexUtils","MAWMsgType","WAMsg"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=[(s=o("MAWMsgType")).MSG_TYPE.REVOKED,s.MSG_TYPE.EPHEMERAL_SYNC_RESPONSE,s.MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE,s.MSG_TYPE.GROUP_INVITE,s.MSG_TYPE.SK_DISTRIBUTION,s.MSG_TYPE.RAVEN_ACTION],c=0,d=Number.MAX_SAFE_INTEGER;function m(e){return e}function p(e){return e}function _(e){return D(e)?e:null}function f(e){return e}function g(e){return e}var h="futureproof",y="futureproof_spam",C="spam",b="toBeRead",v="e2ee_admin_msg",S="cutover_admin_msg";function R(e,t){return o("MAWHexUtils").orderPreservingHex(e)+"_"+o("MAWHexUtils").orderPreservingHex(t)+"_m"}function L(e,t,n){var r=o("MAWHexUtils").orderPreservingHex(e)+"_"+o("MAWHexUtils").orderPreservingHex(t)+"_m";return r+"_"+n.externalId}function E(e,t){return o("MAWHexUtils").orderPreservingHex(e)+"_"+o("MAWHexUtils").orderPreservingHex(t)+"_um"}function k(e,t){return o("MAWHexUtils").orderPreservingHex(e)+"_"+o("MAWHexUtils").orderPreservingHex(t)+"_r"}function I(e,t,n){var r=n!=null?n:o("MAWHexUtils").orderPreservingHex(Math.floor(Math.random()*1e4));return o("MAWHexUtils").orderPreservingHex(e)+"_"+o("MAWHexUtils").orderPreservingHex(t)+"_DEBUG_"+r+")}"}function T(e){var t=e.split("_");return t.length>=3&&t[0]!==""&&t[1]!==""&&t[2]==="m"}function D(e){var t=/^(.*)\..*?$/,n=t.test(e);return T(e)||n}function x(e){return o("MAWDbChatId__UNSAFE_DO_NOT_USE").craftAltIndex__DEPRECATED(e,b)}function $(e){return o("MAWDbChatId__UNSAFE_DO_NOT_USE").craftAltIndex__DEPRECATED(e,v)}function P(e){return o("MAWDbChatId__UNSAFE_DO_NOT_USE").craftAltIndex__DEPRECATED(e,S)}function N(e){if(!T(e))return 0;var t=e.split("_"),n=t[0],r=t[1];return o("MAWHexUtils").reverseOrderPreservingHex(r)}function M(e){return o("MAWHexUtils").orderPreservingHex(e)+"_"}function w(e){return o("MAWHexUtils").orderPreservingHex(e)+"_z"}function A(e){switch(e.type){case o("MAWMsgType").MSG_TYPE.XMA:return!0;case o("MAWMsgType").MSG_TYPE.IMAGE:case o("MAWMsgType").MSG_TYPE.VIDEO:case o("MAWMsgType").MSG_TYPE.PTT:case o("MAWMsgType").MSG_TYPE.GIF:case o("MAWMsgType").MSG_TYPE.STICKER:case o("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case o("MAWMsgType").MSG_TYPE.TEXT:case o("MAWMsgType").MSG_TYPE.FUTUREPROOF:case o("MAWMsgType").MSG_TYPE.CIPHERTEXT:case o("MAWMsgType").MSG_TYPE.UNAVAILABLE:case o("MAWMsgType").MSG_TYPE.ADMIN:case o("MAWMsgType").MSG_TYPE.REVOKED:case o("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case o("MAWMsgType").MSG_TYPE.ICDC_ALERT:case o("MAWMsgType").MSG_TYPE.GROUP_INVITE:case o("MAWMsgType").MSG_TYPE.RAVEN:case o("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:case o("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:case o("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE:case o("MAWMsgType").MSG_TYPE.GROUP_POLL_UPDATE:return!1}throw r("FBLogger")("messenger_web").mustfixThrow('Invalid msg type for isXMAMsg check: "%s"',e.type)}function F(e){switch(e.type){case o("MAWMsgType").MSG_TYPE.IMAGE:case o("MAWMsgType").MSG_TYPE.VIDEO:case o("MAWMsgType").MSG_TYPE.PTT:case o("MAWMsgType").MSG_TYPE.GIF:case o("MAWMsgType").MSG_TYPE.STICKER:case o("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case o("MAWMsgType").MSG_TYPE.RAVEN:return!0;case o("MAWMsgType").MSG_TYPE.TEXT:case o("MAWMsgType").MSG_TYPE.FUTUREPROOF:case o("MAWMsgType").MSG_TYPE.CIPHERTEXT:case o("MAWMsgType").MSG_TYPE.UNAVAILABLE:case o("MAWMsgType").MSG_TYPE.ADMIN:case o("MAWMsgType").MSG_TYPE.REVOKED:case o("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case o("MAWMsgType").MSG_TYPE.ICDC_ALERT:case o("MAWMsgType").MSG_TYPE.GROUP_INVITE:case o("MAWMsgType").MSG_TYPE.XMA:case o("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:case o("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:case o("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE:case o("MAWMsgType").MSG_TYPE.GROUP_POLL_UPDATE:return!1}throw r("FBLogger")("messenger_web").mustfixThrow('Invalid msg type for isMediaMsg check: "%s"',e.type)}function O(e){return e.type===o("MAWMsgType").MSG_TYPE.RECEIVER_FETCH}function B(e){switch(e.type){case o("MAWMsgType").MSG_TYPE.IMAGE:case o("MAWMsgType").MSG_TYPE.VIDEO:return!0;case o("MAWMsgType").MSG_TYPE.PTT:case o("MAWMsgType").MSG_TYPE.GIF:case o("MAWMsgType").MSG_TYPE.STICKER:case o("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case o("MAWMsgType").MSG_TYPE.RAVEN:case o("MAWMsgType").MSG_TYPE.TEXT:case o("MAWMsgType").MSG_TYPE.FUTUREPROOF:case o("MAWMsgType").MSG_TYPE.CIPHERTEXT:case o("MAWMsgType").MSG_TYPE.UNAVAILABLE:case o("MAWMsgType").MSG_TYPE.ADMIN:case o("MAWMsgType").MSG_TYPE.REVOKED:case o("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case o("MAWMsgType").MSG_TYPE.ICDC_ALERT:case o("MAWMsgType").MSG_TYPE.GROUP_INVITE:case o("MAWMsgType").MSG_TYPE.XMA:case o("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:case o("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:case o("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE:return!1;default:return r("FBLogger")("messenger_web").mustfix('Invalid msg type for isPhotoOrVideoMediaMsg check: "%s"',e.type),!1}}function W(e){switch(e.type){case o("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:return!0;case o("MAWMsgType").MSG_TYPE.IMAGE:case o("MAWMsgType").MSG_TYPE.VIDEO:case o("MAWMsgType").MSG_TYPE.PTT:case o("MAWMsgType").MSG_TYPE.GIF:case o("MAWMsgType").MSG_TYPE.STICKER:case o("MAWMsgType").MSG_TYPE.RAVEN:case o("MAWMsgType").MSG_TYPE.TEXT:case o("MAWMsgType").MSG_TYPE.FUTUREPROOF:case o("MAWMsgType").MSG_TYPE.CIPHERTEXT:case o("MAWMsgType").MSG_TYPE.UNAVAILABLE:case o("MAWMsgType").MSG_TYPE.ADMIN:case o("MAWMsgType").MSG_TYPE.REVOKED:case o("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case o("MAWMsgType").MSG_TYPE.ICDC_ALERT:case o("MAWMsgType").MSG_TYPE.GROUP_INVITE:case o("MAWMsgType").MSG_TYPE.XMA:case o("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:case o("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:case o("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE:return!1;default:return r("FBLogger")("messenger_web").mustfix('Invalid msg type for isDocumentFileMediaMsg check: "%s"',e.type),!1}}function q(e){switch(e.type){case o("MAWMsgType").MSG_TYPE.TEXT:case o("MAWMsgType").MSG_TYPE.IMAGE:case o("MAWMsgType").MSG_TYPE.VIDEO:case o("MAWMsgType").MSG_TYPE.PTT:case o("MAWMsgType").MSG_TYPE.GIF:case o("MAWMsgType").MSG_TYPE.STICKER:case o("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case o("MAWMsgType").MSG_TYPE.REVOKED:case o("MAWMsgType").MSG_TYPE.DELETE_FOR_ME:case o("MAWMsgType").MSG_TYPE.XMA:case o("MAWMsgType").MSG_TYPE.RAVEN:case o("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:case o("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:case o("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE:return!0;case o("MAWMsgType").MSG_TYPE.FUTUREPROOF:case o("MAWMsgType").MSG_TYPE.CIPHERTEXT:case o("MAWMsgType").MSG_TYPE.UNAVAILABLE:case o("MAWMsgType").MSG_TYPE.ADMIN:case o("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:case o("MAWMsgType").MSG_TYPE.ICDC_ALERT:case o("MAWMsgType").MSG_TYPE.GROUP_INVITE:case o("MAWMsgType").MSG_TYPE.SK_DISTRIBUTION:case o("MAWMsgType").MSG_TYPE.RAVEN_ACTION:case o("MAWMsgType").MSG_TYPE.EDIT_ACTION:return!1}throw r("FBLogger")("messenger_web").mustfixThrow('Invalid msg type for isContentMsg check: "%s"',e.type)}function U(e){switch(e.type){case o("MAWMsgType").MSG_TYPE.TEXT:case o("MAWMsgType").MSG_TYPE.IMAGE:case o("MAWMsgType").MSG_TYPE.VIDEO:case o("MAWMsgType").MSG_TYPE.PTT:case o("MAWMsgType").MSG_TYPE.GIF:case o("MAWMsgType").MSG_TYPE.STICKER:case o("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case o("MAWMsgType").MSG_TYPE.XMA:case o("MAWMsgType").MSG_TYPE.RAVEN:case o("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:case o("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:return!0;case o("MAWMsgType").MSG_TYPE.FUTUREPROOF:case o("MAWMsgType").MSG_TYPE.CIPHERTEXT:case o("MAWMsgType").MSG_TYPE.UNAVAILABLE:case o("MAWMsgType").MSG_TYPE.ADMIN:case o("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:case o("MAWMsgType").MSG_TYPE.ICDC_ALERT:case o("MAWMsgType").MSG_TYPE.GROUP_INVITE:case o("MAWMsgType").MSG_TYPE.REVOKED:case o("MAWMsgType").MSG_TYPE.DELETE_FOR_ME:case o("MAWMsgType").MSG_TYPE.SK_DISTRIBUTION:case o("MAWMsgType").MSG_TYPE.EDIT_ACTION:case o("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE:return!1}throw r("FBLogger")("messenger_web").mustfixThrow('Invalid msg type for isMsgEligibleForTriggeringEphemeralSyncResponse check: "%s"',e.type)}function V(e){return G(e.type)}function H(e){return e.type===o("MAWMsgType").MSG_TYPE.ADMIN}function G(e){return e==="EphemeralSyncResponse"||e==="EphemeralSettingChangeFromCurrentDevice"||e==="GroupInvite"||e==="SenderKeyDistribution"||e==="RavenAction"||e==="EditAction"}function z(e){return e==="RavenAction"}function j(e){return e.originalTs!=null?e.originalTs:K(e)}function K(e){return e.serverTs!=null?e.serverTs:e.ts}function Q(e){return e.sortOrderMs!=null?e.sortOrderMs:K(e)*1e3}function X(e,t){return e.serverTs!=null?Math.max(t+1,e.serverTs*1e3):t+1}function Y(e){switch(e.type){case o("MAWMsgType").MSG_TYPE.TEXT:return e.msgContent;case o("MAWMsgType").MSG_TYPE.EDIT_ACTION:return e.editMsgContent;case o("MAWMsgType").MSG_TYPE.IMAGE:case o("MAWMsgType").MSG_TYPE.VIDEO:case o("MAWMsgType").MSG_TYPE.PTT:case o("MAWMsgType").MSG_TYPE.GIF:case o("MAWMsgType").MSG_TYPE.STICKER:case o("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case o("MAWMsgType").MSG_TYPE.REVOKED:case o("MAWMsgType").MSG_TYPE.DELETE_FOR_ME:case o("MAWMsgType").MSG_TYPE.FUTUREPROOF:case o("MAWMsgType").MSG_TYPE.CIPHERTEXT:case o("MAWMsgType").MSG_TYPE.UNAVAILABLE:case o("MAWMsgType").MSG_TYPE.ADMIN:case o("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case o("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:case o("MAWMsgType").MSG_TYPE.ICDC_ALERT:case o("MAWMsgType").MSG_TYPE.GROUP_INVITE:case o("MAWMsgType").MSG_TYPE.XMA:case o("MAWMsgType").MSG_TYPE.RAVEN:case o("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:case o("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:case o("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE:return}throw r("FBLogger")("messenger_web").mustfixThrow('Invalid msg type for getMsgContent check: "%s"',e.type)}function J(e){return o("WAMsg").craftWAMsgIdString({author:e.author,chat:e.threadJid,externalId:e.externalId})}function Z(t){return(e||(e=o("I64"))).to_float(t)}l.NO_CONTENT_MESSAGE_TYPES_ALLOWLIST=u,l.MIN_MSG_SORT_ORDER=c,l.MAX_MSG_SORT_ORDER=d,l.toCachedMsgId__UNSAFE_DO_NOT_USE=m,l.toMsgId__UNSAFE_DO_NOT_USE=p,l.toMsgId=_,l.stanzaIdToMsgId=f,l.instamadilloMsgIdToMsgId=g,l.FUTUREPROOF_ALT_INDEX=h,l.FUTUREPROOF_SPAM_ALT_INDEX=y,l.SPAM_ALT_INDEX=C,l.craftMsgId__DEPRECATED=R,l.craftMsgIdV2=L,l.craftUnrenderedMsgId=E,l.craftReactionId=k,l.craftDebugMsgId=I,l.isValidMsgId=D,l.craftToBeReadAltIndex=x,l.craftE2eeAdminMsgAltIndex=$,l.craftCutoverAdminMsgAltIndex=P,l.getInChatMsgIdFromMsgId=N,l.msgIdsInChatLowerBound=M,l.msgIdsInChatUpperBound=w,l.isXMAMsg=A,l.isMediaMsg=F,l.isReceiverFetchStickerMsg=O,l.isPhotoOrVideoMediaMsg=B,l.isDocumentFileMediaMsg=W,l.isContentMsg=q,l.isMsgEligibleForTriggeringEphemeralSyncResponse=U,l.isUnrenderedMsg=V,l.isAdminMsg=H,l.isUnrenderedMsgType=G,l.isRavenActionMsgType=z,l.getOriginalTsFromMsg=j,l.getCanonicalTsFromMsg=K,l.getSortOrderWithFallback=Q,l.getSortOrderFromPrevious=X,l.getMsgContent=Y,l.getWAMsgId=J,l.convertMsgRowId64=Z}),98);
__d("MAWDeleteOldLogsFromDisk",["Deferred","MAWLogIndexedDb","MAWSaveLogToDisk","MAWTransactionMode","WALogger","asyncToGeneratorRuntime","justknobx"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=r("justknobx")._("1400"),m=r("justknobx")._("1401"),p=r("justknobx")._("1402"),_=(u=o("MAWLogIndexedDb")).makeLogMsgrTransactor("logs",(c=o("MAWTransactionMode")).READONLY)(function(e){var t=new(r("Deferred")),n=e(),o=n.count();return o.onsuccess=function(e){var n=e.target.result;t.resolve(n)},o.onerror=function(e){t.reject(e)},t.getPromise()}),f=u.makeLogMsgrTransactor("logs",c.READONLY)(function(e,t){var n=new(r("Deferred")),o=e(),a=[],i=o.index("date"),l=i.openCursor();return l.onsuccess=function(e){var r=e.target.result;if(r==null||!t(r.value,a)){n.resolve(a);return}a.push(r.value.id),r.continue()},l.onerror=function(e){n.reject(e)},n.getPromise()}),g=u.makeLogMsgrTransactor("logs",c.READWRITE)(function(e){var t=new(r("Deferred")),n=e(),a=n.clear();return a.onsuccess=function(){return t.resolve()},a.onerror=function(e){return t.reject(e)},o("MAWSaveLogToDisk").clearLogEntryCache(),t.getPromise()}),h=u.makeLogMsgrTransactor("logs",c.READWRITE)(function(e,t){var n=new(r("Deferred")),o=e();return t.forEach(function(e){return o.delete(e)}),o.transaction.oncomplete=function(){return n.resolve()},o.transaction.onerror=function(e){return n.reject(e)},n.getPromise()});function y(e,t){var n=Date.now()-p;return e!=null&&e.date<=n}function C(e){return function(t,n){return n.length<e}}function b(){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var t=yield _();if(t===0)return;var n=t-m;if(n>0){var r=yield f(C(n));yield h(r);return}var a=yield f(y);a.length>0&&(yield h(a))}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to delete old logs: ",""])),t)}}),v.apply(this,arguments)}function S(){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var e=yield _();if(e===0)return;if(e>=d){yield g();return}}catch(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Failed to delete old logs: ",""])),e)}}),R.apply(this,arguments)}l.clearLogs=g,l.deleteOldLogs=b,l.deleteOldLogsOnStartup=S}),98);
__d("MAWFrontendMediaUtils",["MAWDbMedia"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n,r){if(r===!0)return{mediaType:o("MAWDbMedia").MEDIA_TYPE.GIF,serverMediaType:"gif"};if(e==="image/gif")return{mediaType:o("MAWDbMedia").MEDIA_TYPE.GIF,serverMediaType:"gif"};if(e==="image/webp"&&t!==!0)return{mediaType:o("MAWDbMedia").MEDIA_TYPE.STICKER,serverMediaType:"sticker"};var a=n!=null?n:e.split("/")[0];switch(a){case"image":return t===!0?{mediaType:o("MAWDbMedia").MEDIA_TYPE.IMAGE,serverMediaType:"xma-image"}:{mediaType:o("MAWDbMedia").MEDIA_TYPE.IMAGE,serverMediaType:"image"};case"video":return{mediaType:o("MAWDbMedia").MEDIA_TYPE.VIDEO,serverMediaType:"video"};case"audio":return{mediaType:o("MAWDbMedia").MEDIA_TYPE.PTT,serverMediaType:"ptt"};case"application":default:return{mediaType:o("MAWDbMedia").MEDIA_TYPE.DOCUMENT_FILE,serverMediaType:"document"}}}l.getMediaTypeAndServerMediaTypeFromBlob=e}),98);
__d("WALRUMap",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e){var t=e.max;this.$1=new Map,this.$2=t}var t=e.prototype;return t.has=function(t){return this.$1.has(t)},t.get=function(t){return this.$1.get(t)},t.set=function(t,n){if(this.$1.delete(t),this.$1.set(t,n),this.$1.size>this.$2){var e=this.$1.keys().next().value;e!=null&&this.$1.delete(e)}},t.delete=function(t){this.$1.delete(t)},t.clear=function(){this.$1.clear()},t.size=function(){return this.$1.size},e})();i.LRUMap=e}),66);
__d("WARandomHex",["WACryptoDependencies","WAHex"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=new Uint8Array(e);return o("WACryptoDependencies").getCrypto().getRandomValues(t),o("WAHex").toHex(t)}l.randomHex=e}),98);
__d("MAWJobActionsV2",["MAWTransactionMode","Promise","WALRUMap","WARandomHex","WATimeUtils","emptyFunction","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){return new(e||(e=n("Promise")))(function(e,n){t.onsuccess=e,t.onerror=n})}function u(e){return s(e).then(function(e){return e.target.result})}function c(t,r,a){return new(e||(e=n("Promise")))(function(e,n){var i=t(o("MAWTransactionMode").READONLY).index(r),l=i.openCursor(IDBKeyRange.only(a)),s=[];l.onsuccess=function(t){var n=t.target.result;if(!n){e(s);return}s.push(n.value),n.continue()},l.onerror=function(e){return n(e)}})}var d=new(o("WALRUMap")).LRUMap({max:100});function m(t,r){var a=r.args,i=r.scheduleConfig,l=r.type,s=r.uniqKey,d=r.version,m=d===void 0?1:d,_=JSON.stringify([l,s!=null?s:o("WARandomHex").randomHex(32)]),f={backedOffCount:0,current:a,original:a,scheduleConfig:i,startTime:o("WATimeUtils").unixTime(),step:"$unstarted",stepFirstStartTime:null,stepHardStartCountAfterTimeout:0,stepUnexpectedErrorCount:0,type:l,uniqKey:_,version:m,waitUntil:null},g=function(){var e,n=t().add(f),r=u(n);if(f.uniqKey==null&&typeof((e=n.transaction)==null?void 0:e.commit)=="function")try{n.transaction.commit()}catch(e){}return r.then(function(e){return{id:e,newlyCreated:!0}})};return s!=null?c(t,"uniqKey",_).then(function(r){if(r.length===0)return g();var o=[],a=null;return r.forEach(function(e){e.step!=="$finished"?a=e:o.push(p(t,e.jobId))}),(e||(e=n("Promise"))).all(o).then(function(){return a!=null?{id:a.jobId,newlyCreated:!1}:g()})}):g()}function p(e,t){return u(e().delete(t))}function _(e,t){return u(e().get(t))}function f(e,t){return u(e().put(t))}function g(e){return u(e().getAll())}function h(t){try{return s(t().clear()).then(r("emptyFunction"))}catch(t){var o=r("getErrorSafe")(t);if(o.name==="NotFoundError")return(e||(e=n("Promise"))).resolve();throw o}}l.recentFinishedJobsCache=d,l.maybeCreateJob=m,l.deletePersistedJob=p,l.readPersistedJob=_,l.updatePersistedJob=f,l.readAllPersistedJobs=g,l.clearJobs=h}),98);
__d("MAWKeychainUtil",[],(function(t,n,r,o,a,i){"use strict";function e(e){return self.crypto.getRandomValues(new Uint8Array(e))}function l(e){var t=e.reduce(function(e,t){return e+t.byteLength},0),n=new Uint8Array(t);return e.reduce(function(e,t){return n.set(new Uint8Array(t),e),e+t.byteLength},0),n.buffer}function s(e,t){return new Uint8Array([e,t]).buffer}function u(e){var t=e.length;if(t>0&&t%2===0&&/^[\da-f]+$/gi.test(e)){for(var n=[],r=0,o=t/2;r<o;++r){var a=parseInt(e.substring(r*2,r*2+2),16);n.push(a)}return new Uint8Array(n)}else return null}i.getBufferWithRandomValuesFromLength=e,i.mergeBuffers=l,i.makeAAD=s,i.fromHexString=u}),66);
__d("MAWSubtleCrypto",[],(function(t,n,r,o,a,i){"use strict";var e=self.crypto,l=e&&(e.subtle||e.webkitSubtle||e.subtle);i.MAWSubtleCrypto=l}),66);
__d("MAWWebInitDataHelpers",["FBLogger","MessengerWebInitData"],(function(t,n,r,o,a,i,l){"use strict";function e(){return 2}function s(e){var t;switch(e){case 2:return[r("MessengerWebInitData").accountKeyV2];case 1:return[r("MessengerWebInitData").accountKey].concat((t=r("MessengerWebInitData").additionalAccountKeysV1)!=null?t:[]);default:throw r("FBLogger")("messenger_web").mustfixThrow("Invalid format version, should never happen.")}}l.getLastAccountKeyFormatVersion=e,l.getAccountKeysString=s}),98);
__d("MAWKeychainCrypto",["FBLogger","MAWCryptoConsts","MAWKeychainUtil","MAWSubtleCrypto","MAWWebInitDataHelpers","Promise","WABase64","asyncToGeneratorRuntime","getErrorSafe","memoizeOneWithArgs"],(function(t,n,r,o,a,i,l){"use strict";var e,s=o("MAWKeychainUtil").makeAAD(o("MAWCryptoConsts").VERSION,o("MAWCryptoConsts").CIPHER_ID);function u(e,t,n){var a=o("MAWKeychainUtil").getBufferWithRandomValuesFromLength(o("MAWCryptoConsts").AES_GCM_IV_LENGTH_IN_BYTES),i=n||s;return o("MAWSubtleCrypto").MAWSubtleCrypto.encrypt({additionalData:i,iv:new Uint8Array(a),name:o("MAWCryptoConsts").AES_GCM,tagLength:o("MAWCryptoConsts").AES_GCM_TAG_LENGTH},e,t).then(function(e){var t=o("MAWKeychainUtil").mergeBuffers([i,a,e]);return o("WABase64").encodeB64(t)}).catch(function(t){var n=r("getErrorSafe")(t);throw r("FBLogger")("messenger_web").catching(n).mustfixThrow("Failed to encryptDataToStringBuffer",typeof e,e.constructor.name)})}function c(e,t){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n,r=new Uint8Array(o("WABase64").decodeB64(t)),a=r.subarray(0,(n=o("MAWCryptoConsts")).ADDITIONAL_DATA_LENGTH_IN_BYTES),i=r.subarray(n.ADDITIONAL_DATA_LENGTH_IN_BYTES,n.AES_GCM_IV_LENGTH_IN_BYTES+n.ADDITIONAL_DATA_LENGTH_IN_BYTES),l=r.subarray(n.AES_GCM_IV_LENGTH_IN_BYTES+n.ADDITIONAL_DATA_LENGTH_IN_BYTES),s=yield o("MAWSubtleCrypto").MAWSubtleCrypto.decrypt({additionalData:a,iv:i,name:n.AES_GCM,tagLength:n.AES_GCM_TAG_LENGTH},e,l);return s}),d.apply(this,arguments)}function m(e){var t=o("MAWWebInitDataHelpers").getAccountKeysString(e);return t.map(function(e){var t=o("MAWKeychainUtil").fromHexString(e);if(t==null)throw r("FBLogger")("messenger_web").mustfixThrow("Invalid value for account key. Is empty="+String(e.length===0)+";");return t.buffer})}function p(t){return(e||(e=n("Promise"))).all(m(t).map(function(e){return o("MAWSubtleCrypto").MAWSubtleCrypto.importKey("raw",e,{name:o("MAWCryptoConsts").AES_GCM},!1,["encrypt","decrypt"])}))}function _(){return o("WABase64").encodeB64(o("MAWKeychainUtil").getBufferWithRandomValuesFromLength(o("MAWCryptoConsts").HKDF_SEED_LENGTH_IN_BYTES))}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WABase64").decodeB64(e);try{var n=yield o("MAWSubtleCrypto").MAWSubtleCrypto.importKey("raw",t,{name:o("MAWCryptoConsts").HKDF},!1,["deriveKey"]);return n}catch(e){var a=r("getErrorSafe")(e);throw r("FBLogger")("messenger_web").catching(a).mustfix("Failed to importBrowserEncryptionKey"),a}}),g.apply(this,arguments)}function h(){return o("MAWKeychainUtil").getBufferWithRandomValuesFromLength(o("MAWCryptoConsts").HKDF_SEED_LENGTH_IN_BYTES)}function y(e,t){var n;return o("MAWSubtleCrypto").MAWSubtleCrypto.deriveKey({hash:{name:(n=o("MAWCryptoConsts")).SHA256},info:n.HKDF_INFO,name:n.HKDF,salt:t},e,{length:n.AES_GCM_KEY_LENGTH,name:n.AES_GCM},!0,["encrypt","decrypt"]).then(function(e){return o("MAWSubtleCrypto").MAWSubtleCrypto.exportKey("raw",e)})}function C(e){var t=e.slice(0,o("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES),n=new DataView(t).getUint8(0);if(n===0){var r,a=e.slice((r=o("MAWCryptoConsts")).ADDITIONAL_DATA_LENGTH_IN_BYTES,r.ADDITIONAL_DATA_LENGTH_IN_BYTES*2);return{aadLengthInBytes:r.ADDITIONAL_DATA_LENGTH_IN_BYTES*2+r.EXTRA_ADDITIONAL_DATA_LENGTH_IN_BYTES,keyVersion:new DataView(a).getUint8(0),originRandomisedVersion:new DataView(e).getUint32(r.ADDITIONAL_DATA_LENGTH_IN_BYTES*2,!0)}}return{aadLengthInBytes:o("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES,keyVersion:n}}function b(e){return C(e)}var v=r("memoizeOneWithArgs")(function(e){return p(e)});function S(e){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WABase64").decodeB64(e),n=yield o("MAWSubtleCrypto").MAWSubtleCrypto.digest(o("MAWCryptoConsts").SHA256,t);return o("WABase64").encodeB64(n)}),R.apply(this,arguments)}l.ADDITIONAL_DATA=s,l.encryptDataToStringBuffer=u,l.decryptDataToArrayBuffer=c,l.getAccountKeysBuffers=m,l.genAccountKeys=p,l.genBrowserEncryptionKeyString=_,l.importBrowserEncryptionKey=f,l.genDatabaseEncryptionSeed=h,l.genDatabaseEncryptionKey=y,l.getKeyVersionFromCipherData=C,l.getKeyVersionFromCipherDataString=b,l.getAccountKeys=v,l.generateHashString=S}),98);
__d("MAWKeychainNaClCrypto",["MAWKeychainCrypto","WABase64","tweetnacl"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t){var n;return n=e.call(this,t)||this,n.name="EARError",n.message=t,n}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));function s(e,t,n){var r=new Uint8Array(n),a=o("tweetnacl").randomBytes(o("tweetnacl").secretbox.nonceLength),i=o("tweetnacl").secretbox(t,a,new Uint8Array(e)),l=new Uint8Array(r.length+a.length+i.length);return l.set(r),l.set(a,r.length),l.set(i,r.length+a.length),l.buffer}function u(e,t,n){return o("WABase64").encodeB64(s(e,t,n!=null?n:o("MAWKeychainCrypto").ADDITIONAL_DATA))}function c(t,n,r,a,i){var l=n.slice(0,i),s=n.slice(i,i+o("tweetnacl").secretbox.nonceLength),u=n.slice(i+o("tweetnacl").secretbox.nonceLength),c=o("tweetnacl").secretbox.open(new Uint8Array(u),new Uint8Array(s),new Uint8Array(t));if(c==null)throw new e("decryptTweetNaCl was unable to decrypt an entity. Attempting to use key version : "+(r!=null?r:"non-provided")+". Format version "+(a!=null?a:"unknown")+".");return c}function d(e,t,n,r){return c(e,o("WABase64").decodeB64(t),n,void 0,r)}function m(e,t,n){return u(e,t,n)}function p(e,t,n,r){return d(e,t,n,r)}function _(e,t,n,r,o){return c(e,t,n,r,o)}l.EARDecryptionError=e,l.encryptTweetNaClArrayBuffer=s,l.encryptTweetNaCl=u,l.decryptTweetNaClArrayBuffer=c,l.decryptTweetNaCl=d,l.encrypt=m,l.decrypt=p,l.decryptArrayBuffer=_}),98);
__d("MAWMessagesDirection",["I64","err"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e){return r("err")("Unhandled direction: "+e)}function u(e,t){return _(e,{asc:t.maxTimestampMs,desc:t.minTimestampMs})}function c(e,t){return _(e,{asc:t.maxMessageId,desc:t.minMessageId})}function d(t,n){return n==="desc"&&(e||(e=o("I64"))).equal(t.maxTimestampMs,(e||(e=o("I64"))).max_int)&&t.minMessageId===t.maxMessageId&&t.hasMoreBefore&&!t.hasMoreAfter}function m(e){return _(e,{asc:"after",desc:"before"})}function p(e){return f(e,{after:"asc",before:"desc"})}function _(e,t){var n=t.asc,r=t.desc;switch(e){case"asc":return n;case"desc":return r;default:throw s(e)}}function f(e,t){var n=t.after,r=t.before;switch(e){case"after":return n;case"before":return r;default:throw s(e)}}l.unhandledDirectionError=s,l.getI64RangeTimestampForDirection=u,l.getRangeMsgIdForDirection=c,l.isFirstPageRange=d,l.translateMwpDirectionToMawDirection=m,l.translateMawDirectionToMwpDirection=p,l.switchOnMWPMessagesDirection=_,l.switchOnMAWMessagesDirection=f}),98);
__d("MAWMessagesCompare",["MAWMessagesDirection"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return function(t,n){if(n.sortOrderMs==null||t.sortOrderMs==null)return 0;if(t.sortOrderMs===n.sortOrderMs){var r,o,a,i,l=(r=t.externalId)!=null?r:"",s=(o=n.externalId)!=null?o:"";if(e!=null){var u=e.has(l),c=e.has(s);if(u&&!c)return-1;if(!u&&c)return 1}return((a=n.externalId)!=null?a:"").localeCompare((i=t.externalId)!=null?i:"")}return n.sortOrderMs-t.sortOrderMs}}var s=e(),u=function(n,r){return-1*e()(n,r)};function c(e){return o("MAWMessagesDirection").switchOnMWPMessagesDirection(e,{asc:u,desc:s})}l.makeCompareMessageMetadataForDescOrderFn=e,l.getSortComparisonFunctionForDirection=c}),98);
__d("MAWMiActGetMappingWithMawTypes",["I64","MAWJids","WAJids"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n){var r=(e||(e=o("I64"))).to_string(t.jid),a=n?o("WAJids").toGroupJid(r):o("MAWJids").toUserJid(r);return{clientThreadPk:t.clientThreadPk,jid:a,serverThreadKey:t.serverThreadKey}}l.default=s}),98);
__d("MAWMiActThreadLifecycleState__DO_NOT_USE",[],(function(t,n,r,o,a,i){"use strict";var e={AUTHORITATIVE_THREAD_MISSING_MAPPING_ROW:"AUTHORITATIVE_THREAD_MISSING_MAPPING_ROW",AUTHORITATIVE_THREAD_ONLY:"AUTHORITATIVE_THREAD_ONLY",CLIENT_PARTIAL_MI_THREAD:"CLIENT_PARTIAL_MI_THREAD",CLIENT_PARTIAL_MI_THREAD_WITH_ACT:"CLIENT_PARTIAL_MI_THREAD_WITH_ACT",JID_MISSING_MAPPING_ROW:"JID_MISSING_MAPPING_ROW",JID_MISSING_MI_THREAD:"JID_MISSING_MI_THREAD",MI_AND_ACT_THREAD_COMPLETE:"MI_AND_ACT_THREAD_COMPLETE",OPTIMISTIC_THREAD_NO_ACT:"OPTIMISTIC_THREAD_NO_ACT",OPTIMISTIC_THREAD_WITH_ACT:"OPTIMISTIC_THREAD_WITH_ACT",SERVER_PARTIAL_MI_THREAD:"SERVER_PARTIAL_MI_THREAD",THREAD_KEY_ONLY:"THREAD_KEY_ONLY"};i.MiActThreadStatesEnum=e}),66);
__d("MWLogSendToSentFailedError",["FBLogger","QuickPerformanceLogger"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n,o,a,i){var l,s,u,c,d,m,p,_,f=t.qplEventType,g=t.qplInstanceKey,h=(e||(e=r("QuickPerformanceLogger"))).getMarker(f,g),y=h==null||(l=h.annotations)==null||(l=l.bool)==null?void 0:l.is_secure;r("FBLogger")("messenger_web_messaging","send_to_sent_failed").blameToPreviousFrame().blameToPreviousFrame().warn("send_to_sent failed with reason: %s. Caught error message: %s. Additional description: %s. Secure? %s. Error Code: %s. Application Error: %s.",n,(s=o==null?void 0:o.message)!=null?s:"",(u=(c=h==null||(d=h.annotations)==null||(d=d.string)==null?void 0:d.error_description)!=null?c:h==null||(m=h.annotations)==null||(m=m.string)==null?void 0:m.errorType)!=null?u:"",y===!0?"secure":y===!1?"open":"unknown",(p=a==null?void 0:a.toString())!=null?p:"",(_=i==null?void 0:i.toString())!=null?_:"")}l.default=s}),98);
__d("MWMsgMediaTypeLogUtils",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum")({Application:"application",Audio:"audio",Avatar:"avatar",HotEmoji:"hot_emoji",File:"file",Gif:"gif",Image:"image",Link:"link",None:"none",Poll:"poll",Reaction:"reaction",Sticker:"sticker",Video:"video",Share:"share",NoteReply:"note_reply"});function l(t){var n=t.hasFile,r=n===void 0?!1:n,o=t.hasGif,a=o===void 0?!1:o,i=t.hasHotEmoji,l=i===void 0?!1:i,s=t.hasImage,u=s===void 0?!1:s,c=t.hasLinks,d=c===void 0?!1:c,m=t.hasNoteReply,p=m===void 0?!1:m,_=t.hasShare,f=_===void 0?!1:_,g=t.hasSticker,h=g===void 0?!1:g,y=t.hasVideo,C=y===void 0?!1:y,b=t.hasVoiceClip,v=b===void 0?!1:b,S=e.None;return u?S=e.Image:C?S=e.Video:l?S=e.HotEmoji:h?S=e.Sticker:a?S=e.Gif:v?S=e.Audio:r?S=e.File:f?S=e.Share:d?S=e.Link:p&&(S=e.NoteReply),S}i.AttachmentType=e,i.getAttachmentType=l}),66);
__d("MWGetOriginalEntrypoint",["I64","InteractionTracingMetrics","MWChatInteraction"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var n,a,i,l,s=o("MWChatInteraction").get((e||(e=o("I64"))).to_string(t)),u=s!=null?r("InteractionTracingMetrics").get(s):null,c=(n=u==null||(a=u.annotations.string)==null?void 0:a.inboxEntrypoint)!=null?n:u==null||(i=u.annotations.string)==null?void 0:i.entrypoint;if(c!=null&&c!=="unknown")return c;var d=o("MWChatInteraction").get("inbox_init");if(d!=null&&(e||(e=o("I64"))).equal(t,(e||(e=o("I64"))).of_string(d)))return"initInbox";var m=o("MWChatInteraction").get(o("MWChatInteraction").MW_AUTO_CHAT_TAB_OPEN),p=m!=null?(l=r("InteractionTracingMetrics").get(m))==null||(l=l.annotations.string)==null?void 0:l.thread_id:null;return p===(e||(e=o("I64"))).to_string(t)?"auto_open":"unknown"}l.default=s}),98);
__d("MWMsgActionLogUtils",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum")({Send:"send",Reaction:"reaction",Reply:"reply",Forward:"forward",Share:"share",StoryReply:"story-reply",Unsend:"unsend",GroupInvite:"group-invite",SenderKeyDistribution:"sender-key-distribution",EphemeralSetting:"ephemeral-setting",Edit:"edit",Bump:"bump",Retry:"retry"});function l(t){var n=t.hasEphemeralSetting,r=n===void 0?!1:n,o=t.hasGroupInvite,a=o===void 0?!1:o,i=t.hasReaction,l=i===void 0?!1:i,s=t.hasReply,u=s===void 0?!1:s,c=t.hasSenderKeyDistribution,d=c===void 0?!1:c,m=t.hasStoryReply,p=m===void 0?!1:m,_=t.isBump,f=_===void 0?!1:_,g=t.isEdit,h=g===void 0?!1:g,y=t.isForward,C=y===void 0?!1:y,b=t.isRetry,v=b===void 0?!1:b,S=t.isUnsend,R=S===void 0?!1:S,L=e.Send;return u?L=e.Reply:p?L=e.StoryReply:R?L=e.Unsend:l?L=e.Reaction:a?L=e.GroupInvite:r?L=e.EphemeralSetting:d?L=e.SenderKeyDistribution:h?L=e.Edit:C?L=e.Forward:f?L=e.Bump:v&&(L=e.Retry),L}i.ActionType=e,i.getActionType=l}),66);
__d("MWHasLinksUtil",["URLMatcher","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return r("isStringNullOrEmpty")(e)?!1:r("URLMatcher").match(e)!=null}l.getHasLinks=e}),98);
__d("MWPreloadableQueries",["I64","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(t,n){return o("ReQL").fromTableAscending(t.tables.thread_nullstate).getKeyRange(n)},u=function(t,n){return o("ReQL").fromTableAscending(t.tables.thread_nullstate_ctas.index("threadKeyCtaId")).getKeyRange(n)},c=function(t,n){return o("ReQL").fromTableAscending(t.tables.cutover_threads).getKeyRange(n)},d=function(t,n){return o("ReQL").fromTableAscending(t.tables.community_folders).getKeyRange(n)},m=function(t,n){return o("ReQL").fromTableAscending(t.tables.thread_proactive_warning_settings).getKeyRange(n)},p=function(t,n){return o("ReQL").fromTableAscending(t.tables.in_thread_banner).getKeyRange(n)};function _(t,n){return o("ReQL").fromTableAscending(t.tables.media_staging).filter(function(t){return!t.isSent&&(e||(e=o("I64"))).equal(t.threadKey,n)})}l.threadNullStateQuery=s,l.threadNullStateCtaQuery=u,l.getCutoverThreadByThreadKey=c,l.getCommunityFolderQuery=d,l.getProactiveWarningsForThreadQuery=m,l.getThreadBannerQuery=p,l.getMediaStagingQuery=_}),98);
__d("MWVersion",["I64"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("I64"))).of_string("2");l.v2=s}),98);
__d("MWSharedS2SBaseAnnotations",["$InternalEnum","I64","LSMessagingThreadAttributionType","LSMessagingThreadTypeUtil","MWHasLinksUtil","MWMsgActionLogUtils","MWMsgMediaTypeLogUtils","MWPreloadableQueries","MWVersion","MultipleTabsLogger","ReQL","asyncToGeneratorRuntime","gkx","isStringNullOrEmpty","shouldUseMAWSharedWorker"],(function(t,n,r,o,a,i,l){"use strict";var e=["hasAttachment","hasEphemeralSetting","hasGroupInvite","hasReaction","hasReply","hasSenderKeyDistribution","hasStoryReply","hasText","isBump","isEdit","isForward","isRetry","isUnsend"],s=["db","threadKey"],u,c=n("$InternalEnum")({Text:"text",NonText:"non-text"});function d(e,t,n,r,o){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a,i,l){var s=t.hasAttachment,d=s===void 0?!1:s,m=t.hasEphemeralSetting,_=t.hasGroupInvite,f=t.hasReaction,g=t.hasReply,h=t.hasSenderKeyDistribution,y=t.hasStoryReply,C=t.hasText,b=C===void 0?!1:C,v=t.isBump,S=t.isEdit,R=t.isForward,L=t.isRetry,E=t.isUnsend,k=babelHelpers.objectWithoutPropertiesLoose(t,e);l===void 0&&(l=!1);var I=o("MWMsgActionLogUtils").getActionType({hasEphemeralSetting:m,hasGroupInvite:_,hasReaction:f,hasReply:g,hasSenderKeyDistribution:h,hasStoryReply:y,isBump:v,isEdit:S,isForward:R,isRetry:L,isUnsend:E}),T=o("MWMsgMediaTypeLogUtils").getAttachmentType(k),D=b&&(!T||T===o("MWMsgMediaTypeLogUtils").AttachmentType.None)?c.Text:c.NonText,x=i!=null?parseInt(i,10):void 0;return isNaN(x)&&(x=void 0),{bool:{has_attachment:d,has_sticker:k.hasSticker,has_text:b,is_attachments_grouped:k.isAttachmentsGrouped,is_pdb:!!r("gkx")("8483"),is_pwa:l,is_tlc_public_user:r("gkx")("24028"),use_maw_shared_worker:o("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()},int:{number_of_attachments:k.numberOfAttachments,number_of_grouped_attachments:k.numberOfGroupedAttachments,offline_threading_id:x},string:{action_type:I,attachment_type:T,entrypoint:p(n),message_type:D,multipleTabs:yield o("MultipleTabsLogger").getMultipleTabsAnnotation(),mw_version:(u||(u=o("I64"))).to_string(o("MWVersion").v2),offline_threading_id:i,root_component:a}}}),m.apply(this,arguments)}function p(e){var t;return(t=Object.keys(r("LSMessagingThreadAttributionType")).find(function(t){return r("LSMessagingThreadAttributionType")[t]===e}))!=null?t:"UNKNOWN"}function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.db,n=e.threadKey,r=babelHelpers.objectWithoutPropertiesLoose(e,s),a=t!=null&&n!=null?yield o("ReQL").toArrayAsync(o("MWPreloadableQueries").getMediaStagingQuery(t,n)):[];return{mediaStagings:a,messageTypeParams:g(babelHelpers.extends({},r,{mediaStagings:a}))}}),f.apply(this,arguments)}function g(e){var t=e.externalAttachmentUrl,n=e.hotEmojiSize,a=e.isBump,i=e.isEdit,l=e.isEphemeralSetting,s=e.isForward,u=e.isGroupInvite,c=e.isReaction,d=e.isRetry,m=e.isSenderKeyDistribution,p=e.isUnsend,_=e.mediaGroupInfo,f=e.mediaStagings,g=e.messageText,h=e.reply,y=e.sentFromShareSheet,C=e.sticker,b=e.threadType,v=e.voiceClip,S=!r("isStringNullOrEmpty")(g),R=o("MWHasLinksUtil").getHasLinks(g),L=!1,E=v!=null;(E||t!=null)&&(L=!0);var k=!1,I=!1,T=!1,D=0,x=0,$;if(f!=null&&f.length>0){L=!0;for(var P of f){var N=P.mimeType;N.indexOf("image")!==-1&&(k=!0),N.indexOf("video")!==-1&&(I=!0),N.indexOf("application")!==-1&&(T=!0)}if(k&&b!=null){var M=o("LSMessagingThreadTypeUtil").isArmadilloSecure(b);$=!M}D=f.length}_!=null&&($=!0,x=_.messagesAndAttachments.length);var w=n!=null,A=h!=null,F=h!=null,O=C!=null&&!w,B=!O&&t!=null,W=y===!0,q=c===!0,U=u===!0,V=l===!0,H=m===!0;return{hasAttachment:L,hasEphemeralSetting:V,hasFile:T,hasGif:B,hasGroupInvite:U,hasHotEmoji:w,hasImage:k,hasLinks:R,hasReaction:q,hasReply:A,hasSenderKeyDistribution:H,hasShare:W,hasSticker:O,hasStoryReply:F,hasText:S,hasVideo:I,hasVoiceClip:E,isAttachmentsGrouped:$,isBump:a!=null?a:!1,isEdit:i!=null?i:!1,isForward:s!=null?s:!1,isRetry:d!=null?d:!1,isUnsend:p!=null?p:!1,numberOfAttachments:D,numberOfGroupedAttachments:x}}l.MsgType=c,l.getSendToSentBaseAnnotations=d,l.getEntrypointAnnotation=p,l.queryMediaStagingAndGetMessageTypeParams=_,l.getMessageTypeParams=g}),98);
__d("MWSharedMsgLogUtils",["$InternalEnum","I64","IGDInteractionTraceAnnotations","LSIntEnum","LSMessagingThreadTypeUtil","MAWEBSwitch","MWGetOriginalEntrypoint","MWMsgActionLogUtils","MWMsgMediaTypeLogUtils","MWSharedS2SBaseAnnotations","MultipleTabsLogger","asyncToGeneratorRuntime","cr:6985","gkx","isArmadillo","promiseDone","shouldUseMAWSharedWorker"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=n("$InternalEnum")({Text:"text",NonText:"non-text"});function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=t.attachmentTypeParams,i=t.composerEntrypoint,l=t.isPwa,s=t.messageOfflineThreadingId,u=t.source,c=t.thread,d=n("cr:6985")!=null?yield n("cr:6985").isCutoverThreadKey(c.threadKey):!1,m=yield o("MWSharedS2SBaseAnnotations").getSendToSentBaseAnnotations(a,u,i,s,l);return{bool:babelHelpers.extends({},m.bool,o("IGDInteractionTraceAnnotations").getInstamadilloBooleanAnnotations(c),{is_community_event:c.eventStartTimestampMs!=null,is_cutover:r("isArmadillo")()&&d,is_message_request:o("LSMessagingThreadTypeUtil").isMessageRequest(c),is_secure:o("LSMessagingThreadTypeUtil").isArmadilloSecure(c.threadType)}),int:babelHelpers.extends({},m.int),string:babelHelpers.extends({},m.string,{consistent_thread_fbid:c.consistentThreadFbid!=null?(e||(e=o("I64"))).to_string(c.consistentThreadFbid):null,original_entrypoint:r("MWGetOriginalEntrypoint")(c.threadKey),thread_id:(e||(e=o("I64"))).to_string(c.threadKey),thread_subtype:c.threadSubtype!=null?(e||(e=o("I64"))).to_string(c.threadSubtype):null,thread_type:e.to_string(c.threadType)})}}),d.apply(this,arguments)}function m(e,t,n,a){p(e,t,r("MWGetOriginalEntrypoint")(n.threadKey),n.threadKey,n.consistentThreadFbid,n.threadType,n.threadSubtype,a),o("IGDInteractionTraceAnnotations").addInstamadilloAnnotationsToInteractionTrace(n,e)}function p(t,a,i,l,s,c,d,m){var p=a.hasEphemeralSetting,_=p===void 0?!1:p,f=a.hasFile,g=f===void 0?!1:f,h=a.hasGif,y=h===void 0?!1:h,C=a.hasGroupInvite,b=C===void 0?!1:C,v=a.hasHotEmoji,S=v===void 0?!1:v,R=a.hasImage,L=R===void 0?!1:R,E=a.hasLinks,k=E===void 0?!1:E,I=a.hasReaction,T=I===void 0?!1:I,D=a.hasReply,x=D===void 0?!1:D,$=a.hasSenderKeyDistribution,P=$===void 0?!1:$,N=a.hasShare,M=N===void 0?!1:N,w=a.hasSticker,A=w===void 0?!1:w,F=a.hasStoryReply,O=F===void 0?!1:F,B=a.hasText,W=B===void 0?!1:B,q=a.hasVideo,U=q===void 0?!1:q,V=a.hasVoiceClip,H=V===void 0?!1:V,G=a.isAttachmentsGrouped,z=a.isBump,j=z===void 0?!1:z,K=a.isEdit,Q=K===void 0?!1:K,X=a.isForward,Y=X===void 0?!1:X,J=a.isRetry,Z=J===void 0?!1:J,ee=a.isUnsend,te=ee===void 0?!1:ee,ne=a.numberOfAttachments,re=ne===void 0?0:ne,oe=a.numberOfGroupedAttachments,ae=oe===void 0?0:oe,ie=o("MWMsgActionLogUtils").getActionType({hasEphemeralSetting:_,hasGroupInvite:b,hasReaction:T,hasReply:x,hasSenderKeyDistribution:P,hasStoryReply:O,isBump:j,isEdit:Q,isForward:Y,isRetry:Z,isUnsend:te}),le=o("MWMsgMediaTypeLogUtils").getAttachmentType({hasFile:g,hasGif:y,hasHotEmoji:S,hasImage:L,hasLinks:k,hasShare:M,hasSticker:A,hasVideo:U,hasVoiceClip:H,numberOfAttachments:re,numberOfGroupedAttachments:ae}),se=W&&(!le||le===o("MWMsgMediaTypeLogUtils").AttachmentType.None)?u.Text:u.NonText;o("MultipleTabsLogger").addAnnotationWithInteractionUuid(t.getTraceId()),t.addAnnotation("attachment_type",le),t.addAnnotation("action_type",ie),t.addAnnotation("message_type",se),t.addAnnotation("original_entrypoint",i),m!=null&&t.addAnnotation("root_component",m),t.addAnnotationInt("number_of_attachments",re),G!=null&&t.addAnnotationBoolean("is_attachments_grouped",G),t.addAnnotation("thread_id",(e||(e=o("I64"))).to_string(l)),s!=null&&t.addAnnotation("consistent_thread_fbid",(e||(e=o("I64"))).to_string(s)),t.addAnnotation("thread_type",e.to_string(c)),d!=null&&t.addAnnotation("thread_subtype",(e||(e=o("I64"))).to_string(d)),n("cr:6985")!=null&&r("promiseDone")(n("cr:6985").isCutoverThreadKey(l),function(e){t.addAnnotationBoolean("is_cutover",e)}),t.addAnnotationBoolean("is_secure",o("LSMessagingThreadTypeUtil").isArmadilloSecure(c)),t.addAnnotationBoolean("is_eb_enabled",r("MAWEBSwitch").isEnabled()),t.addAnnotationBoolean("use_maw_shared_worker",o("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()),t.addAnnotationBoolean("is_pdb",!!r("gkx")("8483"))}function _(t){return(e||(e=o("I64"))).equal(t,(s||(s=o("LSIntEnum"))).ofNumber(2))?"media":(e||(e=o("I64"))).equal(t,(s||(s=o("LSIntEnum"))).ofNumber(4))?"audio":(e||(e=o("I64"))).equal(t,(s||(s=o("LSIntEnum"))).ofNumber(4096))||(e||(e=o("I64"))).equal(t,(s||(s=o("LSIntEnum"))).ofNumber(134217728))?"sticker":(e||(e=o("I64"))).equal(t,(s||(s=o("LSIntEnum"))).ofNumber(16384))?"gif":(e||(e=o("I64"))).equal(t,(s||(s=o("LSIntEnum"))).ofNumber(64))?"file":(e||(e=o("I64"))).equal(t,(s||(s=o("LSIntEnum"))).ofNumber(1))?"text":(e||(e=o("I64"))).equal(t,(s||(s=o("LSIntEnum"))).ofNumber(1024))||(e||(e=o("I64"))).equal(t,(s||(s=o("LSIntEnum"))).ofNumber(536870912))?"XMA":"unknown"}l.MsgType=u,l.getSendToSentAnnotations=c,l.addSendMessageMetadataForInteractionTrace=m,l.addSendMessageMetadataForInteractionTraceWithThreadMetadata=p,l.getMessageTypeFromDisplayedContentType=_}),98);
__d("mergeDeep",["mergeDeepInto","mergeHelpers"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){var o,a=(o=r("mergeHelpers")).normalizeMergeArg(e),i=o.normalizeMergeArg(t);o.checkMergeObjectArgs(a,i),o.checkArrayStrategy(n);var l={};return r("mergeDeepInto")(l,a,n),r("mergeDeepInto")(l,i,n),l}l.default=e}),98);
__d("sendToSentQPLLogger",["LSDatabaseSingleton","LSIntEnum","MAWMIC","MAWSetupWorkerAuxStateForLogging","MAWWaitForBackendSetup","MWLogSendToSentFailedError","MWMsgMediaTypeLogUtils","MWSharedMsgLogUtils","MWSharedS2SBaseAnnotations","Network","QPLEvent","QPLUserFlow","QuickPerformanceLogger","Random","ReQL","WAExceededStorageQuota","WAGetStorageQplAnnotations","asyncToGeneratorRuntime","getSafeQplErrorMessage","gkx","interaction-tracing","justknobx","mergeDeep","pageID","performance","promiseDone","qpl","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m=r("requireDeferred")("MAWWebWorkerSingleton").__setRef("sendToSentQPLLogger"),p=r("qpl")._(25313175,"1551"),_=new Map;function f(e,t){r("QPLUserFlow").addAnnotations(p,t,{instanceKey:e})}function g(e,t){r("QPLUserFlow").endCancel(p,{annotations:t!=null?t:{},instanceKey:e}),S(e)}function h(e,t,n,a){var i=a!=null?a.type:t;r("MWLogSendToSentFailedError")({qplEventType:p,qplInstanceKey:e},i,n,a==null?void 0:a.errorCode,a==null?void 0:a.applicationErrorCode),r("QPLUserFlow").endFailure(p,i,{annotations:{bool:{exceededStorageQuota:o("WAExceededStorageQuota").getExceededStorageQuota(),useSentBytesCache:r("gkx")("33008"),wasBackendSetupReset:o("MAWWaitForBackendSetup").wasBackendSetupReset(),workerTerminatedPermanently:o("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.workerTerminatedPermanently},string:{errorDescription:o("getSafeQplErrorMessage").getSafeQPLErrorMessage(n)},string_array:{worker_restart_msgs:o("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartMessageTypes,worker_restart_reasons:o("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartReasons}},error:n,instanceKey:e}),S(e)}function y(e,t,n,o){e!=null&&r("QPLUserFlow").addPoint(p,t,{data:o,debugInfo:n,instanceKey:e})}function C(e){(c||(c=r("QuickPerformanceLogger"))).markerEnd(p,160,e),S(e)}function b(e,t){y(e,t?"network_connection_online":"network_connection_offline"),t||C(e)}function v(e){var t=r("interaction-tracing").NetworkStatusTracker.onChange(function(t){var n=t.online;b(e,n)});if(_.set(e,t),b(e,r("interaction-tracing").NetworkStatusTracker.isOnline()),r("Network").containsNetworkInformation()){var n=r("Network").getRTT();n!=null&&f(e,{int:{network_rtt:n}});var o=r("Network").getEffectiveType();o!=null&&f(e,{string:{network_effective_type:String(o)}});var a=r("Network").getBandwidth();a!=null&&f(e,{int:{network_bandwidth:a}});var i=r("Network").getType();i!=null&&f(e,{string:{network_connectivity_type:String(i)}})}}function S(e){var t;(t=_.get(e))==null||t.remove(),_.delete(e)}function R(e){window.navigator&&window.navigator.hardwareConcurrency&&f(e,{int:{hardware_concurrency:window.navigator.hardwareConcurrency}})}function L(t,n){t===void 0&&(t=!0);var a=Date.now()+(Math.round(o("Random").random()*1e4)+1e4);return r("QPLUserFlow").start(E(n),{annotations:{bool:{backendSetupReady:o("MAWWaitForBackendSetup").isBackendSetupSuccessful(),wasBackendSetupReset:o("MAWWaitForBackendSetup").wasBackendSetupReset(),workerTerminatedPermanently:o("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.workerTerminatedPermanently},int:{timeMsSinceSessionStart:(d||(d=r("performance"))).now()},string:{hostname:window.location.hostname,pageID:r("pageID"),workerHeartbeatsOnStart:o("MAWSetupWorkerAuxStateForLogging").getHeartbeatHistoryAsString(),workerID:o("MAWWaitForBackendSetup").getCurrentWorkerID()},string_array:{worker_restart_msgs:o("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartMessageTypes,worker_restart_reasons:o("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartReasons}},instanceKey:a}),r("promiseDone")(o("MAWMIC").getState().then(function(e){f(a,{string:{mic_state:e}})})),t&&r("promiseDone")(o("WAGetStorageQplAnnotations").getStorageQplAnnotations().then(function(e){f(a,e)})),r("promiseDone")((e||(e=o("LSDatabaseSingleton"))).LSDatabaseSingleton.then(function(e){return o("ReQL").firstAsync(o("ReQL").fromTableDescending(e.tables.connectivity_status)).then(function(e){e&&f(a,{int:{connection_state_ls_transport:(s||(s=o("LSIntEnum"))).toNumber(e.internetConnectionState)}})})})),r("promiseDone")(m.load().then(function(e){return e.getWorkerHealthStatus().then(function(e){f(a,{string:{workerHealthStatusOnStart:e.tag}})})})),v(a),R(a),a}function E(e){if((u||(u=o("QPLEvent"))).getSamplingMethod(p)!==1||!k(e))return p;var t=(u||(u=o("QPLEvent"))).getSampleRate(p),n=r("justknobx")._("3946"),a=Math.max(1,Math.min(n,t));return{i:u.getMarkerId(p),m:u.getSamplingMethod(p),r:a}}function k(e){return e===o("MWMsgMediaTypeLogUtils").AttachmentType.Application||e===o("MWMsgMediaTypeLogUtils").AttachmentType.Audio||e===o("MWMsgMediaTypeLogUtils").AttachmentType.File||e===o("MWMsgMediaTypeLogUtils").AttachmentType.Gif||e===o("MWMsgMediaTypeLogUtils").AttachmentType.Image||e===o("MWMsgMediaTypeLogUtils").AttachmentType.Link||e===o("MWMsgMediaTypeLogUtils").AttachmentType.Sticker||e===o("MWMsgMediaTypeLogUtils").AttachmentType.Video||e===o("MWMsgMediaTypeLogUtils").AttachmentType.Share}function I(e){r("QPLUserFlow").endSuccess(p,{annotations:{bool:{exceededStorageQuota:o("WAExceededStorageQuota").getExceededStorageQuota()}},instanceKey:e}),S(e)}function T(e,t,n,a,i,l){i===void 0&&(i=!0);var s=L(i);if(e==null)return s;var u=o("MWSharedS2SBaseAnnotations").getMessageTypeParams(babelHelpers.extends({},t,{threadType:e.threadType}));return r("promiseDone")(o("MWSharedMsgLogUtils").getSendToSentAnnotations({attachmentTypeParams:u,messageOfflineThreadingId:l,source:n,thread:e}),function(e){var t=r("mergeDeep")(e,a);f(s,t)}),s}var D=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var o=e+"_start",a=e+"_end";r("QPLUserFlow").addPoint(p,o,{instanceKey:t});var i=yield n();return r("QPLUserFlow").addPoint(p,a,{instanceKey:t}),i});return function(n,r,o){return e.apply(this,arguments)}})();l.addSendToSentAnnotations=f,l.markSendToSentCancel=g,l.markSendToSentFail=h,l.markSendToSentPoint=y,l.markSendToSentStart=L,l.markSendToSentSuccess=I,l.markSendToSentStartWithAnnotation=T,l.measureSendToSentPerformance=D}),98);
__d("MAWMiActGetThreadLifecycleState__DO_NOT_USE",["FBLogger","I64","LSAuthorityLevel","LSIntEnum","LSMessagingThreadTypeUtil","MAWMiActGetMappingWithMawTypes","MAWMiActMappingTableAPI","MAWMiActThreadLifecycleState__DO_NOT_USE","MAWThreadLoadingState","Promise","ReQL","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(e,t,n){var a=(s||(s=o("LSIntEnum"))).toNumber(e.authorityLevel);if(a===r("LSAuthorityLevel").OPTIMISTIC)return t!=null?babelHelpers.extends({},r("MAWMiActGetMappingWithMawTypes")(t,o("LSMessagingThreadTypeUtil").isGroup(e.threadType)),{type:o("MAWMiActThreadLifecycleState__DO_NOT_USE").MiActThreadStatesEnum.OPTIMISTIC_THREAD_WITH_ACT}):{serverThreadKey:e.threadKey,thread:e,type:o("MAWMiActThreadLifecycleState__DO_NOT_USE").MiActThreadStatesEnum.OPTIMISTIC_THREAD_NO_ACT};if(a===r("LSAuthorityLevel").CLIENT_PARTIAL)return t!=null?babelHelpers.extends({},r("MAWMiActGetMappingWithMawTypes")(t,o("LSMessagingThreadTypeUtil").isGroup(e.threadType)),{type:o("MAWMiActThreadLifecycleState__DO_NOT_USE").MiActThreadStatesEnum.CLIENT_PARTIAL_MI_THREAD_WITH_ACT}):{serverThreadKey:e.threadKey,type:o("MAWMiActThreadLifecycleState__DO_NOT_USE").MiActThreadStatesEnum.CLIENT_PARTIAL_MI_THREAD};if(a===r("LSAuthorityLevel").SERVER_PARTIAL)return{serverThreadKey:e.threadKey,type:o("MAWMiActThreadLifecycleState__DO_NOT_USE").MiActThreadStatesEnum.SERVER_PARTIAL_MI_THREAD};if(a===r("LSAuthorityLevel").AUTHORITATIVE){if(t==null)return{serverThreadKey:e.threadKey,thread:e,type:o("MAWMiActThreadLifecycleState__DO_NOT_USE").MiActThreadStatesEnum.AUTHORITATIVE_THREAD_MISSING_MAPPING_ROW};var i=o("MAWThreadLoadingState").getActState(t)===o("MAWThreadLoadingState").ActState.IN_PROGRESS;if(i){var l=r("MAWMiActGetMappingWithMawTypes")(t,o("LSMessagingThreadTypeUtil").isGroup(e.threadType));return{jid:l.jid,jidInt64:t.jid,serverThreadKey:l.serverThreadKey,thread:e,type:o("MAWMiActThreadLifecycleState__DO_NOT_USE").MiActThreadStatesEnum.AUTHORITATIVE_THREAD_ONLY}}else return babelHelpers.extends({},r("MAWMiActGetMappingWithMawTypes")(t,o("LSMessagingThreadTypeUtil").isGroup(e.threadType)),{type:o("MAWMiActThreadLifecycleState__DO_NOT_USE").MiActThreadStatesEnum.MI_AND_ACT_THREAD_COMPLETE})}throw r("FBLogger")("messenger_web").mustfixThrow("[MiActMapping] Unknown thread lifecycle state for threadKey: %s, authorityLevel: %s, thread action: %s",(u||(u=o("I64"))).to_string(e.threadKey),a,n)}function d(e,t,n){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield o("MAWMiActMappingTableAPI").getMappingRowForIntJid(e,t);if(r==null)return{jidInt64:t,type:o("MAWMiActThreadLifecycleState__DO_NOT_USE").MiActThreadStatesEnum.JID_MISSING_MAPPING_ROW};var a=yield o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.threads).getKeyRange(r.serverThreadKey));return a==null?{jidInt64:t,type:o("MAWMiActThreadLifecycleState__DO_NOT_USE").MiActThreadStatesEnum.JID_MISSING_MI_THREAD}:c(a,r,n)}),m.apply(this,arguments)}function p(e,t,n){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r,a){var i=yield(e||(e=n("Promise"))).all([o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.threads).getKeyRange(r)),o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.mi_act_mapping_table).getKeyRange(r))]),l=i[0],s=i[1];return l==null?{serverThreadKey:r,type:o("MAWMiActThreadLifecycleState__DO_NOT_USE").MiActThreadStatesEnum.THREAD_KEY_ONLY}:c(l,s,a)}),_.apply(this,arguments)}function f(e,t,n,r){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=yield d(e,t,r);return a.type===o("MAWMiActThreadLifecycleState__DO_NOT_USE").MiActThreadStatesEnum.JID_MISSING_MAPPING_ROW&&n!=null?p(e,(u||(u=o("I64"))).of_string(n),"MAWBridgeOccamadilloVerifyThreadExistsHandler"):a}),g.apply(this,arguments)}l.getThreadLifecycleStateByJid=d,l.getThreadLifecycleStateByThreadKey=p,l.getThreadLifecycleStateByJidOrThreadKey=f}),98);
__d("MAWUnrecoverableDbErrors",["FBLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),u=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="indexed_db_access_error",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(s),c=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ear_init_error",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(s),d=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ear_runtime_error",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(s),m=(function(e){function t(t,n,r,o){var a;return a=e.call(this,t)||this,a.name="ebsm_hydration_error",a.fullDeletion=n,a.qplInstanceKey=r,a.tableName=o,a}return babelHelpers.inheritsLoose(t,e),t})(s),p=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="wa_exceeded_storage_quota_error",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(s);function _(e){return e==null?!1:e instanceof s||f(e.name)}function f(e){return e==="indexed_db_access_error"||e==="ear_init_error"||e==="ear_runtime_error"||e==="ebsm_hydration_error"||e==="wa_exceeded_storage_quota_error"}var g=null,h=new Set;function y(){return g}function C(t,n){r("FBLogger")("messenger_web").MUSTFIX(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Setting unrecoverable db error: ",""])),t.name),g=t,n==null||n(),h.forEach(function(e){return e(t)})}function b(e){return h.add(e),function(){return h.delete(e)}}l.UnrecoverableDbError=s,l.IndexedDbAccessError=u,l.EarInitError=c,l.EarRuntimeError=d,l.EbsmHydrationError=m,l.WAExceededStorageQuotaError=p,l.isUnrecoverableDbError=_,l.isUnrecoverableDbErrorByName=f,l.getError=y,l.setError=C,l.subscribe=b}),98);
__d("MAWVaultMaterialsStorageStatus",[],(function(t,n,r,o,a,i){"use strict";var e=!1;function l(){return e}function s(){e=!0}i.isCurrentContextHoldingLock=l,i.setIsCurrentContextHoldingLock=s}),66);
__d("MAWVault",["ExecutionEnvironment","FBLogger","MAWKeychainCrypto","MAWKeychainNaClCrypto","MAWODSProxy","MAWVaultMaterials","MAWVaultMaterialsStorageStatus","WAOdsEnums","err","gkx","hasMultipleTabs","promiseDone","shouldUseMAWSharedWorker"],(function(t,n,r,o,a,i,l){"use strict";var e,s=new Map,u=new Map;function c(e){return new RegExp("^[0-9]{10}##[0-9]{10}.*[0-9]{10}##[0-9]{10}$").test(e)}var d=r("gkx")("23909");function m(e){if(!d)return!1;var t=o("MAWVaultMaterials").getVaultPrefixAndSuffix(),n=t==null?!1:new RegExp(t+".*"+t).test(e);return n}function p(t,n){if(n===void 0&&(n=!1),!d)return t;if(m(t)){var a=o("MAWVaultMaterials").getVaultMaterials(),i=a.encryptionKey,l=a.prefixAndSuffix;if(l==null)throw _("unvault","prefix_null"),r("FBLogger")("messenger_web").mustfixThrow("Vault prefix and suffix should not be null when unvaulting");var s=new RegExp(l+"(.*)"+l),u=t.match(s);if(u==null||u.length!=2)throw _("unvault","value_null"),r("FBLogger")("messenger_web").mustfixThrow("Could not retrieve inner value to unvault");if(i==null)throw _("unvault","key_null"),r("FBLogger")("messenger_web").mustfixThrow("Vault encryption key was null before unvault");var p=u[1],f=""+l+p+l,g=y(i,p);return t.replace(f,function(){return g})}if(c(t)){if(_("unvault","incorrect_key"),n)throw r("FBLogger")("messenger_web").mustfixThrow("Encountered vaulted value with incorrect key.");var h=r("err")("Encountered vaulted value with incorrect key");r("promiseDone")(o("hasMultipleTabs").hasMultipleTabs().then(function(t){r("FBLogger")("messenger_web").catching(h).mustfix("Encountered vaulted value with incorrect key. Vault material source: %s, environment: %s, hasMultipleTabs: %s, isSharedWorker: %s, isCurrentContextHoldingLock: %s",o("MAWVaultMaterials").getVaultMaterialsSource(),(e||(e=r("ExecutionEnvironment"))).isInMainThread?"main":"worker",t==null?"unknown_multi_tab":t?"multi_tab":"single_tab",o("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()?"shared_worker":"dedicated_worker",o("MAWVaultMaterialsStorageStatus").isCurrentContextHoldingLock()?"holding_lock":"not_holding_lock")}))}return t}function _(e,t){o("MAWODSProxy").odsBumpEntityKey({entity:o("WAOdsEnums").Entity.MAW_VAULTING,key:"failure."+e+"."+t})}function f(t){if(t===""||!d||!(e||(e=r("ExecutionEnvironment"))).isInBrowser)return t;if(!o("MAWVaultMaterials").hasVaultBeenSetup())return _("vault","has_not_been_setup"),r("FBLogger")("messenger_web").mustfix("Attempted to vault value while materials were not setup"),t;if(m(t))return _("vault","already_vaulted"),r("FBLogger")("messenger_web").warn("Attempted to vault value that's already been vaulted"),t;c(t)&&(_("vault","already_vaulted_with_different_key"),r("FBLogger")("messenger_web").mustfix("Attempted to vault value that's already been vaulted with a different key"));var n=o("MAWVaultMaterials").getVaultMaterials(),a=n.encryptionKey,i=n.prefixAndSuffix;if(i==null||a==null)throw _("vault","prefix_or_key_null"),r("FBLogger")("messenger_web").mustfixThrow("Cannot vault before vault materials are set");var l=h(a,t);return""+i+l+i}function g(e){if(!d)return e;if(!m(e))throw r("FBLogger")("messenger_web").mustfixThrow("Value should be vaulted");return p(e)}function h(e,t){var n=s==null?void 0:s.get(t);if(n!=null)return n;var r=new TextEncoder().encode(t).buffer,a=o("MAWKeychainNaClCrypto").encryptTweetNaCl(e,new Uint8Array(r));return s==null||s.set(t,a),u==null||u.set(a,t),a}function y(e,t){var n=u==null?void 0:u.get(t);if(n!=null)return n;var r=new TextDecoder().decode(o("MAWKeychainNaClCrypto").decryptTweetNaCl(e,t,void 0,o("MAWKeychainCrypto").ADDITIONAL_DATA.byteLength));return s==null||s.set(r,t),u==null||u.set(t,r),r}l.isVaulted=m,l.unvault=p,l.vault=f,l.unvaultOrThrow=g}),98);
__d("MAWWormOdsLogger",["WABridge","WAOdsEnums"],(function(t,n,r,o,a,i,l){"use strict";var e={log:function(t){return o("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:o("WAOdsEnums").Entity.WORM,key:t})}};l.wormOdsWorkerLogger=e}),98);
__d("WACommon.pb",["WAProtoConst"],(function(t,n,r,o,a,i,l){var e,s={EVERYONE:1,SILENT:2,AI:3,AI_IMAGINE:4},u={PROFILE:0},c={PLACEHOLDER:0,NO_PLACEHOLDER:1,IGNORE:2},d={},m={},p={},_={},f={};d.name="MessageKey",d.internalSpec={remoteJid:[1,(e=o("WAProtoConst")).TYPES.STRING],fromMe:[2,e.TYPES.BOOL],id:[3,e.TYPES.STRING],participant:[4,e.TYPES.STRING]},m.name="Command",m.internalSpec={commandType:[1,e.TYPES.ENUM,s],offset:[2,e.TYPES.UINT32],length:[3,e.TYPES.UINT32],validationToken:[4,e.TYPES.STRING]},p.name="Mention",p.internalSpec={mentionType:[1,e.TYPES.ENUM,u],mentionedJid:[2,e.TYPES.STRING],offset:[3,e.TYPES.UINT32],length:[4,e.TYPES.UINT32]},_.name="MessageText",_.internalSpec={text:[1,e.TYPES.STRING],mentionedJid:[2,e.FLAGS.REPEATED|e.TYPES.STRING],commands:[3,e.FLAGS.REPEATED|e.TYPES.MESSAGE,m],mentions:[4,e.FLAGS.REPEATED|e.TYPES.MESSAGE,p]},f.name="SubProtocol",f.internalSpec={payload:[1,e.TYPES.BYTES],version:[2,e.TYPES.INT32]},l.COMMAND_COMMAND_TYPE=s,l.MENTION_MENTION_TYPE=u,l.FUTURE_PROOF_BEHAVIOR=c,l.MessageKeySpec=d,l.CommandSpec=m,l.MentionSpec=p,l.MessageTextSpec=_,l.SubProtocolSpec=f}),98);
__d("WAArmadilloXMA.pb",["WACommon.pb","WAProtoConst"],(function(t,n,r,o,a,i,l){var e,s,u={SENDER_COPY:0,SERVER:1,SIGNED_CLIENT:2},c={INFO:0,EYE_OFF:1,NEWS_OFF:2,WARNING:3,PRIVATE:4,NONE:5,MEDIA_LABEL:6,POST_COVER:7,POST_LABEL:8,WARNING_SCREENS:9},d={OPEN_NATIVE:11},m={SINGLE:0,HSCROLL:1,PORTRAIT:3,STANDARD_DXMA:12,LIST_DXMA:15,GRID:16},p={UNSUPPORTED:-1,IG_STORY_PHOTO_MENTION:4,IG_SINGLE_IMAGE_POST_SHARE:9,IG_MULTIPOST_SHARE:10,IG_SINGLE_VIDEO_POST_SHARE:11,IG_STORY_PHOTO_SHARE:12,IG_STORY_VIDEO_SHARE:13,IG_CLIPS_SHARE:14,IG_IGTV_SHARE:15,IG_SHOP_SHARE:16,IG_PROFILE_SHARE:19,IG_STORY_PHOTO_HIGHLIGHT_SHARE:20,IG_STORY_VIDEO_HIGHLIGHT_SHARE:21,IG_STORY_REPLY:22,IG_STORY_REACTION:23,IG_STORY_VIDEO_MENTION:24,IG_STORY_HIGHLIGHT_REPLY:25,IG_STORY_HIGHLIGHT_REACTION:26,IG_EXTERNAL_LINK:27,IG_RECEIVER_FETCH:28,FB_FEED_SHARE:1e3,FB_STORY_REPLY:1001,FB_STORY_SHARE:1002,FB_STORY_MENTION:1003,FB_FEED_VIDEO_SHARE:1004,FB_GAMING_CUSTOM_UPDATE:1005,FB_PRODUCER_STORY_REPLY:1006,FB_EVENT:1007,FB_FEED_POST_PRIVATE_REPLY:1008,FB_SHORT:1009,FB_COMMENT_MENTION_SHARE:1010,FB_POST_MENTION:1011,FB_PROFILE_DIRECTORY_ITEM:1013,FB_FEED_POST_REACTION_REPLY:1014,FB_QUICKSNAP_REPLY:1015,MSG_EXTERNAL_LINK_SHARE:2e3,MSG_P2P_PAYMENT:2001,MSG_LOCATION_SHARING:2002,MSG_LOCATION_SHARING_V2:2003,MSG_HIGHLIGHTS_TAB_FRIEND_UPDATES_REPLY:2004,MSG_HIGHLIGHTS_TAB_LOCAL_EVENT_REPLY:2005,MSG_RECEIVER_FETCH:2006,MSG_IG_MEDIA_SHARE:2007,MSG_GEN_AI_SEARCH_PLUGIN_RESPONSE:2008,MSG_REELS_LIST:2009,MSG_CONTACT:2010,MSG_THREADS_POST_SHARE:2011,MSG_FILE:2012,MSG_AVATAR_DETAILS:2013,MSG_AI_CONTACT:2014,MSG_MEMORIES_SHARE:2015,MSG_SHARED_ALBUM_REPLY:2016,MSG_SHARED_ALBUM:2017,MSG_OCCAMADILLO_XMA:2018,MSG_GEN_AI_SUBSCRIPTION:2021,MSG_GEN_AI_REMINDER:2022,MSG_GEN_AI_MEMU_ONBOARDING_RESPONSE:2023,MSG_NOTE_REPLY:2024,MSG_NOTE_MENTION:2025,GEN_AI_ENTITY:2026,MSG_OPG_P2P_PAYMENT:2027,GEN_AI_RICH_RESPONSE:2028,MSG_MUSIC_STICKER:2029,MSG_PHONE_NUMBER:2030,AI_ACTIVITY_SHARE:2031,MSG_PRIVATE_XMA:2032,RTC_AUDIO_CALL:3e3,RTC_VIDEO_CALL:3001,RTC_MISSED_AUDIO_CALL:3002,RTC_MISSED_VIDEO_CALL:3003,RTC_GROUP_AUDIO_CALL:3004,RTC_GROUP_VIDEO_CALL:3005,RTC_MISSED_GROUP_AUDIO_CALL:3006,RTC_MISSED_GROUP_VIDEO_CALL:3007,RTC_ONGOING_AUDIO_CALL:3008,RTC_ONGOING_VIDEO_CALL:3009,MSG_RECEIVER_FETCH_FALLBACK:3025,DATACLASS_SENDER_COPY:4e3},_={},f={};_.name="ExtendedContentMessage",_.internalSpec={associatedMessage:[1,(e=o("WAProtoConst")).TYPES.MESSAGE,(s=o("WACommon.pb")).SubProtocolSpec],targetType:[2,e.TYPES.ENUM,p],targetUsername:[3,e.TYPES.STRING],targetId:[4,e.TYPES.STRING],targetExpiringAtSec:[5,e.TYPES.INT64],xmaLayoutType:[6,e.TYPES.ENUM,m],ctas:[7,e.FLAGS.REPEATED|e.TYPES.MESSAGE,f],previews:[8,e.FLAGS.REPEATED|e.TYPES.MESSAGE,s.SubProtocolSpec],titleText:[9,e.TYPES.STRING],subtitleText:[10,e.TYPES.STRING],maxTitleNumOfLines:[11,e.TYPES.UINT32],maxSubtitleNumOfLines:[12,e.TYPES.UINT32],favicon:[13,e.TYPES.MESSAGE,s.SubProtocolSpec],headerImage:[14,e.TYPES.MESSAGE,s.SubProtocolSpec],headerTitle:[15,e.TYPES.STRING],overlayIconGlyph:[16,e.TYPES.ENUM,c],overlayTitle:[17,e.TYPES.STRING],overlayDescription:[18,e.TYPES.STRING],sentWithMessageId:[19,e.TYPES.STRING],messageText:[20,e.TYPES.STRING],headerSubtitle:[21,e.TYPES.STRING],xmaDataclass:[22,e.TYPES.STRING],contentRef:[23,e.TYPES.STRING],mentionedJid:[24,e.FLAGS.REPEATED|e.TYPES.STRING],commands:[25,e.FLAGS.REPEATED|e.TYPES.MESSAGE,s.CommandSpec],mentions:[26,e.FLAGS.REPEATED|e.TYPES.MESSAGE,s.MentionSpec],xmaDataclassType:[27,e.TYPES.ENUM,u],signedXmaDataclassValidation:[28,e.TYPES.STRING],featureSharedSessionId:[29,e.TYPES.STRING]},f.name="ExtendedContentMessage$CTA",f.internalSpec={buttonType:[1,e.TYPES.ENUM,d],title:[2,e.TYPES.STRING],actionUrl:[3,e.TYPES.STRING],nativeUrl:[4,e.TYPES.STRING],ctaType:[5,e.TYPES.STRING],actionContentBlob:[6,e.TYPES.STRING]},l.EXTENDED_CONTENT_MESSAGE_XMA_DATACLASS_TYPE=u,l.EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH=c,l.EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE=d,l.EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE=m,l.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE=p,l.ExtendedContentMessageSpec=_,l.ExtendedContentMessage$CTASpec=f}),98);
__d("MAWXMAUtils",["I64","LSIntEnum","LSXmaContentType","MAWMsgType","WAArmadilloXMA.pb","WALogger","WATimeUtils","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(e){return!e||e.type!==o("MAWMsgType").MSG_TYPE.XMA?null:e}function d(t){if(t==null)return!1;switch(t){case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_MENTION:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_POST_PRIVATE_REPLY:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_HIGHLIGHTS_TAB_FRIEND_UPDATES_REPLY:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_HIGHLIGHTS_TAB_LOCAL_EVENT_REPLY:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_SHORT:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_MEMORIES_SHARE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_EVENT:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PROFILE_DIRECTORY_ITEM:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_POST_MENTION:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_MENTION:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING_V2:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_CONTACT:return!0;case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_AI_CONTACT:return r("gkx")("9339");case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_VIDEO_POST_SHARE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_IGTV_SHARE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SHOP_SHARE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_VIDEO_SHARE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:return!1;default:return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Hit Unreachable XMAType "," - checking isXMAShare"])),t),!1}}function m(e){return e!=null&&((s||(s=o("I64"))).equal(e,(u||(u=o("LSIntEnum"))).ofNumber(r("LSXmaContentType").FB_STORY_REPLY))||(s||(s=o("I64"))).equal(e,(u||(u=o("LSIntEnum"))).ofNumber(r("LSXmaContentType").FB_STORY_SHARE))||(s||(s=o("I64"))).equal(e,(u||(u=o("LSIntEnum"))).ofNumber(r("LSXmaContentType").FB_STORY_MENTION))||(s||(s=o("I64"))).equal(e,(u||(u=o("LSIntEnum"))).ofNumber(r("LSXmaContentType").FB_PRODUCER_STORY_REPLY)))}function p(e){return e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE||e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE||e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE}function _(e){return e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE}function f(e){return e!=null&&(s||(s=o("I64"))).equal(e,(u||(u=o("LSIntEnum"))).ofNumber(r("LSXmaContentType").MSG_CONTACT))}function g(e){return e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH}function h(e){return e==null?!1:e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE||e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE}function y(e){return e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_POST_PRIVATE_REPLY}function C(e,t){return e!=null&&e||t!=null&&t<o("WATimeUtils").unixTime()}function b(e){var t=e.ctas;return t!=null&&(t=t.filter(function(e){return e.buttonType!==o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE})),t}function v(e){return babelHelpers.extends({},e,{ctas:void 0,defaultCTA:void 0,headerTitle:void 0,isTombstoned:!0,maxSubtitleNumOfLines:void 0,maxTitleNumOfLines:void 0,overlayDescription:void 0,overlayIconGlyph:void 0,overlayTitle:void 0,subtitleText:void 0,targetId:void 0,targetUsername:void 0,titleText:void 0})}function S(e){var t=babelHelpers.extends({},e,{ctas:void 0,defaultCTA:void 0,defaultPreviewMediaId:void 0,defaultPreviewMediaPlaintextHash:void 0,faviconMediaId:void 0,faviconPlaintextHash:void 0,headerMediaId:void 0,headerMediaPlaintextHash:void 0,headerTitle:void 0,isTombstoned:!0,maxSubtitleNumOfLines:void 0,maxTitleNumOfLines:void 0,overlayDescription:void 0,overlayIconGlyph:void 0,overlayTitle:void 0,previewMediaIds:void 0,subtitleText:void 0,targetId:void 0,targetUsername:void 0,titleText:void 0});return t.targetExpiringAtSec=void 0,t}function R(e){switch(e){case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY:return!0;default:return!1}}function L(e){return e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY}function E(e){return e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION}function k(e){return e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_MENTION}function I(e){return e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_POST_MENTION}function T(e){switch(e){case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_MENTION:return!0;default:return!1}}function D(e){return k(e)||T(e)}function x(e){return e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE||e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE||e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_VIDEO_POST_SHARE}function $(e){return e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE||e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE}function P(e){return e===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_HIGHLIGHTS_TAB_FRIEND_UPDATES_REPLY}function N(e){switch(e){case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_GROUP_AUDIO_CALL:case o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_GROUP_VIDEO_CALL:return!0;default:return!1}}l.maybeXMAMessage=c,l.isXMAShare_DO_NOT_USE=d,l.isXMAFBStory=m,l.isXMAStoryShare=p,l.isXMAExternalLinkShare=_,l.isXMAContactShare=f,l.isReceiverFetchXMA=g,l.isIGXMAStoryShare=h,l.isXMAPostPrivateReply=y,l.isXMAExpired=C,l.removeCTAsForStoryMentionXMA=b,l.buildUnstoredTombstonedXMA=v,l.buildTombstonedDbXMA=S,l.isXMAStoryReply=R,l.isXMAStoryProducerReply=L,l.isXMAStoryReaction=E,l.isFBXMAStoryMention=k,l.isFBXMAPostMention=I,l.isIGXMAStoryMention=T,l.isXMAStoryMention=D,l.isIGXMAPostShare=x,l.isXMAStoryHighlightShare=$,l.isXMAMsgHighlightsTabFriendUpdatesReply=P,l.isRtcXMA=N}),98);
__d("MainPageUrl",["ExecutionEnvironment","FBLogger","SimpleHook","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=new URL((function(){var e=(self!==void 0?self:typeof window!="undefined"?window:{location:{href:"http://undefined"}}).location.href;return(u||(u=r("ExecutionEnvironment"))).isInWorker&&e&&e.startsWith("blob:")&&(e=e.substring(5,e.length)),e})()),d=new URL(c.href),m=new(o("SimpleHook")).SimpleHook;function p(){var e;return(u||(u=r("ExecutionEnvironment"))).isInBrowser&&(d==null||(e=d.searchParams)==null?void 0:e.get("workerlog"))==="debug"}function _(t){try{p()&&r("FBLogger")("worker").DEBUG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["received url ",""])),t);var n=new URL(t,d.href||c.href);d.href!==n.href?(d.href=n.href,m.call(d)):p()&&r("FBLogger")("worker").DEBUG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["ignoring url: path didn't change in ",""])),t)}catch(e){r("FBLogger")("worker").catching(r("getErrorSafe")(e)).warn("invalid url")}}typeof window=="object"&&typeof window.location=="object"&&typeof window.location.href=="string"&&_(window.location.href),l.mainPageUrl=d,l.onMainPageUrlChange=m,l.isWorkerLogEnabled=p,l.updateMainPageUrl=_}),98);
__d("NestedTimeRange",["SimpleHook","performance","performanceAbsoluteNow"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=new(o("SimpleHook")).SimpleHook,c=new(o("SimpleHook")).SimpleHook,d="/";function m(e,t){return""+e+d+t}var p=(function(){function t(e,t){t===void 0&&(t=null),this.$3=0,this.$1=e,this.$2=t}var n=t.prototype;return n.isRunning=function(){return this.$3>0},n.fullname=function(){return this.$2!==null?m(this.$2.fullname(),this.$1):this.$1},n.start=function(n){if(n===void 0&&(n=(e||(e=r("performanceAbsoluteNow")))()),this.$3===0){var t;(t=this.$2)==null||t.start(n),this.__onStart(n)}return++this.$3,n},n.__onStart=function(t){u.call(this,t)},n.stop=function(n){if(n===void 0&&(n=(e||(e=r("performanceAbsoluteNow")))()),--this.$3,this.$3===0){var t;this.__onStop(n),(t=this.$2)==null||t.stop(n)}return n},n.__onStop=function(t){c.call(this,t)},t})();function _(){(s||(s=r("performance"))).mark&&(s||(s=r("performance"))).measure&&(u.add(function(e,t){(s||(s=r("performance"))).mark(e.fullname()+"_start")}),c.add(function(e,t){(s||(s=r("performance"))).measure(e.fullname(),e.fullname()+"_start")}))}l.OnRangeStart=u,l.OnRangeStop=c,l.TIME_RANGE_LEVEL_SEPARATOR=d,l.rangeFullName=m,l.NestedTimeRange=p,l.enableDevConsoleTimeline=_}),98);
__d("QLogEvent",["DoubleKeyMap","FBLogger","NestedTimeRange","QPLEvent","SimpleHook","performanceNavigationStart"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=new(o("DoubleKeyMap")).DoubleKeyMap,c=(function(e){function t(t,n,r){var o;return o=e.call(this,t,r)||this,o.$QPLRange$p_1=n,u.set(n,o.fullname(),o),o}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.__onStart=function(n){e.prototype.__onStart.call(this,n),this.$QPLRange$p_1.point(this.fullname()+"_START",{timestamp:n})},n.__onStop=function(n){e.prototype.__onStop.call(this,n),this.$QPLRange$p_1.point(this.fullname()+"_END",{timestamp:n}),u.delete(this.$QPLRange$p_1,this.fullname())},n.range=function(n){var e;this.fullname().startsWith(o("NestedTimeRange").TIME_RANGE_LEVEL_SEPARATOR)||r("FBLogger")("qpl").warn("Range %s cannot have subrange since root name does not start with /",this.fullname());var a=o("NestedTimeRange").rangeFullName(this.fullname(),n);return(e=u.get(this.$QPLRange$p_1,a))!=null?e:new t(n,this.$QPLRange$p_1,this)},t})(o("NestedTimeRange").NestedTimeRange),d=new(o("DoubleKeyMap")).DoubleKeyMap,m=new(s=o("SimpleHook")).SimpleHook,p=new s.SimpleHook,_=new s.SimpleHook,f=new s.SimpleHook,g=(function(t){function n(n,r,a,i,l){var s;r===void 0&&(r=0),a===void 0&&(a=2),i===void 0&&(i=!1);var u=(e||(e=o("QPLEvent"))).getMarkerId(n);return s=t.call(this,"event_"+u)||this,s.event=n,s.instanceKey=r,s.$QPLEvent$p_1=a,s.isUserFlow=i,s.$QPLEvent$p_2=l,d.set(u,r,s),s}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.action=function(t){return this.$QPLEvent$p_1=t,this},a.getAction=function(){return this.$QPLEvent$p_1},a.setIsUserFlow=function(t){return this.isUserFlow=t,this},a.startFromNavStart=function(){return this.start(r("performanceNavigationStart")()),this},a.startFromTime=function(t){return this.start(t),this},a.__onStart=function(t){var e;(e=this.$QPLEvent$p_2)==null||e.onStart(this,t),m.call(this,t)},a.__onStop=function(n){var t;(t=this.$QPLEvent$p_2)==null||t.onStop(this,n),p.call(this,n),u.deleteAll(this),d.delete((e||(e=o("QPLEvent"))).getMarkerId(this.event),this.instanceKey)},a.range=function(t){var e;return(e=u.get(this,t))!=null?e:new c(t,this)},a.point=function(t,n){var e;return n===void 0&&(n={}),(e=this.$QPLEvent$p_2)==null||e.onPoint(this,t,n),_.call(this,t,n),this},a.annotate=function(t){var e;return(e=this.$QPLEvent$p_2)==null||e.onAnnotate(this,t),f.call(this,t),this},n})(o("NestedTimeRange").NestedTimeRange);function h(t,n,r){var a;return n===void 0&&(n=0),(a=d.get((e||(e=o("QPLEvent"))).getMarkerId(t),n))!=null?a:new g(t,n,2,!1,r)}l.OnEventStart=m,l.OnEventStop=p,l.OnEventPoint=_,l.OnEventAnnotate=f,l.QPLEvent=g,l.event=h}),98);
__d("SymmetricEncryptionPaddingUtils",["XPlatReactTextEncoder"],(function(t,n,r,o,a,i,l){"use strict";function e(e){if(e<10)return 10-e;var t=Math.floor(Math.log2(e)),n=Math.floor(Math.log2(t))+1,r=t-n,o=(1<<r)-1,a=e+o&(o^-1);return a-e}function s(t){var n=Uint32Array.BYTES_PER_ELEMENT,r=t.byteLength,o=e(r),a=n+r+o,i=new DataView(new ArrayBuffer(a));i.setUint32(0,r);var l=new Uint8Array(i.buffer);return l.set(new Uint8Array(t),n),l.buffer}function u(e){var t=new(o("XPlatReactTextEncoder")).TextEncoder,n=t.encode(e).buffer;return s(n)}function c(e){var t=Uint32Array.BYTES_PER_ELEMENT,n=new DataView(e);if(!(n.byteLength<t)){var r=e.byteLength,o=n.getUint32(0),a=r-t;if(o>=0&&o<=a)return e.slice(t,t+o)}}l.getPaddingLength=e,l.padData=s,l.pad=u,l.stripPadding=c}),98);
__d("TimedOnceFunc",["ExecutionEnvironment"],(function(t,n,r,o,a,i,l){var e,s=(function(){function t(t,n){this.$2=!1,this.$4=t,this.$3=n,(e||(e=r("ExecutionEnvironment"))).isInBrowser&&this.$5()}var n=t.prototype;return n.$6=function(){this.$1!=null&&clearTimeout(this.$1),this.$1=null},n.$5=function(){var e=this;this.isDone()||(this.$6(),this.$1=setTimeout(function(){e.$2=!0,e.run()},this.$3))},n.isDone=function(){return this.$4===null},n.isCancelled=function(){return this.$1===null&&this.$4!==null},n.run=function(){if(this.$6(),this.$4!=null){var e=this.$4;this.$4=null,e(this.$2)}},n.getDelay=function(){return this.$3},n.delay=function(t){this.$3=t!=null?t:this.$3,this.$5()},n.cancel=function(){this.$6()},t})();l.TimedOnceFunc=s}),98);
__d("VirtualMessageChannel",["invariant","Promise","SimpleHook","nullthrows","promiseDone"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=(function(){function t(e){e===void 0&&(e=!1),this.$2=new(o("SimpleHook")).SimpleHook,this.onmessage=null,this.onmessageerror=null,this.$3=e}var a=t.prototype;return a.setRemotePort=function(t){this.$1=t},a.addEventListener=function(t,n,r){if((t==="message"||t==="error")&&r==null||s(0,55320,t),t==="message")if(typeof n=="function")this.$2.add(n);else{var e=n.handleEvent.bind(n);this.$2.add(e),n.__handler=e}},a.removeEventListener=function(t,n,r){if(typeof n=="function")this.$2.remove(n);else{var e=n.__handler;this.$2.remove(e)}},a.postMessage=function(o,a){var t=this,i=function(){var e=r("nullthrows")(t.$1,"By now remote port must have value!");e.$2.call({data:o,ports:a})};this.$3?i():r("promiseDone")((e||(e=n("Promise"))).resolve(),i)},a.start=function(){},a.close=function(){},t})(),c=function(t,n){this.port1=new u(t),this.port2=new u(n),this.port1.setRemotePort(this.port2),this.port2.setRemotePort(this.port1)};l.VirtualMessagePort=u,l.VirtualMessageChannel=c}),98);
__d("WADevToolMessageChannel",[],(function(t,n,r,o,a,i){"use strict";var e=new MessageChannel,l,s=function(){return e=new MessageChannel,l(e),e},u=function(){return e},c=function(n){l=n,l(e)};i.createNewChannel=s,i.getMostRecentChannel=u,i.onCreateNewChannel=c}),66);
__d("WAPromiseQueue",["Promise"],(function(t,n,r,o,a,i){"use strict";var e,l=(function(){function t(t){t===void 0&&(t=-1),this.$1=(e||(e=n("Promise"))).resolve(),this.$3=0,this.$2=t}var r=t.prototype;return r.wait=function(){return this.$1},r.enqueueHandlers=function(t,n,r){var e=this;this.$3++;var o=this.$1.then(function(){return t}).then(n,r),a=o.then();return this.$1=u(o,this.$2).finally(function(){e.$3--}),a},r.enqueue=function(t){var e=this;this.$3++;var n=this.$1.then(t),r=n.then();return this.$1=u(n,this.$2).finally(function(){e.$3--}),r},r.size=function(){return this.$3},t})(),s=(function(){function t(e){e===void 0&&(e=-1),this.$1=new Map,this.$2=e}var r=t.prototype;return r.waitIfPending=function(t){return this.$1.get(t)},r.wait=function(r){return this.$1.get(r)||(e||(e=n("Promise"))).resolve()},r.enqueueHandlers=function(t,n,r,o){var e=this.wait(t).then(function(){return n}).then(r,o);return this.$3(t,e)},r.enqueue=function(t,n){var e=this.wait(t).then(n);return this.$3(t,e)},r.$3=function(t,n){var e=this,r=n.then(),o,a=function(){e.$1.get(t)===o&&e.$1.delete(t)};return o=u(n,this.$2).then(a,a),this.$1.set(t,o),r},t})();function u(t,r){return r>=0?new(e||(e=n("Promise")))(function(e){var n=function(){return void e()};t.then(n,n),setTimeout(n,r)}):t.then(c,c)}function c(){}i.PromiseQueue=l,i.PromiseQueueMap=s}),66);
__d("WorkerMessagePortLogging",["MainPageUrl","QLogEvent","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e=Math.random()<.1,s=20,u=100,c=50;function d(){return o("MainPageUrl").isWorkerLogEnabled()||o("MainPageUrl").mainPageUrl.searchParams.get("worker_log")===1}var m=0;function p(){return o("QLogEvent").event(r("qpl")._(41497718,"106"),m++)}function _(t,n,r){if(r===void 0&&(r=!1),!(n==null||!e)){var o=n.sendDelayHighPrecision,a=n.sendTimestamp,i=n.sendDateTime,l=n.receiveTimestamp,d=n.receiveDateTime,m=p();m.startFromTime();var _=m.range("SEND_DELAY");_.start(a),_.stop(l);var f=m.range("SEND_DELAY_LOW_PRECISION");f.start(i),f.stop(d);var g=Math.abs(a-i),h=Math.abs(l-d);if(m.annotate({string:{port_name:t},int:{send_delay:o,send_drift:g,receive_drift:h},bool:{send_delay_above_max:o!=null&&o>s,send_drift_above_max:g>u,receive_drift_above_max:h>u}}),r){var y=m.range("ROUND_TRIP");y.start(n.sendTimestamp),y.stop(n.receiveTimestamp);var C=n.receiveTimestamp-n.sendTimestamp;m.annotate({int:{round_trip:C},bool:{round_trip_above_max:C>c}})}m.stop()}}l.isWorkerLogEnabled=d,l.logMessageTiming=_}),98);
__d("WorkerMessagePort",["Deferred","FBLogger","MainPageUrl","Promise","PromiseAnnotate","SimpleHook","VirtualMessageChannel","WorkerMessagePortLogging","performanceAbsoluteNow","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(e){return e}var d=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("SimpleHook").SimpleHook);function m(e,t){var n=e;n.__timing=t}function p(e){return e.__timing}var _=(function(){function e(e,t){var n=this;this.$1={},this.onUnhandledMessage=new d,this.onMessage=new d,this.onPostMessage=new d,this.onError=new d,this.$2=e,this.name=t,this.$2.addEventListener("message",function(e){return n.onMessageHandler(e.data)}),this.$2.addEventListener("error",function(e){return n.onError.call(e)}),this.onPostMessage.add(function(e){m(e,{receiveDateTime:-1,receiveTimestamp:-1,sendDateTime:Date.now(),sendDelayHighPrecision:0,sendDelayLowPrecision:0,sendTimestamp:(u||(u=r("performanceAbsoluteNow")))()})}),this.onMessage.add(function(e){var t=p(e);if(t!=null){var a=t.sendDateTime,i=t.sendTimestamp,l=(u||(u=r("performanceAbsoluteNow")))(),s=Date.now();t.receiveTimestamp=l,t.receiveDateTime=s,t.sendDelayHighPrecision=l-i,t.sendDelayLowPrecision=s-a,o("WorkerMessagePortLogging").logMessageTiming(n.name,t)}})}var t=e.prototype;return t.onMessageHandler=function(t){try{this.onMessage.call(t);var e=this.$1[t.type];e?e.call(t):this.onUnhandledMessage.call(t)}catch(e){this.onError.call(e)}},t.postMessage=function(t,n){this.onPostMessage.call(t),n?this.$2.postMessage(t,n):this.$2.postMessage(t)},t.addMessageListener=function(t,n){var e=this.$1[t];return e||(e=new d,this.$1[t]=e),e.add(n)},t.removeMessageListener=function(t,n){var e=this.$1[t];return!!e&&e.remove(n)},t.removeAllMessageListeners=function(t){var e=this.$1[t];e&&e.clear()},t.onMessageOnce=function(t,r){var e=this;return new(s||(s=n("Promise")))(function(n){var o=e.addMessageListener(t,function(a){r(a)&&(e.removeMessageListener(t,o),n(a))})})},t.close=function(){var e=this.$2;e.close==null||e.close(),e.terminate==null||e.terminate()},t.isWrappingVirtualMessagePort=function(){return this.$2 instanceof o("VirtualMessageChannel").VirtualMessagePort},e})();function f(e){return e}var g=(function(t){function a(a,i){var l;l=t.call(this,a,i)||this;var u=f(l),c=new(r("Deferred")),d=c.getPromise();u.addMessageListener("endpoint_started",function(e){c.resolve(e);var t=p(e);u.postMessage({endpoint:e.endpoint,startSendTimestamp:t==null?void 0:t.sendTimestamp,targetEndpoint:l.name,type:"endpoint_started_received"})});var m=u.onMessageOnce("endpoint_started_received",function(){return!0});return(e||(e=o("PromiseAnnotate"))).setDisplayName(d,"endpoint_started"),e.setDisplayName(m,"endpoint_started_received"),u.postMessage({endpoint:l.name,type:"endpoint_started"}),r("promiseDone")(d,function(e){var t=p(e);o("WorkerMessagePortLogging").logMessageTiming(l.name,t)}),r("promiseDone")(m,function(e){var t=p(e);t!=null&&o("WorkerMessagePortLogging").logMessageTiming(l.name,t,!0)}),l.fullyConnected=(s||(s=n("Promise"))).race([d,m]).then(function(){return l}),l}return babelHelpers.inheritsLoose(a,t),a})(_);l.getMessageTiming=p,l.WorkerMessagePort=_,l.CastWorkerMessagePort=f,l.WorkerSyncedMessagePort=g}),98);
__d("WorkerFuncChannel",["invariant","DateConsts","ExecutionEnvironment","FBLogger","FuncChannel","MainPageUrl","Promise","TimedOnceFunc","VirtualMessageChannel","WorkerMessagePort","err","promiseDone"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c={serialize:function(t,n){return n.push(t),t},deserialize:function(t){return t}},d=1e4,m=0,p=5,_=p+1,f=(function(){function e(e){var t=self.WeakRef;t&&(this.$1=new t(e))}var t=e.prototype;return t.isDead=function(){return this.$1!=null&&this.$1.deref()==null},e})(),g=(function(t){function a(e,n,a,i){var l;a===void 0&&(a=null),i===void 0&&(i={}),l=t.call(this,e)||this,l.$WorkerFuncChannel$p_1=new Map,l.$WorkerFuncChannel$p_2=new Map,l.$WorkerFuncChannel$p_5={function:{serialize:function(t,n){var e=_++;l.$WorkerFuncChannel$p_1.set(e,t);var r={type:"function",value:e};return r},deserialize:function(t){var e=l,n=t.value,r=function(){var t={type:"call",id:n,method:"__anonymous",thisArg:null,argList:Array.from(arguments)};return e.callMessageHandler(t)};return l.$WorkerFuncChannel$p_2.set(n,new f(r)),r}},custom:{serialize:function(t,n){var e=t.constructor.name,r=l.$WorkerFuncChannel$p_4[e];r!=null||s(0,63779,e);var o=r.serialize(t,n);return{type:"custom",custom:e,value:o}},deserialize:function(t){var e=t.custom,n=l.$WorkerFuncChannel$p_4[e];return n!=null||s(0,63779,e),n.deserialize(t.value)}},error:{serialize:function(t,n){var e={name:t.name,message:t.message,stack:t.stack};return{type:"error",value:e}},deserialize:function(t){var e=r("err")(t.value.message);return e.name=t.value.name,e.stack=t.value.stack,e}},object:{serialize:function(t,n){var e=t.constructor;if(e!==Object)throw new Error("Cannot clone class object");return{type:"object",value:t}},deserialize:function(t){return t.value}},raw:{serialize:function(t,n){return{type:"raw",value:t}},deserialize:function(t){return t.value}}},l.name=n,l.$WorkerFuncChannel$p_3=a,l.$WorkerFuncChannel$p_4=i;var c=function(t){o("MainPageUrl").isWorkerLogEnabled()&&r("FBLogger")("adsworker").debug("[Channel] removing callback ids: %s",t.join()),t.forEach(function(e){return l.$WorkerFuncChannel$p_1.delete(e)})},p=l.__remoteInternalFunc(m,c);return typeof jest=="undefined"&&(u||(u=r("ExecutionEnvironment"))).isInBrowser&&setInterval(function(){var e=[];l.$WorkerFuncChannel$p_2.forEach(function(t,n){t.isDead()&&(e.push(n),l.$WorkerFuncChannel$p_2.delete(n))}),e.length>0?p(e):l.$WorkerFuncChannel$p_2.size>5e3&&l.$WorkerFuncChannel$p_2.size%10===0&&r("FBLogger")("adsworker").warn("[%s] has too many remaining refs %s",l.name,l.$WorkerFuncChannel$p_2.size)},d),l}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.__remoteInternalFunc=function(t,n){(t>p||this.$WorkerFuncChannel$p_1.get(t)!=null)&&r("FBLogger")("adsworker").mustfix("invalid internal func id %s",t),this.$WorkerFuncChannel$p_1.set(t,n);var e=this.$WorkerFuncChannel$p_5.function.deserialize({type:"function",value:t});return e},i.$WorkerFuncChannel$p_6=function(t){return t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array},i.$WorkerFuncChannel$p_7=function(t){if(typeof t=="function")return"function";if(t===null||typeof t!="object"||Array.isArray(t)||this.$WorkerFuncChannel$p_6(t))return"raw";var e=t.constructor.name;return this.$WorkerFuncChannel$p_4[e]?"custom":t instanceof Error?"error":"object"},i.$WorkerFuncChannel$p_8=function(t,n){var e=this.$WorkerFuncChannel$p_7(t);return this.$WorkerFuncChannel$p_5[e].serialize(t,n)},i.$WorkerFuncChannel$p_9=function(t){var e=t;if(t!==null&&typeof t=="object"&&typeof t.type=="string"){var n=this.$WorkerFuncChannel$p_5[t.type];if(n)return n.deserialize(t)}return e},i.__onPostOutMessage=function(t){return t},i.__callCallback=function(t,n){t.apply(null,n.argList)},i.setOutMessagePort=function(o,a){var t=this,i=[];this.setCallMessageHandler(function(a){a.thisArg=t.name;var l=[];a.argList=a.argList.map(function(e){return t.$WorkerFuncChannel$p_8(e,l)});var s=new(e||(e=n("Promise")))(function(e,n){a.result={resolveFunc:t.$WorkerFuncChannel$p_8(e,l),rejectFunc:t.$WorkerFuncChannel$p_8(n,l)}}),u=t.__onPostOutMessage(a);return u!=null&&(i!=null?i.push({message:a,transferList:l}):o.postMessage(a,l)),s.catch(function(e){r("FBLogger")("worker").catching(e).mustfix("Error: channel %s, remote call of %s returned error %s",t.name,a.method,e.message)}),s}),r("promiseDone")(a||E.waitForRemote(this.name),function(){var e=i;i=null,e==null||e.forEach(function(e){o.postMessage(e.message,e.transferList)}),t.$WorkerFuncChannel$p_3==null||t.$WorkerFuncChannel$p_3()})},i.__messageToCall=function(t){var e=this;if(t.argList=t.argList.map(function(t){return e.$WorkerFuncChannel$p_9(t)}),t.result){var n=t.result,o=n.resolveFunc,a=n.rejectFunc;o=this.$WorkerFuncChannel$p_9(o),a=this.$WorkerFuncChannel$p_9(a),t.result={resolveFunc:o,rejectFunc:a}}var i=t.id;if(i===void 0)this.messageToCall(t);else{var l=this.$WorkerFuncChannel$p_1.get(i);l?this.__callCallback(l,t):r("FBLogger")("adsworker").mustfix("Error: callback is called but no longer available")}},i.setInMessagePort=function(t){var e=this;t.addMessageListener("call",function(t){typeof t.thisArg=="string"&&t.thisArg===e.name&&e.__messageToCall(t)}),E.notifyReady(this.name)},i.setMessagePort=function(t){return this.setInMessagePort(t),this.setOutMessagePort(t),this},a})(r("FuncChannel")),h=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WorkerMessagePort").WorkerMessagePort);function y(e,t,n,o){E.exportChannel(e,function(o){var a=o.syncPort,i=o.remoteNativePort,l=t();e===l.name||s(0,54247,e,l.name);var u;i?(u=new h(i,a.name+"("+l.name+")"),i.start(),u.onError.add(function(e){throw r("FBLogger")("worker").catching(e).mustfix("error caught in remotePort"),e})):u=a,l.setMessagePort(u).setBackend(n),r("promiseDone")(a.fullyConnected,function(){a.postMessage({type:"channelReady",channelName:l.name}),E.logState("EXPORTED",e)})})}function C(e,t,n,r){return r===void 0&&(r={}),y(n,function(){return new g(function(t){return e},n,null,r)},e,t)}var b=(function(e){function t(t,n){n===void 0&&(n="");var a=o("DateConsts").MS_PER_MIN*1;return e.call(this,function(){r("FBLogger")("worker").warn("Channel %s did not establish eventually. %s",t,n)},a)||this}return babelHelpers.inheritsLoose(t,e),t})(o("TimedOnceFunc").TimedOnceFunc);function v(e,t){var n,a=null,i,l;t.isWrappingVirtualMessagePort()?(l=new(o("VirtualMessageChannel")).VirtualMessageChannel(!0,!0),n="on virtual dedicated channel"):(l=new MessageChannel,n="on native dedicated channel",i=[l.port2]);var s=l.port1;a=l.port2,s.start();var u=new h(s,t.name+"("+e.name+")");return r("promiseDone")(t.fullyConnected,function(){E.logState("IMPORTING "+n+" ",e.name),e.setInMessagePort(u);var o=new b(e.name,n);r("promiseDone")(t.onMessageOnce("channelReady",function(t){return t.channelName===e.name}),function(t){e.setOutMessagePort(u),o.cancel(),E.logState("ESTABLISHED",e.name)}),t.postMessage({type:"channelImport",channelName:e.name,port:a},i)}),e.proxyMethods}function S(e,t,n,r){n===void 0&&(n=null),r===void 0&&(r={});var o=new g(function(t){return e},t,n,r);return o}function R(e,t,n,r,o){return r===void 0&&(r=null),o===void 0&&(o={}),v(S(e,n,r,o),t)}var L=(function(){function t(){this.name=self.name+"_P"+Math.round(10*Math.random()),this.$1=new Map,this.$2=new Set}var a=t.prototype;return a.logState=function(t,n){o("MainPageUrl").isWorkerLogEnabled()&&r("FBLogger")("worker").debug("%s-%s %s",this.name,t,n)},a.$3=function(t){var e=this.$1.get(t);return e==null&&(e={pendingPorts:null,onImportRequest:null},this.$1.set(t,e)),e},a.exportChannel=function(t,n){var e=this,o=this.$3(t);o.onImportRequest!=null&&r("FBLogger")("worker").debug("Re-exporting channel %s",t),o.onImportRequest=n,this.logState("REGISTERED",t);var a=o.pendingPorts;if(a!=null){var i=a.filter(function(t){return e.$2.has(t.syncPort)});i.forEach(n),i.length<a.length?o.pendingPorts=a.filter(function(t){return!e.$2.has(t.syncPort)}):o.pendingPorts=null}return o},a.activate=function(t,n,o){var e=this;if(this.$2.has(t)){r("FBLogger")("worker").debug("Port %sis already duplicated ",t.name);return}this.$2.add(t),t.addMessageListener("channelImport",function(n){var r=n.channelName,o=e.$3(r),a={syncPort:t,remoteNativePort:n.port};o.onImportRequest!=null?o.onImportRequest(a):o.pendingPorts!=null?o.pendingPorts.push(a):o.pendingPorts=[a],e.logState("IMPORT REQUEST",r)})},a.notifyReady=function(t){},a.waitForRemote=function(r){return(e||(e=n("Promise"))).resolve()},t})(),E=new L;function k(e,t,n){E.activate(e,t,n)}l.TransferableTransformer=c,l.WorkerFuncChannel=g,l.exportChannelOnPort=y,l.exportChannel=C,l.importChannelOnPort=v,l.makeChannel=S,l.importChannel=R,l.activateChannels=k}),98);
__d("WorkerBanzaiLazyQueueChannelClient",["BanzaiLazyQueue","WorkerFuncChannel"],(function(t,n,r,o,a,i,l){"use strict";function e(e){o("WorkerFuncChannel").exportChannel(r("BanzaiLazyQueue"),e,"banzai_lazyqueue_channel")}l.init=e}),98);
__d("WorkerQPLChannel",["WorkerFuncChannel","performanceAbsoluteNow"],(function(t,n,r,o,a,i,l){"use strict";var e,s=new(o("WorkerFuncChannel")).WorkerFuncChannel(function(t){return{markerStartFromNavStart:null,markerStart:function(o,a,i){return i===void 0&&(i=(e||(e=r("performanceAbsoluteNow")))()),t.markerStart(o,a,i)},markerAnnotate:function(n,r,o){return t.markerAnnotate(n,r,o)},markerPoint:function(o,a,i){var n=(i==null?void 0:i.timestamp)===void 0?babelHelpers.extends({},i,{timestamp:(e||(e=r("performanceAbsoluteNow")))()}):i;return t.markerPoint(o,a,n)},markerEnd:function(o,a,i,l){return l===void 0&&(l=(e||(e=r("performanceAbsoluteNow")))()),t.markerEnd(o,a,i,l)}}},"qpl");function u(e){s.setMessagePort(e)}function c(e){s.setBackend(e)}l.setMessagePort=u,l.initQPL=c}),98);
__d("WorkerClient",["WorkerBanzaiLazyQueueChannelClient","WorkerFuncChannel","WorkerQPLChannel"],(function(t,n,r,o,a,i,l){"use strict";function e(e){o("WorkerFuncChannel").activateChannels(e,"client","worker"),o("WorkerBanzaiLazyQueueChannelClient").init(e),o("WorkerQPLChannel").setMessagePort(e),a(["QuickPerformanceLogger"],function(e){return o("WorkerQPLChannel").initQPL(e)})}l.init=e}),98);
__d("XPlatReactVoprf",["Promise","WAWasmModuleCache","asyncToGeneratorRuntime","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("requireDeferred")("LSVoprfWasm").__setRef("XPlatReactVoprf");function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield s.load(),t=e.LSVoprfWasm,n=e.locateFile,r=yield t({getWasmModule:function(){return o("WAWasmModuleCache").loadWasmModule(n())}}),a,i;try{a=r.createCurveRistretto(),i=r.createVoprfExpTwohashdh(a);var l={voprfInfo:{curvePtr:a,voprfPtr:i},voprfWasm:r};return{voprfInstance:l}}catch(e){throw a!=null&&r.freeCurve(a),i!=null&&r.freeVoprf(i),e}}),c.apply(this,arguments)}function d(){return(e||(e=n("Promise"))).resolve(u())}function m(e){var t=e.voprfInfo,n=e.voprfWasm,r=t.curvePtr,o=t.voprfPtr;n.freeCurve(r),n.freeVoprf(o)}l.loadXPlatReactVoprf=d,l.freeVoprfInstance=m}),98);